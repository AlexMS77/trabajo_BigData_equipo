<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Naira Carruccio (naicavi@alumni.uv.es)">
<meta name="author" content="Alex Monzó (amonsan7@alumni.uv.es)">
<meta name="author" content="Luis Antonio Pérez (luispepa@alumni.uv.es)">
<meta name="description" content="Analizando el gasto que destinan diferentes paises en relación a España y veremos si hay alguna relación con los resultados de la prueba PISA">
<title>España y sus vecinos - La evolución del gasto en educación en España y su relación con las pruebas PISA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./my_favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": true,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<style>
    .quarto-title-block .quarto-title-banner {
      color: DCDCDC;
    }
    </style>
<script src="site_libs/twitter-widget-0.0.1/widgets.js"></script><link href="site_libs/vembedr-0.1.5.9000/css/vembedr.css" rel="stylesheet">
<link rel="stylesheet" href="my_styles.css">
</head>
<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./my_favicon.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">España y sus vecinos</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item compact">
    <a class="nav-link" href="./index.html"><i class="bi bi-house-door" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link active" href="./my_trabajo_BigData.html" aria-current="page">
 <span class="menu-text">Trabajo en equipo</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./las_slides_estan.html">
 <span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/AlexMS77"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/<tu-usuario-twitter>"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:<no_escribas@alumni.uv.es>"><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-right">
      <div class="quarto-title-block"><div><h1 class="title">La evolución del gasto en educación en España y su relación con las pruebas PISA</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Código</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Mostrar todo el código</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Ocultar todo el código</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Ver el código fuente</a></li></ul></div></div>
                  <div>
        <div class="description">
          <p>Analizando el gasto que destinan diferentes paises en relación a España y veremos si hay alguna relación con los resultados de la prueba PISA</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">trabajo Big Data</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Autores/as</div>
      <div class="quarto-title-meta-contents">
               <p>Naira Carruccio (naicavi@alumni.uv.es) </p>
               <p>Alex Monzó (amonsan7@alumni.uv.es) </p>
               <p>Luis Antonio Pérez (luispepa@alumni.uv.es) </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Fecha de publicación</div>
      <div class="quarto-title-meta-contents">
        <p class="date">16 de diciembre de 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">En esta página</h2>
   
  <ul>
<li><a href="#introducci%C3%B3n" id="toc-introducción" class="nav-link active" data-scroll-target="#introducci%C3%B3n">Introducción</a></li>
  <li><a href="#datos-del-trabajo" id="toc-datos-del-trabajo" class="nav-link" data-scroll-target="#datos-del-trabajo">Datos del trabajo</a></li>
  <li><a href="#la-educaci%C3%B3n-en-el-mundo" id="toc-la-educación-en-el-mundo" class="nav-link" data-scroll-target="#la-educaci%C3%B3n-en-el-mundo">La educación en el mundo</a></li>
  <li>
<a href="#contexto-espa%C3%B1ol" id="toc-contexto-español" class="nav-link" data-scroll-target="#contexto-espa%C3%B1ol">Contexto español</a>
  <ul class="collapse">
<li><a href="#divisi%C3%B3n-del-gasto-en-educaci%C3%B3n" id="toc-división-del-gasto-en-educación" class="nav-link" data-scroll-target="#divisi%C3%B3n-del-gasto-en-educaci%C3%B3n">División del gasto en educación</a></li>
  </ul>
</li>
  <li>
<a href="#pruebas-pisa" id="toc-pruebas-pisa" class="nav-link" data-scroll-target="#pruebas-pisa">Pruebas PISA</a>
  <ul class="collapse">
<li><a href="#analisis-de-datos" id="toc-analisis-de-datos" class="nav-link" data-scroll-target="#analisis-de-datos">Analisis de datos</a></li>
  <li><a href="#evoluci%C3%B3n-de-las-notas-de-las-pruebas-pisa" id="toc-evolución-de-las-notas-de-las-pruebas-pisa" class="nav-link" data-scroll-target="#evoluci%C3%B3n-de-las-notas-de-las-pruebas-pisa">Evolución de las notas de las pruebas PISA</a></li>
  </ul>
</li>
  <li>
<a href="#modelo-de-regresi%C3%B3n" id="toc-modelo-de-regresión" class="nav-link" data-scroll-target="#modelo-de-regresi%C3%B3n">Modelo de Regresión</a>
  <ul class="collapse">
<li><a href="#conclusiones" id="toc-conclusiones" class="nav-link" data-scroll-target="#conclusiones">Conclusiones</a></li>
  </ul>
</li>
  </ul></nav>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-right" id="quarto-document-content"><section id="introducción" class="level1"><h1>Introducción</h1>
<div class="cell" data-layout-align="center">

</div>
<p>El trabajo que vamos a realizar se puede dividir en tres partes:</p>
<ul>
<li><p>En primer lugar, analizaremos el gasto que realizan los distintos gobiernos generales de una serie de países sobre el gasto en educación; algunos países que serán objetivo de este análisis serán: el principal país será <strong>España</strong>, país sobre el que recae el trabajo y que para observar mejor cómo ha ido evolucionando su situación y todo lo demás, la compararemos con los países que conforman el G7: Estados Unidos, Reino Unido, Canadá, Italia, Francia, Japón y Alemania, además de algunos países vecinos como Portugal o Grecia, que aparte son similares a España.</p></li>
<li><p>En segundo lugar, analizaremos los resultados de las <strong>pruebas PISA</strong>, un estudio que realiza la OECD y que consta de unos exámenes que realizan los alumnos de todo el mundo cuyo objetivo no es analizar a los alumnos sino el sistema que los educa, que no es lo mismo. Estos se componen de tres campos: matemáticas, ciencia y lectura y se realizan cada 3 años en alumnos de 15 años de edad.</p></li>
<li><p>Por último, detallaremos un modelo en el cual pretendemos observar si hay relación entre el gasto que realiza el gobierno en educación y las notas que se obtienen en dichas pruebas y ver si tiene correlación o no.</p></li>
</ul>
<p>El motivo por el cual hemos elegido hacer el trabajo sobre el gasto en educación es porque hemos considerado que es una de las variables más importantes y que más influyen en el crecimiento de un país, tanto a nivel cultural, como económico y social y es una herramienta que el gobierno puede modificar a conveniencia, por lo tanto, es una herramiento muy importante y poderosa.</p>
</section><section id="datos-del-trabajo" class="level1"><h1>Datos del trabajo</h1>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Datos usados</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Códigos</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Los datos del trabajo han sido extraídos de diversas fuentes como pueden ser el Eurostat, la UNESCO o la OECD. Está última ha sido la que más datos nos ha proporcionado para realizar el trabajo, pues es de donde se han extraído los principales datos de las pruebas PISA y del gasto en educación.</p>
<p>Por otro lado, los datos se han obtenido en formato csv en su conjunto, el cual es un buen formato para poder empezar a trabajar con ellos (en nuestra opinión el mejor) ya que con otros formatos como excel hemos tenido problemas a la hora de editarlos y poder manejarlos correctamente.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#ESTOS SON LOS PAQUETES QUE HEMOS UTILIZADO A LO LARGO DEL TRABAJO</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(countrycode)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">library</span>(ggimage)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="fu">library</span>(rnaturalearthdata)</span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu">library</span>(ggThemeAssist)</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="fu">library</span>(mapdata)</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="fu">library</span>(maps)</span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="fu">library</span>(tmap)</span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="fu">library</span>(treemap)</span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="fu">library</span>(tweetrmd)</span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="fu">library</span>(glue)</span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="fu">library</span>(gclus)</span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="fu">library</span>(vembedr)</span>
<span id="cb1-29"><a href="#cb1-29"></a></span>
<span id="cb1-30"><a href="#cb1-30"></a></span>
<span id="cb1-31"><a href="#cb1-31"></a></span>
<span id="cb1-32"><a href="#cb1-32"></a></span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="co"># PRIMERO CARGAMOS LOS DATOS QUE POSTERIORMENTE TRANSFORMAREMOS PARA PODER ANALIZARLOS MEJOR</span></span>
<span id="cb1-34"><a href="#cb1-34"></a></span>
<span id="cb1-35"><a href="#cb1-35"></a>intro1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/aaa.csv"</span>) </span>
<span id="cb1-36"><a href="#cb1-36"></a>educacion_gasto_PIB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/Datos_educacion_PST.csv"</span>)</span>
<span id="cb1-37"><a href="#cb1-37"></a>educacion_segmento <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/Datos_educacion_completo.csv"</span>)</span>
<span id="cb1-38"><a href="#cb1-38"></a>gasto_total_educacion_PIB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/gasto_total_y_publico.csv"</span>)</span>
<span id="cb1-39"><a href="#cb1-39"></a>gasto_total_educ <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/gasto_total_y_publico.csv"</span>)</span>
<span id="cb1-40"><a href="#cb1-40"></a>confianza_gobierno <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/gobierno_aprobacion.csv"</span>)</span>
<span id="cb1-41"><a href="#cb1-41"></a>eurostat_p <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/presupuesto.csv"</span>)</span>
<span id="cb1-42"><a href="#cb1-42"></a>pisa_ciencias<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/pisa_ciencias.csv"</span>)</span>
<span id="cb1-43"><a href="#cb1-43"></a>pisa_mates <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/pisa_mates.csv"</span>)</span>
<span id="cb1-44"><a href="#cb1-44"></a>pisa_lectura <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/pisa_lectura.csv"</span>)</span>
<span id="cb1-45"><a href="#cb1-45"></a></span>
<span id="cb1-46"><a href="#cb1-46"></a></span>
<span id="cb1-47"><a href="#cb1-47"></a><span class="co">#AHORA LOS TRANSFORMAMOS </span></span>
<span id="cb1-48"><a href="#cb1-48"></a></span>
<span id="cb1-49"><a href="#cb1-49"></a>df <span class="ot">&lt;-</span> pisa_mates <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>)</span>
<span id="cb1-50"><a href="#cb1-50"></a>df1<span class="ot">&lt;-</span>pisa_ciencias <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>)</span>
<span id="cb1-51"><a href="#cb1-51"></a>df1 <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">ciencia=</span>Value)</span>
<span id="cb1-52"><a href="#cb1-52"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">rename</span> (<span class="at">mates=</span>Value)</span>
<span id="cb1-53"><a href="#cb1-53"></a>pisa_lectura <span class="ot">&lt;-</span> pisa_lectura <span class="sc">%&gt;%</span> <span class="fu">select</span>(LOCATION, SUBJECT,TIME, Value)</span>
<span id="cb1-54"><a href="#cb1-54"></a>pisa_lectura <span class="ot">&lt;-</span> pisa_lectura <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Lectura=</span>Value)</span>
<span id="cb1-55"><a href="#cb1-55"></a>pisa<span class="ot">&lt;-</span> <span class="fu">inner_join</span>(df,df1)</span>
<span id="cb1-56"><a href="#cb1-56"></a>pisa <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(pisa, pisa_lectura)</span>
<span id="cb1-57"><a href="#cb1-57"></a>noborrar<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pisa"</span>)</span>
<span id="cb1-58"><a href="#cb1-58"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()[<span class="sc">!</span><span class="fu">ls</span>()<span class="sc">%in%</span>noborrar])</span>
<span id="cb1-59"><a href="#cb1-59"></a>rio<span class="sc">::</span><span class="fu">export</span>(pisa,<span class="st">"./datos/pisa.xlsx"</span>)</span>
<span id="cb1-60"><a href="#cb1-60"></a></span>
<span id="cb1-61"><a href="#cb1-61"></a>a<span class="ot">&lt;-</span> pisa <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SUBJECT<span class="sc">==</span><span class="st">"TOT"</span>)</span>
<span id="cb1-62"><a href="#cb1-62"></a></span>
<span id="cb1-63"><a href="#cb1-63"></a>b <span class="ot">&lt;-</span> pisa <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SUBJECT<span class="sc">==</span><span class="st">"TOT"</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(LOCATION) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">media_mates=</span> <span class="fu">mean</span>(mates), <span class="at">media_ciencias =</span> <span class="fu">mean</span> (ciencia), <span class="at">media_lectura =</span> <span class="fu">mean</span> (Lectura))</span>
<span id="cb1-64"><a href="#cb1-64"></a>mejores_mates <span class="ot">&lt;-</span> b<span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(media_mates, <span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb1-65"><a href="#cb1-65"></a>mejores_ciencias<span class="ot">&lt;-</span> b <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(media_ciencias, <span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb1-66"><a href="#cb1-66"></a>mejores_lectura <span class="ot">&lt;-</span> b <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(media_lectura, <span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb1-67"><a href="#cb1-67"></a>VECINOS<span class="ot">&lt;-</span> b <span class="sc">%&gt;%</span> <span class="fu">filter</span>(LOCATION<span class="sc">==</span><span class="st">"ESP"</span> <span class="sc">|</span> LOCATION<span class="sc">==</span><span class="st">"ITA"</span><span class="sc">|</span> LOCATION<span class="sc">==</span><span class="st">"PRT"</span><span class="sc">|</span> LOCATION <span class="sc">==</span><span class="st">"GRC"</span> <span class="sc">|</span> LOCATION <span class="sc">==</span> <span class="st">"FRA"</span>)</span>
<span id="cb1-68"><a href="#cb1-68"></a></span>
<span id="cb1-69"><a href="#cb1-69"></a></span>
<span id="cb1-70"><a href="#cb1-70"></a>datos_gt_movil <span class="ot">&lt;-</span> pisa <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SUBJECT<span class="sc">==</span><span class="st">"TOT"</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(LOCATION<span class="sc">==</span><span class="st">"ESP"</span> <span class="sc">|</span> LOCATION<span class="sc">==</span><span class="st">"ITA"</span><span class="sc">|</span> LOCATION<span class="sc">==</span><span class="st">"PRT"</span><span class="sc">|</span> LOCATION <span class="sc">==</span><span class="st">"GRC"</span> <span class="sc">|</span> LOCATION <span class="sc">==</span> <span class="st">"FRA"</span>)  <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> LOCATION, </span>
<span id="cb1-71"><a href="#cb1-71"></a>                                                                                                                                                                                      <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb1-72"><a href="#cb1-72"></a>                                                                                                                                                                                      <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb1-73"><a href="#cb1-73"></a></span>
<span id="cb1-74"><a href="#cb1-74"></a>datos_gt_movil_long <span class="ot">&lt;-</span> datos_gt_movil <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb1-75"><a href="#cb1-75"></a>                                                              <span class="at">names_to =</span> <span class="st">"pruebas"</span>,</span>
<span id="cb1-76"><a href="#cb1-76"></a>                                                              <span class="at">values_to =</span> <span class="st">"notas"</span> )</span>
<span id="cb1-77"><a href="#cb1-77"></a></span>
<span id="cb1-78"><a href="#cb1-78"></a><span class="co">#GRAFICA</span></span>
<span id="cb1-79"><a href="#cb1-79"></a></span>
<span id="cb1-80"><a href="#cb1-80"></a>w <span class="ot">&lt;-</span> <span class="fu">full_join</span>(VECINOS,mejores_mates)</span>
<span id="cb1-81"><a href="#cb1-81"></a>w <span class="ot">&lt;-</span> <span class="fu">full_join</span>(w,mejores_ciencias)</span>
<span id="cb1-82"><a href="#cb1-82"></a>w <span class="ot">&lt;-</span> <span class="fu">full_join</span>(w, mejores_lectura) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section><section id="la-educación-en-el-mundo" class="level1"><h1>La educación en el mundo</h1>
<p>La educación es uno de los principales factores para el desarrollo del capital humano y esto es lo que ha motivado a que sea el gobierno el que controle esta variables. Es por ello que la mayoría de países tienen cierta intervención pública en esta materia.</p>
<blockquote class="blockquote">
<p><em>“La educación aumenta la productividad y renta individuales. En este sentido y aun más para el caso en que no exista financiación pública de la misma, al incrementarse las rentas futuras, también se incrementan los impuestos que se han de pagar en el futuro al herario público.”</em> Nicholas Barr</p>
</blockquote>
<p>La educación es un bien público que no se le niega a nadie en los países desarrollados y es fundamental para el crecimiento de un país como decíamos en la introducción. La mayoría de países fijan la educación obligatoria hasta la adolescencia, alrededor de los 16 años, por lo que normalmente, de media, los niños estan escolarizados alrededor de 10 años, como se puede ver en el siguiente mapa.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>intro1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/aaa.csv"</span>) </span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a>mapa_intro <span class="ot">&lt;-</span> intro1 <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="fu">select</span>(LOCATION, TIME, Value) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="fu">filter</span>(TIME <span class="sc">==</span> <span class="st">"2019"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="fu">rename</span>(<span class="at">region =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value)</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a>mapdata <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"world"</span>) </span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a>mapdata_2 <span class="ot">&lt;-</span>  mapdata <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11"></a>  <span class="fu">mutate</span>(<span class="at">Pais =</span> countrycode<span class="sc">::</span><span class="fu">countrycode</span>(<span class="at">sourcevar =</span> region, <span class="at">origin =</span> <span class="st">"country.name"</span>,</span>
<span id="cb2-12"><a href="#cb2-12"></a>                                         <span class="at">destination =</span>  <span class="st">"iso3c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb2-13"><a href="#cb2-13"></a></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="fu">data</span>(World)</span>
<span id="cb2-15"><a href="#cb2-15"></a>world <span class="ot">&lt;-</span> World ; <span class="fu">rm</span>(World)</span>
<span id="cb2-16"><a href="#cb2-16"></a></span>
<span id="cb2-17"><a href="#cb2-17"></a>world1 <span class="ot">&lt;-</span> world <span class="sc">%&gt;%</span> </span>
<span id="cb2-18"><a href="#cb2-18"></a>  <span class="fu">select</span>(<span class="at">region =</span> iso_a3, geometry) <span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>  <span class="fu">filter</span>(<span class="sc">!</span>region <span class="sc">==</span> <span class="st">"ATA"</span>)</span>
<span id="cb2-20"><a href="#cb2-20"></a></span>
<span id="cb2-21"><a href="#cb2-21"></a>mapa4 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(world1, mapa_intro, <span class="at">by =</span> <span class="st">"region"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb2-22"><a href="#cb2-22"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb2-23"><a href="#cb2-23"></a></span>
<span id="cb2-24"><a href="#cb2-24"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb2-25"><a href="#cb2-25"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> world1) <span class="sc">+</span></span>
<span id="cb2-26"><a href="#cb2-26"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mapa4, <span class="fu">aes</span>(<span class="at">fill =</span> Valor)) <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-28"><a href="#cb2-28"></a>    <span class="at">title =</span> <span class="st">"Años de educación obligatoria, en 2019"</span>) <span class="sc">+</span> <span class="fu">scale_fill_distiller</span>(<span class="at">name=</span><span class="st">"Años"</span>, <span class="at">palette =</span> <span class="st">"GnBu"</span>) <span class="sc">+</span> <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray94"</span>,</span>
<span id="cb2-29"><a href="#cb2-29"></a>    <span class="at">linetype =</span> <span class="st">"blank"</span>), <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>,</span>
<span id="cb2-30"><a href="#cb2-30"></a>    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb2-31"><a href="#cb2-31"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb2-32"><a href="#cb2-32"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>,</span>
<span id="cb2-33"><a href="#cb2-33"></a>        <span class="at">family =</span> <span class="st">"serif"</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"cadetblue1"</span>)) <span class="sc">+</span><span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"Datos de la Unesco"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"azure2"</span>))</span>
<span id="cb2-34"><a href="#cb2-34"></a></span>
<span id="cb2-35"><a href="#cb2-35"></a>gg</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>Por todo eso, uno de los gastos más importantes de un país es el gasto en educación, el cual forma parte del gasto público del gobierno, que se financia con el presupuestos de un país.</p>
<p>En el caso de España, el gasto que se realiza se reparte de esta manera entre los distintos servicios que realiza el estado español.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>eurostat_p <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/presupuesto.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>presupuesto <span class="ot">&lt;-</span> eurostat_p <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(LAST.UPDATE, freq, unit, sector, na_item, OBS_FLAG, DATAFLOW)) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="fu">rename</span>(Año <span class="ot">=</span> TIME_PERIOD, <span class="at">Valor =</span> OBS_VALUE, <span class="at">Partida =</span> cofog99, <span class="at">Pais =</span> geo) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">filter</span>(Pais <span class="sc">==</span> <span class="st">"ES"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>  <span class="fu">mutate</span>(<span class="at">Partida_presupuesto =</span> forcats<span class="sc">::</span><span class="fu">fct_recode</span>(Partida,</span>
<span id="cb3-8"><a href="#cb3-8"></a>                                                   <span class="st">"Servicios públicos generales"</span> <span class="ot">=</span> <span class="st">"GF01"</span>,</span>
<span id="cb3-9"><a href="#cb3-9"></a>                                                   <span class="st">"Defensa"</span> <span class="ot">=</span> <span class="st">"GF02"</span>,</span>
<span id="cb3-10"><a href="#cb3-10"></a>                                                   <span class="st">"Orden público y seguridad"</span> <span class="ot">=</span> <span class="st">"GF03"</span>,</span>
<span id="cb3-11"><a href="#cb3-11"></a>                                                   <span class="st">"Asuntos económicos"</span>  <span class="ot">=</span> <span class="st">"GF04"</span>,</span>
<span id="cb3-12"><a href="#cb3-12"></a>                                                   <span class="st">"Protección del medio ambiente"</span> <span class="ot">=</span> <span class="st">"GF05"</span>,</span>
<span id="cb3-13"><a href="#cb3-13"></a>                                                   <span class="st">"Vivienda y servicios comunitarios"</span> <span class="ot">=</span> <span class="st">"GF06"</span>,</span>
<span id="cb3-14"><a href="#cb3-14"></a>                                                   <span class="st">"Salud"</span> <span class="ot">=</span> <span class="st">"GF07"</span>,</span>
<span id="cb3-15"><a href="#cb3-15"></a>                                                   <span class="st">"Ocio y cultura"</span>  <span class="ot">=</span> <span class="st">"GF08"</span>,</span>
<span id="cb3-16"><a href="#cb3-16"></a>                                                   <span class="st">"Educación"</span> <span class="ot">=</span> <span class="st">"GF09"</span>,</span>
<span id="cb3-17"><a href="#cb3-17"></a>                                                   <span class="st">"Protección social"</span>  <span class="ot">=</span> <span class="st">"GF10"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Partida, Pais)) <span class="sc">%&gt;%</span></span>
<span id="cb3-19"><a href="#cb3-19"></a>  <span class="fu">filter</span>(Año <span class="sc">==</span> <span class="st">"2020"</span>)</span>
<span id="cb3-20"><a href="#cb3-20"></a></span>
<span id="cb3-21"><a href="#cb3-21"></a></span>
<span id="cb3-22"><a href="#cb3-22"></a>ii <span class="ot">&lt;-</span> <span class="fu">treemap</span>(presupuesto,</span>
<span id="cb3-23"><a href="#cb3-23"></a>              <span class="at">index=</span><span class="st">"Partida_presupuesto"</span>,</span>
<span id="cb3-24"><a href="#cb3-24"></a>              <span class="at">vSize=</span><span class="st">"Valor"</span>,</span>
<span id="cb3-25"><a href="#cb3-25"></a>              <span class="at">type=</span><span class="st">"index"</span>,</span>
<span id="cb3-26"><a href="#cb3-26"></a>              <span class="at">border.col=</span><span class="fu">c</span>(<span class="st">"grey"</span>), </span>
<span id="cb3-27"><a href="#cb3-27"></a>              <span class="at">palette=</span><span class="st">"Dark2"</span>,</span>
<span id="cb3-28"><a href="#cb3-28"></a>              <span class="at">title=</span><span class="st">"Gasto del gobierno general por función en 2020"</span>,</span>
<span id="cb3-29"><a href="#cb3-29"></a>              <span class="at">fontsize.labels =</span> <span class="dv">8</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>Se puede ver que en el 2020, la educación fue el quinto servicio en el que más dinero invirtió el estado español, alrededor del 8,8%, situado por detrás de otros servicios como la protección social, la sanidad, los servicios públicos generales y los asuntos económicos.</p>
<p>Cabe resaltar también que no es tan importante cuánto dinero va destinado a un lugar, como puede ser sanidad, educación o defensa, si ese gasto no se usa correctamente o directamente no acaba en el sitio que le corresponde, lo que puede hacer que la gente pierda la confianza en el gobierno.</p>
<p>En este mapa, vamos a observar cuál es el grado de confianza que tienen los ciudadanos en relación al gasto que realiza su gobierno con el dinero público.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>confianza_gobierno <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/gobierno_aprobacion.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>educ_6 <span class="ot">&lt;-</span> confianza_gobierno <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">rename</span>(<span class="at">region =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">select</span>(region, Año, Valor)</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a>mapdata <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"world"</span>) </span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a>mapdata_2 <span class="ot">&lt;-</span>  mapdata <span class="sc">%&gt;%</span> </span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="fu">mutate</span>(<span class="at">Pais =</span> countrycode<span class="sc">::</span><span class="fu">countrycode</span>(<span class="at">sourcevar =</span> region, <span class="at">origin =</span> <span class="st">"country.name"</span>,</span>
<span id="cb4-11"><a href="#cb4-11"></a>                                         <span class="at">destination =</span>  <span class="st">"iso3c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb4-12"><a href="#cb4-12"></a></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="fu">data</span>(World)</span>
<span id="cb4-14"><a href="#cb4-14"></a>world <span class="ot">&lt;-</span> World ; <span class="fu">rm</span>(World)</span>
<span id="cb4-15"><a href="#cb4-15"></a></span>
<span id="cb4-16"><a href="#cb4-16"></a>world1 <span class="ot">&lt;-</span> world <span class="sc">%&gt;%</span> </span>
<span id="cb4-17"><a href="#cb4-17"></a>  <span class="fu">select</span>(<span class="at">region =</span> iso_a3, geometry) <span class="sc">%&gt;%</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>  <span class="fu">filter</span>(<span class="sc">!</span>region <span class="sc">==</span> <span class="st">"ATA"</span>)</span>
<span id="cb4-19"><a href="#cb4-19"></a></span>
<span id="cb4-20"><a href="#cb4-20"></a>mapa4 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(world1, educ_6, <span class="at">by =</span> <span class="st">"region"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb4-21"><a href="#cb4-21"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb4-22"><a href="#cb4-22"></a></span>
<span id="cb4-23"><a href="#cb4-23"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb4-24"><a href="#cb4-24"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> world1) <span class="sc">+</span></span>
<span id="cb4-25"><a href="#cb4-25"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mapa4, <span class="fu">aes</span>(<span class="at">fill =</span> Valor)) <span class="sc">+</span></span>
<span id="cb4-26"><a href="#cb4-26"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-27"><a href="#cb4-27"></a>    <span class="at">title =</span> <span class="st">"Año: {current_frame}"</span>) <span class="sc">+</span> <span class="fu">scale_fill_distiller</span>(<span class="at">name=</span><span class="st">"Confianza"</span>, <span class="at">palette =</span> <span class="st">"YlGn"</span>, <span class="at">trans =</span> <span class="st">"reverse"</span>) <span class="sc">+</span> <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb4-28"><a href="#cb4-28"></a>  <span class="fu">transition_manual</span>(Año) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"blank"</span>),</span>
<span id="cb4-29"><a href="#cb4-29"></a>                                 <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb4-30"><a href="#cb4-30"></a>                                 <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb4-31"><a href="#cb4-31"></a>                                                             <span class="at">family =</span> <span class="st">"mono"</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lightcyan"</span>),<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>,</span>
<span id="cb4-32"><a href="#cb4-32"></a>                                                                                                                                                                                                <span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb4-33"><a href="#cb4-33"></a>                                                                                                                                                                      <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Año {current_frame}"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>,</span>
<span id="cb4-34"><a href="#cb4-34"></a>    <span class="at">colour =</span> <span class="st">"gray32"</span>, <span class="at">hjust =</span> <span class="fl">0.05</span>))</span>
<span id="cb4-35"><a href="#cb4-35"></a></span>
<span id="cb4-36"><a href="#cb4-36"></a><span class="fu">animate</span>(gg, <span class="at">width =</span> <span class="dv">500</span>, <span class="at">height =</span> <span class="dv">500</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-5-1.gif" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>Como se puede observar, la mayoría de países no tienen la confianza de sus ciudadanos en cuanto al uso que hacen del dinero público, sobre todo en la época en la que se agravó la crisis del 2008, durante los años 2010-2014, debido principalmente a las altas tasas de paro que había en la mayoría de países y las medidas poco efectivas que tomaban.</p>
<p>Se puede observar también que en España la confianza fue cayendo paulatinamente hasta el 2018, que es más o menos cuando España empezó a recuperarse de los efectos de la crisis.</p>
<p>Para acabar con este apartado, vamos a aclarar unos aspectos del trabajo.</p>
<ul>
<li><p>Solo se va a tener en cuenta unas pocas variables que conforman el gasto en educación, ya que hay alrededor de 15 partidas pero solo se comentarán el gasto en las distintas etapas educativas: <em>educación infantil, educación primaria y secundaria y educación terciaria.</em></p></li>
<li><p>Se va a analizar el gasto en <strong>educación pública</strong> no el gasto realizado en educación privada.</p></li>
</ul></section><section id="contexto-español" class="level1"><h1>Contexto español</h1>
<p>Centrándonos en España, el gasto que se realiza en educación tiene dos problemas, no es suficiente y aparte es poco eficiente, en comparación con otros países de la Unión Europea y del G7.</p>
<p>Las consecuencias de la insuficiencia y poca efectividad del gasto se puede observar en las altas tasas de desempleo de población cualificada y no cualificada, la poca población con estudios terciarios o en los resultados obtenidos en las pruebas PISA.</p>
<div class="columns">
<div class="column" style="width:32%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<blockquote class="twitter-tweet blockquote" align="center" data-width="400" data-lang="en" data-dnt="true" data-theme="light">
<p lang="es" dir="ltr">España es el sexto país de la UE con el menor gasto público para Educación<a href="https://t.co/4IZeF29u6F">https://t.co/4IZeF29u6F</a> <a href="https://t.co/AUxQfNwFQs">pic.twitter.com/AUxQfNwFQs</a></p>— elEconomista.es (@elEconomistaes) <a href="https://twitter.com/elEconomistaes/status/1059866846478897152?ref_src=twsrc%5Etfw">November 6, 2018</a>
</blockquote>

</div>
</div>
</div><div class="column" style="width:1%;">
<!-- an empty Div (with a white space) haciendo de separador -->
</div><div class="column" style="width:32%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<blockquote class="twitter-tweet blockquote" align="center" data-width="400" data-lang="en" data-dnt="true" data-theme="light">
<p lang="es" dir="ltr">Solamente el 25% del gasto público total se destina a sanidad y educación. <br><br>El 75% restante está destinado, en gran medida, a mantener este Estado deficiente. Como las pensiones que son una estafa piramidal y un sistema quebrado.<br><br>La revolución en España será liberal o no será.</p>— Jano García (@janogarcia_) <a href="https://twitter.com/janogarcia_/status/1355274347510960129?ref_src=twsrc%5Etfw">January 29, 2021</a>
</blockquote>

</div>
</div>
</div><div class="column" style="width:1%;">
<!-- an empty Div (with a white space) haciendo de separador -->
</div><div class="column" style="width:32%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<blockquote class="twitter-tweet blockquote" align="center" data-width="400" data-lang="en" data-dnt="true" data-theme="light">
<p lang="es" dir="ltr">La tasa de paro de la poblacion Qualificada en España duplica a la de la media Europea<a href="https://t.co/pgOCt4CKcN">https://t.co/pgOCt4CKcN</a></p>— TrabajarenEuropa (@TrabajarEuropa) <a href="https://twitter.com/TrabajarEuropa/status/1140295846703042560?ref_src=twsrc%5Etfw">June 16, 2019</a>
</blockquote>

</div>
</div>
</div>
</div>
<p>Mediante este gráfico, podemos ver cómo ha ido evolucionando el gasto que se hace en educación en función del PIB.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>educacion_gasto_PIB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/Datos_educacion_PST.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>educ_1 <span class="ot">&lt;-</span> educacion_gasto_PIB <span class="sc">%&gt;%</span>  <span class="fu">rename</span>(<span class="at">Pais =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value, <span class="at">Educacion =</span> SUBJECT) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(FREQUENCY, Flag.Codes, INDICATOR, MEASURE)) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">filter</span>(Año <span class="sc">&gt;=</span> <span class="dv">2008</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="fu">filter</span>(Pais <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GBR"</span>,<span class="st">"CAN"</span>,<span class="st">"JPN"</span>,<span class="st">"ESP"</span>,<span class="st">"USA"</span>,<span class="st">"ITA"</span>,<span class="st">"DEU"</span>,<span class="st">"FRA"</span>,<span class="st">"PRT"</span>,<span class="st">"GRC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Educacion, <span class="at">values_from =</span> Valor) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="fu">mutate</span>(<span class="at">Gasto_total =</span> TRY <span class="sc">+</span> PRY_NTRY) <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(TRY, PRY_NTRY)) <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>  <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> Pais, </span>
<span id="cb5-13"><a href="#cb5-13"></a>                            <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb5-14"><a href="#cb5-14"></a>                            <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a>aa <span class="ot">&lt;-</span> educ_1 <span class="sc">%&gt;%</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> Año, <span class="at">y=</span> Gasto_total)) <span class="sc">+</span> </span>
<span id="cb5-18"><a href="#cb5-18"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Evolución % gasto en educación/PIB"</span>,</span>
<span id="cb5-19"><a href="#cb5-19"></a>       <span class="at">x =</span> <span class="st">"Año"</span>,</span>
<span id="cb5-20"><a href="#cb5-20"></a>       <span class="at">y =</span> <span class="st">"% Gasto/PIB"</span>,</span>
<span id="cb5-21"><a href="#cb5-21"></a>       <span class="at">color =</span> <span class="st">"Países"</span>) <span class="sc">+</span> <span class="fu">geom_flag</span>(<span class="fu">aes</span>(<span class="at">image =</span> iso2)) <span class="sc">+</span></span>
<span id="cb5-22"><a href="#cb5-22"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span> Pais), <span class="at">size=</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span> <span class="fu">c</span>(<span class="st">"coral1"</span>, <span class="st">"tan4"</span>, <span class="st">"yellow"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"green3"</span>, <span class="st">"darkmagenta"</span>,<span class="st">"green4"</span>,<span class="st">"cyan1"</span>)) <span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb5-25"><a href="#cb5-25"></a>                                  <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb5-26"><a href="#cb5-26"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb5-27"><a href="#cb5-27"></a>                                    <span class="at">vjust =</span> <span class="dv">0</span>),</span>
<span id="cb5-28"><a href="#cb5-28"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb5-29"><a href="#cb5-29"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb5-30"><a href="#cb5-30"></a>  <span class="fu">transition_reveal</span>(Año) <span class="sc">+</span> </span>
<span id="cb5-31"><a href="#cb5-31"></a>  <span class="fu">view_follow</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray87"</span>,</span>
<span id="cb5-32"><a href="#cb5-32"></a>                                                                     <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"aliceblue"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"blank"</span>),</span>
<span id="cb5-33"><a href="#cb5-33"></a>                                                                                                                                                        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>,</span>
<span id="cb5-34"><a href="#cb5-34"></a>                                                                                                                                                                                 <span class="at">size =</span> <span class="dv">9</span>, <span class="at">colour =</span> <span class="st">"gray17"</span>))</span>
<span id="cb5-35"><a href="#cb5-35"></a></span>
<span id="cb5-36"><a href="#cb5-36"></a><span class="fu">animate</span>(aa, <span class="at">width =</span> <span class="dv">500</span>, <span class="at">height =</span> <span class="dv">500</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-9-1.gif" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>Vemos que España sigue la misma tendencia y ronda el 4,5% gasto/PIB e incluso está por encima de países como Italia, Alemania o Japón, sin embargo, después las tasas de desempleo, formación y notas en las pruebas PISA son superiores a los de España.</p>
<p>Incluso Portugal está por encima en algunos periodos de Francia y España, pero al igual que España, ese gasto luego no tiene los resultados adecuados.</p>
<p>Desde un contexto europeo, también se puede comprobar que España está atrás en cuanto a inversión en educación se refiere respecto a los países europeos.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>gasto_total_educ <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/gasto_total_y_publico.csv"</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>educ_4 <span class="ot">&lt;-</span> gasto_total_educ <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">rename</span>(<span class="at">Pais =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(INDICATOR, MEASURE, FREQUENCY, Flag.Codes)) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">filter</span>(SUBJECT <span class="sc">==</span> <span class="st">"EDU"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">filter</span>(Año <span class="sc">&gt;=</span> <span class="st">"1995"</span>, Año <span class="sc">&lt;</span> <span class="st">"2021"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">select</span>(<span class="sc">-</span>SUBJECT) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>  <span class="fu">rename</span>(<span class="st">"region"</span> <span class="ot">=</span> Pais)</span>
<span id="cb6-10"><a href="#cb6-10"></a></span>
<span id="cb6-11"><a href="#cb6-11"></a></span>
<span id="cb6-12"><a href="#cb6-12"></a>world_map <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="dv">50</span>, <span class="at">returnclass =</span> <span class="st">'sf'</span>)</span>
<span id="cb6-13"><a href="#cb6-13"></a></span>
<span id="cb6-14"><a href="#cb6-14"></a>paises_europeos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Austria"</span>,<span class="st">"Belgium"</span>,<span class="st">"Bulgaria"</span>,<span class="st">"Croatia"</span>,<span class="st">"Cyprus"</span>,</span>
<span id="cb6-15"><a href="#cb6-15"></a>                     <span class="st">"Czech Rep."</span>,<span class="st">"Denmark"</span>,<span class="st">"Estonia"</span>,<span class="st">"Finland"</span>,<span class="st">"France"</span>,</span>
<span id="cb6-16"><a href="#cb6-16"></a>                     <span class="st">"Germany"</span>,<span class="st">"Greece"</span>,<span class="st">"Hungary"</span>,<span class="st">"Ireland"</span>,<span class="st">"Italy"</span>,<span class="st">"Latvia"</span>,</span>
<span id="cb6-17"><a href="#cb6-17"></a>                     <span class="st">"Lithuania"</span>,<span class="st">"Luxembourg"</span>,<span class="st">"Malta"</span>,<span class="st">"Netherlands"</span>,<span class="st">"Poland"</span>,</span>
<span id="cb6-18"><a href="#cb6-18"></a>                     <span class="st">"Portugal"</span>,<span class="st">"Romania"</span>,<span class="st">"Slovakia"</span>,<span class="st">"Slovenia"</span>,<span class="st">"Spain"</span>,</span>
<span id="cb6-19"><a href="#cb6-19"></a>                     <span class="st">"Sweden"</span>,<span class="st">"United Kingdom"</span>,<span class="st">"Switzerland"</span>,<span class="st">"Serbia"</span>,<span class="st">"Norway"</span>)</span>
<span id="cb6-20"><a href="#cb6-20"></a></span>
<span id="cb6-21"><a href="#cb6-21"></a>mapa_europa <span class="ot">&lt;-</span> world_map <span class="sc">%&gt;%</span> </span>
<span id="cb6-22"><a href="#cb6-22"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> paises_europeos) <span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="#cb6-23"></a>  <span class="fu">select</span>(<span class="fu">c</span>(name, iso_a3))</span>
<span id="cb6-24"><a href="#cb6-24"></a></span>
<span id="cb6-25"><a href="#cb6-25"></a>bbox_europe <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">ymin =</span> <span class="dv">20</span>, <span class="at">xmax =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">80</span>), <span class="at">crs =</span> <span class="fu">st_crs</span>(mapa_europa))</span>
<span id="cb6-26"><a href="#cb6-26"></a>european_union_map_cropped <span class="ot">&lt;-</span> <span class="fu">st_crop</span>(mapa_europa, bbox_europe)</span>
<span id="cb6-27"><a href="#cb6-27"></a></span>
<span id="cb6-28"><a href="#cb6-28"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">country =</span> paises_europeos,</span>
<span id="cb6-29"><a href="#cb6-29"></a>             <span class="at">some_value =</span> <span class="fu">runif</span>(<span class="fu">length</span>(paises_europeos)))</span>
<span id="cb6-30"><a href="#cb6-30"></a></span>
<span id="cb6-31"><a href="#cb6-31"></a></span>
<span id="cb6-32"><a href="#cb6-32"></a>map <span class="ot">&lt;-</span> european_union_map_cropped <span class="sc">%&gt;%</span> </span>
<span id="cb6-33"><a href="#cb6-33"></a>  <span class="fu">inner_join</span>(educ_4, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"iso_a3"</span> <span class="ot">=</span> <span class="st">"region"</span>))</span>
<span id="cb6-34"><a href="#cb6-34"></a></span>
<span id="cb6-35"><a href="#cb6-35"></a>dd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> map) <span class="sc">+</span></span>
<span id="cb6-36"><a href="#cb6-36"></a>  <span class="fu">geom_sf</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Valor)) <span class="sc">+</span></span>
<span id="cb6-37"><a href="#cb6-37"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">name=</span><span class="st">"%PIB"</span>, <span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">trans =</span> <span class="st">"reverse"</span>) <span class="sc">+</span></span>
<span id="cb6-38"><a href="#cb6-38"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb6-39"><a href="#cb6-39"></a>       <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb6-40"><a href="#cb6-40"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">"plot"</span>) <span class="sc">+</span> <span class="fu">transition_manual</span>(Año) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb6-41"><a href="#cb6-41"></a>    <span class="at">title =</span> <span class="st">"Año: {current_frame}"</span>,</span>
<span id="cb6-42"><a href="#cb6-42"></a>    <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb6-43"><a href="#cb6-43"></a>  <span class="fu">transition_manual</span>(Año) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"blank"</span>),</span>
<span id="cb6-44"><a href="#cb6-44"></a>                                 <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb6-45"><a href="#cb6-45"></a>                                 <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb6-46"><a href="#cb6-46"></a>                                                             <span class="at">family =</span> <span class="st">"mono"</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"aliceblue"</span>),<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"linen"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>, <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>)  </span>
<span id="cb6-47"><a href="#cb6-47"></a></span>
<span id="cb6-48"><a href="#cb6-48"></a><span class="fu">animate</span>(dd, <span class="at">width =</span> <span class="dv">500</span>, <span class="at">height =</span> <span class="dv">500</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-10-1.gif" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>Aquí también se puede ver con más detalle la evolución que ha habido del gasto en educación sobre el PIB comparado con el gasto en educación sobre el gasto público.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>gasto_total_educacion_PIB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/gasto_total_y_publico.csv"</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a>educ_3 <span class="ot">&lt;-</span> gasto_total_educacion_PIB <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">rename</span>(<span class="at">Pais =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value, <span class="at">Educacion =</span> SUBJECT) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(INDICATOR, MEASURE, FREQUENCY, Flag.Codes)) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="fu">filter</span>(Pais <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GBR"</span>,<span class="st">"CAN"</span>,<span class="st">"JPN"</span>,<span class="st">"ESP"</span>,<span class="st">"USA"</span>,<span class="st">"ITA"</span>,<span class="st">"DEU"</span>,<span class="st">"FRA"</span>,<span class="st">"PRT"</span>,<span class="st">"GRC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="fu">filter</span>(Año <span class="sc">&gt;=</span> <span class="st">"1995"</span>, Año <span class="sc">&lt;</span> <span class="st">"2021"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Educacion, <span class="at">values_from =</span> Valor) <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> Pais, </span>
<span id="cb7-10"><a href="#cb7-10"></a>                            <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb7-11"><a href="#cb7-11"></a>                            <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>  <span class="fu">mutate</span>(<span class="at">Prop_gasto_educ =</span> ((EDU <span class="sc">*</span> <span class="dv">100</span>)<span class="sc">/</span>TOT)) <span class="co">#Se refiere al % del gasto publico que se usa en educacion</span></span>
<span id="cb7-13"><a href="#cb7-13"></a></span>
<span id="cb7-14"><a href="#cb7-14"></a></span>
<span id="cb7-15"><a href="#cb7-15"></a>cc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(educ_3, </span>
<span id="cb7-16"><a href="#cb7-16"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Prop_gasto_educ , <span class="at">y=</span> EDU)) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17"></a>  <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"% Gasto educación/Gasto público"</span>, <span class="at">y =</span> <span class="st">"% Gasto educación/PIB"</span>) <span class="sc">+</span> </span>
<span id="cb7-18"><a href="#cb7-18"></a>  <span class="fu">theme_solarized</span>() <span class="sc">+</span> </span>
<span id="cb7-19"><a href="#cb7-19"></a>  <span class="fu">transition_time</span>(Año) <span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20"></a>  <span class="fu">labs</span>( </span>
<span id="cb7-21"><a href="#cb7-21"></a>       <span class="at">subtitle =</span> <span class="st">"Año: {frame_time}"</span>) <span class="sc">+</span></span>
<span id="cb7-22"><a href="#cb7-22"></a>  <span class="fu">geom_flag</span>(<span class="fu">aes</span>(<span class="at">image =</span> iso2)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray59"</span>,</span>
<span id="cb7-23"><a href="#cb7-23"></a>                                                                       <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray59"</span>,</span>
<span id="cb7-24"><a href="#cb7-24"></a>                                                                                                                             <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"mono"</span>,</span>
<span id="cb7-25"><a href="#cb7-25"></a>                                                                                                                                                                             <span class="at">size =</span> <span class="dv">14</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"aliceblue"</span>),</span>
<span id="cb7-26"><a href="#cb7-26"></a>                                       <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>,</span>
<span id="cb7-27"><a href="#cb7-27"></a>                                                                                                                       <span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"mono"</span>))</span>
<span id="cb7-28"><a href="#cb7-28"></a></span>
<span id="cb7-29"><a href="#cb7-29"></a></span>
<span id="cb7-30"><a href="#cb7-30"></a><span class="fu">animate</span>(cc, <span class="at">width =</span> <span class="dv">600</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">fps =</span> <span class="dv">2</span>, </span>
<span id="cb7-31"><a href="#cb7-31"></a>        <span class="at">duration =</span> <span class="dv">15</span>, <span class="at">rewind =</span> <span class="cn">FALSE</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-11-1.gif" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>Se puede ver que el peso que tiene la educación en el presupuesto español no ha variado mucho y se ha mantenido constante en el tiempo</p>
<p>Entonces, si aunque invirtamos más no significa obtener mejores resultados, que hay que hacer para poder lograrlos?</p>
<section id="división-del-gasto-en-educación" class="level2"><h2 class="anchored" data-anchor-id="división-del-gasto-en-educación">División del gasto en educación</h2>
<p>Un motivo que podría explicar los malos resultados que obtiene España podría ser que el gasto en educación no esta bien repartido entre las distintas etapas educativas o incluso se aplique un sistema educativo obsoleto y poco eficaz.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/zoQN6ncR4Uo" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
</div>
<p>Por eso vamos a desglosar el gasto en educación en tres ramas: educación infantil, educación primaria y secundaria y educación terciaria y ponerlas en una gráfica.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>educacion_segmento <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/Datos_educacion_completo.csv"</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a>educ_2 <span class="ot">&lt;-</span> educacion_segmento <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">rename</span>(<span class="at">Pais =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value, <span class="at">Etapa_educativa =</span> SUBJECT) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(FREQUENCY, Flag.Codes, INDICATOR, MEASURE)) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="fu">filter</span>(Año <span class="sc">&gt;=</span> <span class="dv">2008</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="fu">filter</span>(Pais <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GBR"</span>,<span class="st">"CAN"</span>,<span class="st">"JPN"</span>,<span class="st">"ESP"</span>,<span class="st">"USA"</span>,<span class="st">"ITA"</span>,<span class="st">"DEU"</span>,<span class="st">"FRA"</span>,<span class="st">"PRT"</span>,<span class="st">"GRC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="fu">mutate</span>(<span class="at">Educacion =</span> forcats<span class="sc">::</span><span class="fu">fct_recode</span>(Etapa_educativa,</span>
<span id="cb8-10"><a href="#cb8-10"></a>                                         <span class="st">"Educación infantil"</span> <span class="ot">=</span> <span class="st">"EARLYCHILDEDU"</span>,</span>
<span id="cb8-11"><a href="#cb8-11"></a>                                         <span class="st">"Primaria y Secundaria"</span> <span class="ot">=</span> <span class="st">"PRY_NTRY"</span>, </span>
<span id="cb8-12"><a href="#cb8-12"></a>                                         <span class="st">"Educación Terciaria"</span>  <span class="ot">=</span> <span class="st">"TRY"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>  <span class="fu">select</span>(<span class="sc">-</span>Etapa_educativa)</span>
<span id="cb8-14"><a href="#cb8-14"></a></span>
<span id="cb8-15"><a href="#cb8-15"></a></span>
<span id="cb8-16"><a href="#cb8-16"></a></span>
<span id="cb8-17"><a href="#cb8-17"></a>bb <span class="ot">&lt;-</span> educ_2 <span class="sc">%&gt;%</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> Año, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb8-19"><a href="#cb8-19"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Evolución % gasto en educación/PIB"</span>,</span>
<span id="cb8-20"><a href="#cb8-20"></a>       <span class="at">x =</span> <span class="st">"Año"</span>,</span>
<span id="cb8-21"><a href="#cb8-21"></a>       <span class="at">y =</span> <span class="st">"Gasto"</span>,</span>
<span id="cb8-22"><a href="#cb8-22"></a>       <span class="at">color =</span> <span class="st">"Países"</span>) <span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span> Pais), <span class="at">size=</span> <span class="fl">1.75</span>) <span class="sc">+</span></span>
<span id="cb8-24"><a href="#cb8-24"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span> Pais), <span class="at">size=</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values=</span> <span class="fu">c</span>(<span class="st">"coral1"</span>, <span class="st">"tan4"</span>, <span class="st">"yellow"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"green3"</span>, <span class="st">"darkmagenta"</span>,<span class="st">"green4"</span>,<span class="st">"cyan1"</span>)) <span class="sc">+</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(</span>
<span id="cb8-26"><a href="#cb8-26"></a>    <span class="fu">vars</span>(Educacion), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">3</span>,<span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.6</span>,</span>
<span id="cb8-27"><a href="#cb8-27"></a>                                                                                          <span class="at">linetype =</span> <span class="st">"solid"</span>), <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray14"</span>,</span>
<span id="cb8-28"><a href="#cb8-28"></a>                                                                                                                                         <span class="at">linetype =</span> <span class="st">"dotdash"</span>), <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"ivory3"</span>,</span>
<span id="cb8-29"><a href="#cb8-29"></a>                                                                                                                                                                                                <span class="at">size =</span> <span class="fl">0.4</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>), <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"blank"</span>),</span>
<span id="cb8-30"><a href="#cb8-30"></a>                                                                 <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb8-31"><a href="#cb8-31"></a>                                                                 <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>,</span>
<span id="cb8-32"><a href="#cb8-32"></a>                                                                                          <span class="at">colour =</span> <span class="st">"gray24"</span>), <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>,</span>
<span id="cb8-33"><a href="#cb8-33"></a>                                                                                                                                        <span class="at">size =</span> <span class="dv">15</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb8-34"><a href="#cb8-34"></a>                                                                                                                                                                                            <span class="at">family =</span> <span class="st">"serif"</span>), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>,</span>
<span id="cb8-35"><a href="#cb8-35"></a>                                                                                                                                                                                                                                           <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb8-36"><a href="#cb8-36"></a>                                                                 <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"cornsilk1"</span>,</span>
<span id="cb8-37"><a href="#cb8-37"></a>                                                                                                 <span class="at">linetype =</span> <span class="st">"solid"</span>), <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"blanchedalmond"</span>,</span>
<span id="cb8-38"><a href="#cb8-38"></a>                                                                                                                                                     <span class="at">colour =</span> <span class="cn">NA</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb8-39"><a href="#cb8-39"></a>                                                                 <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb8-40"><a href="#cb8-40"></a>                                                                 <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>)) <span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Evolución del gasto en educación sobre el PIB"</span>,</span>
<span id="cb8-41"><a href="#cb8-41"></a>                                                                                                                    <span class="at">x =</span> <span class="st">"Años"</span>, <span class="at">y =</span> <span class="st">"% Gasto educación/PIB"</span>,</span>
<span id="cb8-42"><a href="#cb8-42"></a>                                                                                                                    </span>
<span id="cb8-43"><a href="#cb8-43"></a>                                                                                                                    <span class="at">caption =</span> <span class="st">"Datos de la OECD"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb8-44"><a href="#cb8-44"></a>                                                                                                                                                                                                                                   <span class="at">hjust =</span> <span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(</span>
<span id="cb8-45"><a href="#cb8-45"></a>                                                                                                                                                                                                                                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2008</span>, <span class="dv">2019</span>, <span class="dv">1</span>),</span>
<span id="cb8-46"><a href="#cb8-46"></a>                                                                                                                                                                                                                                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2008</span>, <span class="dv">2019</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">1.075</span>))</span>
<span id="cb8-47"><a href="#cb8-47"></a></span>
<span id="cb8-48"><a href="#cb8-48"></a>bb </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>Si observamos detenidamente el gráfico, se ve que la inversión que realizan en educación terciaria o superior, países como Estados Unidos, Reino Unido o Japón, es decir, países muy ricos y desarrollados es superior a la inversión que realiza España, Portugal o Grecia.</p>
<p>Este detalle es importante, porque la educación superior pretende formar individuos que sean capaces de impulsar el desarrollo económico y social de un país.</p>
<p>También se ve que el gasto en la etapa de secundaria y primaria, es superior también, lo que podría traducirse en mejores resultados en las pruebas PISA, aunque no necesariamente como veremos más adelante.</p>
</section></section><section id="pruebas-pisa" class="level1"><h1>Pruebas PISA</h1>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="imagenes/pisa.png" class="img-fluid figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<p>Como se mencionó anteriormente, las pruebas PISA, son un Programa para la Evaluación Internacional de Alumnos de la OCDE (PISA, por sus siglas en inglés), que tiene como objetivo evaluar que puntos los alumnos cercanos al final de la educación obligatoria han adquirido algunos de los conocimientos y habilidades necesarios para la participación plena en la sociedad del saber.</p>
<p>PISA saca a relucir aquellos países que han alcanzado un buen rendimiento y, al mismo, tiempo, un reparto equitativo de oportunidades de aprendizaje, ayudando asi a establecer metas ambiciosas para otros países.</p>
<p>Estas pruebas son realizadas cada tres años. Examinan el rendimiento de alumnos de 15 años en áreas temáticas claves como son lectura, matemáticas y ciencias.</p>
<section id="analisis-de-datos" class="level2"><h2 class="anchored" data-anchor-id="analisis-de-datos">Analisis de datos</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Mates</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Lectura</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Ciencia</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Tabla</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>En la prueba de matemáticas, el quinto mejor es Corea del sur, con una media de 539,4 y el mas cercano de los vecinos de España es Francia, con 495,2 y España con 483,2 por debajo de Portugal. Siendo el mejor Singapur con 564 de media, la diferencia es increíble, segundo Hong Kong y tercero Macao.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">#españa  y sus vecinos junto a los mejores 5 mejores de mates</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>z<span class="ot">&lt;-</span><span class="fu">full_join</span>(VECINOS, mejores_mates)</span>
<span id="cb9-3"><a href="#cb9-3"></a>z <span class="ot">&lt;-</span> z <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">mutate</span>(<span class="at">media_mate =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(media_mates), <span class="at">media_lecture =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(media_lectura), <span class="at">media_cience =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(media_ciencias)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> LOCATION, </span>
<span id="cb9-5"><a href="#cb9-5"></a>                                                                                     <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb9-6"><a href="#cb9-6"></a>                                                                                     <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a></span>
<span id="cb9-9"><a href="#cb9-9"></a>z <span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="fu">arrange</span>(media_mates) <span class="sc">%&gt;%</span>    <span class="co"># First sort by val. This sort the dataframe but NOT the factor levels</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="fu">mutate</span>(<span class="at">media_matef=</span><span class="fu">factor</span>( media_mates, <span class="at">levels=</span>media_mate)) <span class="sc">%&gt;%</span>   <span class="co"># This trick update the factor levels</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>LOCATION, <span class="at">y=</span>media_matef))<span class="sc">+</span> </span>
<span id="cb9-13"><a href="#cb9-13"></a>  <span class="fu">geom_flag</span>( <span class="fu">aes</span>(<span class="at">image =</span> iso2))<span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend=</span>LOCATION, <span class="at">yend=</span><span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span><span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Los 5 mejores en matemáticas'</span>, </span>
<span id="cb9-16"><a href="#cb9-16"></a>                   <span class="at">subtitle=</span><span class="st">'junto a España y sus vecinos'</span>, </span>
<span id="cb9-17"><a href="#cb9-17"></a>                   <span class="at">caption=</span><span class="st">'Fuente: OCDE'</span>,</span>
<span id="cb9-18"><a href="#cb9-18"></a>                  <span class="at">x=</span> <span class="st">"Paises"</span>, <span class="at">y=</span><span class="st">'Notas'</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>En la prueba de Lectura, el quinto mejor es Canadá con 524,2 luego observamos a Francia con 496,2 que esta vez la distancia es mucho menor, luego tenemos a Portugal que supera a España por casi 7 puntos y les siguen Italia y Grecia. El mejor en esta prueba vuelve a ser Singapur con 535, segundo Corea y tercero Finlandia.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">#españa  y sus vecinos junto a los mejores 5 mejores de lectura</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>za<span class="ot">&lt;-</span><span class="fu">full_join</span>(VECINOS, mejores_lectura)</span>
<span id="cb10-3"><a href="#cb10-3"></a>za <span class="ot">&lt;-</span>za <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">mutate</span>( <span class="at">media_lecture =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(media_lectura)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> LOCATION, </span>
<span id="cb10-5"><a href="#cb10-5"></a>                                                                                                                                                                                           <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb10-6"><a href="#cb10-6"></a>                                                                                                                                                                                           <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>za <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="fu">arrange</span>(media_lecture) <span class="sc">%&gt;%</span>    <span class="co"># First sort by val. This sort the dataframe but NOT the factor levels</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="fu">mutate</span>(<span class="at">media_lecturef=</span><span class="fu">factor</span>( media_lectura, <span class="at">levels=</span>media_lecture)) <span class="sc">%&gt;%</span>   <span class="co"># This trick update the factor levels</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>LOCATION, <span class="at">y=</span>media_lecturef))<span class="sc">+</span> </span>
<span id="cb10-12"><a href="#cb10-12"></a>  <span class="fu">geom_flag</span>( <span class="fu">aes</span>(<span class="at">image =</span> iso2))<span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend=</span>LOCATION, <span class="at">yend=</span><span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb10-15"><a href="#cb10-15"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span><span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Los 5 mejores en Lectura'</span>, </span>
<span id="cb10-16"><a href="#cb10-16"></a>                     <span class="at">subtitle=</span><span class="st">'junto a España y sus vecinos'</span>, </span>
<span id="cb10-17"><a href="#cb10-17"></a>                     <span class="at">caption=</span><span class="st">'Fuente: OCDE'</span>,</span>
<span id="cb10-18"><a href="#cb10-18"></a>                     <span class="at">x=</span> <span class="st">"Paises"</span>, <span class="at">y=</span><span class="st">'Notas'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>En la prueba de Ciencias, el quinto mejor es Taiwan, con una media de 532, luego observamos a Francia con 496 y España con 491,25 superando a Portugal, Italia y a Grecia. El mejor en esta prueba vuelve a ser Singapur con 556, segundo Finlandia y tercero Japón.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># España  y sus vecinos junto a los mejores 5 mejores de ciencia</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>zb<span class="ot">&lt;-</span><span class="fu">full_join</span>(VECINOS, mejores_ciencias)</span>
<span id="cb11-3"><a href="#cb11-3"></a>zb <span class="ot">&lt;-</span>zb <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">mutate</span>( <span class="at">media_ciencie =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(media_ciencias)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> LOCATION, </span>
<span id="cb11-5"><a href="#cb11-5"></a>                                                                                            <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb11-6"><a href="#cb11-6"></a>                                                                                            <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a>zb <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="fu">arrange</span>(media_ciencias) <span class="sc">%&gt;%</span>    <span class="co"># First sort by val. This sort the dataframe but NOT the factor levels</span></span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="fu">mutate</span>(<span class="at">media_ciencief=</span><span class="fu">factor</span>( media_ciencias, <span class="at">levels=</span>media_ciencie)) <span class="sc">%&gt;%</span>   <span class="co"># This trick update the factor levels</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>LOCATION, <span class="at">y=</span>media_ciencief))<span class="sc">+</span> </span>
<span id="cb11-12"><a href="#cb11-12"></a>  <span class="fu">geom_flag</span>( <span class="fu">aes</span>(<span class="at">image =</span> iso2))<span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend=</span>LOCATION, <span class="at">yend=</span><span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span><span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Los 5 mejores en Ciencias'</span>, </span>
<span id="cb11-16"><a href="#cb11-16"></a>                   <span class="at">subtitle=</span><span class="st">'junto a España y sus vecinos'</span>, </span>
<span id="cb11-17"><a href="#cb11-17"></a>                   <span class="at">caption=</span><span class="st">'Fuente: OCDE'</span>,</span>
<span id="cb11-18"><a href="#cb11-18"></a>                   <span class="at">x=</span> <span class="st">"Paises"</span>, <span class="at">y=</span><span class="st">'Notas'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>Como podemos observar, España y sus vecinos están muy lejos de estar entre los mejores de cada prueba, pudiendo destacar que Francia es superior en todas las pruebas si lo comparamos con España,Grecia, Italia y Portugal.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>df_flags <span class="ot">&lt;-</span> w <span class="sc">%&gt;%</span> <span class="co">#- fips</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> LOCATION, </span>
<span id="cb12-3"><a href="#cb12-3"></a>                            <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb12-4"><a href="#cb12-4"></a>                            <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">tolower</span>(iso2)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="co"># glue:glue() : pega texto con "código", con objetos de R: los objetos tienen que ir entre corchetes {}</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="fu">mutate</span>(<span class="at">flag_URL =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'https://hatscripts.github.io/circle-flags/flags/{iso2}.svg'</span>), <span class="at">.before=</span>LOCATION) </span>
<span id="cb12-8"><a href="#cb12-8"></a>tt_flags <span class="ot">&lt;-</span> df_flags<span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">6</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb12-9"><a href="#cb12-9"></a></span>
<span id="cb12-10"><a href="#cb12-10"></a></span>
<span id="cb12-11"><a href="#cb12-11"></a>tt_flags <span class="ot">&lt;-</span> tt_flags <span class="sc">%&gt;%</span> <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**España junto a sus vecinos y los 9 Paises con mejores medias en las pruebas Pisa**"</span>),</span>
<span id="cb12-12"><a href="#cb12-12"></a>                                <span class="at">subtitle =</span> <span class="fu">md</span>(<span class="st">"Datos de *Hombres y Mujeres*"</span>))</span>
<span id="cb12-13"><a href="#cb12-13"></a></span>
<span id="cb12-14"><a href="#cb12-14"></a>tt_flags <span class="ot">&lt;-</span> tt_flags <span class="sc">%&gt;%</span> <span class="fu">cols_label</span>(<span class="at">media_mates =</span> <span class="fu">md</span>(<span class="st">"**Matemáticas**"</span>), <span class="at">LOCATION=</span> <span class="fu">md</span>(<span class="st">"**Paises**"</span>), <span class="at">media_ciencias =</span> <span class="fu">md</span>(<span class="st">"**Ciencias**"</span>), <span class="at">media_lectura =</span> <span class="fu">md</span>(<span class="st">"**Lectura**"</span>),<span class="at">flag_URL =</span> <span class="fu">md</span>(<span class="st">"**Banderas**"</span>)) </span>
<span id="cb12-15"><a href="#cb12-15"></a>tt_flags <span class="ot">&lt;-</span> tt_flags <span class="sc">%&gt;%</span> </span>
<span id="cb12-16"><a href="#cb12-16"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(media_mates, media_ciencias, media_lectura),</span>
<span id="cb12-17"><a href="#cb12-17"></a>             <span class="at">decimals =</span><span class="dv">2</span>, </span>
<span id="cb12-18"><a href="#cb12-18"></a>             <span class="at">sep_mark =</span> <span class="st">"."</span>, </span>
<span id="cb12-19"><a href="#cb12-19"></a>             <span class="at">dec_mark =</span> <span class="st">","</span>) </span>
<span id="cb12-20"><a href="#cb12-20"></a></span>
<span id="cb12-21"><a href="#cb12-21"></a>tabla<span class="ot">&lt;-</span> tt_flags <span class="sc">%&gt;%</span> </span>
<span id="cb12-22"><a href="#cb12-22"></a>  gt<span class="sc">::</span><span class="fu">text_transform</span>(<span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> <span class="fu">c</span>(flag_URL)), </span>
<span id="cb12-23"><a href="#cb12-23"></a>                     <span class="at">fn =</span> <span class="cf">function</span>(x){gt<span class="sc">::</span><span class="fu">web_image</span>(x, <span class="at">height =</span> <span class="dv">30</span>)})</span>
<span id="cb12-24"><a href="#cb12-24"></a>tabla<span class="ot">&lt;-</span> tabla <span class="sc">%&gt;%</span> <span class="fu">opt_stylize</span>(<span class="at">style =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>)  <span class="co">#- red</span></span>
<span id="cb12-25"><a href="#cb12-25"></a>tabla</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div id="fnipawgjnz" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#fnipawgjnz) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A81600;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A81600;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#fnipawgjnz) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#fnipawgjnz) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#fnipawgjnz) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#fnipawgjnz) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #E4220C;
}

:where(#fnipawgjnz) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #E4220C;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #E4220C;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#fnipawgjnz) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#fnipawgjnz) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#fnipawgjnz) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#fnipawgjnz) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#fnipawgjnz) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #E4220C;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#fnipawgjnz) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #E4220C;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #E4220C;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

:where(#fnipawgjnz) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #E4220C;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #E4220C;
  vertical-align: middle;
}

:where(#fnipawgjnz) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#fnipawgjnz) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#fnipawgjnz) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: none;
  border-top-width: 1px;
  border-top-color: #FFCCC7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #FFCCC7;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #FFCCC7;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#fnipawgjnz) .gt_stub {
  color: #FFFFFF;
  background-color: #E4220C;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #E4220C;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#fnipawgjnz) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#fnipawgjnz) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#fnipawgjnz) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#fnipawgjnz) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #E4220C;
}

:where(#fnipawgjnz) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#fnipawgjnz) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #E4220C;
}

:where(#fnipawgjnz) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFCCC7;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#fnipawgjnz) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #E4220C;
}

:where(#fnipawgjnz) .gt_striped {
  background-color: #F4F4F4;
}

:where(#fnipawgjnz) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #E4220C;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #E4220C;
}

:where(#fnipawgjnz) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#fnipawgjnz) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#fnipawgjnz) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#fnipawgjnz) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#fnipawgjnz) .gt_left {
  text-align: left;
}

:where(#fnipawgjnz) .gt_center {
  text-align: center;
}

:where(#fnipawgjnz) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#fnipawgjnz) .gt_font_normal {
  font-weight: normal;
}

:where(#fnipawgjnz) .gt_font_bold {
  font-weight: bold;
}

:where(#fnipawgjnz) .gt_font_italic {
  font-style: italic;
}

:where(#fnipawgjnz) .gt_super {
  font-size: 65%;
}

:where(#fnipawgjnz) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#fnipawgjnz) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#fnipawgjnz) .gt_indent_1 {
  text-indent: 5px;
}

:where(#fnipawgjnz) .gt_indent_2 {
  text-indent: 10px;
}

:where(#fnipawgjnz) .gt_indent_3 {
  text-indent: 15px;
}

:where(#fnipawgjnz) .gt_indent_4 {
  text-indent: 20px;
}

:where(#fnipawgjnz) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
<thead class="gt_header">
<tr>
<td colspan="5" class="gt_heading gt_title gt_font_normal" style=""><strong>España junto a sus vecinos y los 9 Paises con mejores medias en las pruebas Pisa</strong></td>
    </tr>
<tr>
<td colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style="">Datos de <em>Hombres y Mujeres</em>
</td>
    </tr>
</thead>
<thead class="gt_col_headings"><tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col"><strong>Banderas</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col"><strong>Paises</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col"><strong>Matemáticas</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col"><strong>Ciencias</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col"><strong>Lectura</strong></th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td class="gt_row gt_center"><img src="https://hatscripts.github.io/circle-flags/flags/es.svg" style="height:30px;"></td>
<td class="gt_row gt_left">ESP</td>
<td class="gt_row gt_right">483,25</td>
<td class="gt_row gt_right">491,25</td>
<td class="gt_row gt_right">481,50</td>
</tr>
<tr>
<td class="gt_row gt_center gt_striped"><img src="https://hatscripts.github.io/circle-flags/flags/fr.svg" style="height:30px;"></td>
<td class="gt_row gt_left gt_striped">FRA</td>
<td class="gt_row gt_right gt_striped">495,20</td>
<td class="gt_row gt_right gt_striped">496,00</td>
<td class="gt_row gt_right gt_striped">496,20</td>
</tr>
<tr>
<td class="gt_row gt_center"><img src="https://hatscripts.github.io/circle-flags/flags/gr.svg" style="height:30px;"></td>
<td class="gt_row gt_left">GRC</td>
<td class="gt_row gt_right">456,60</td>
<td class="gt_row gt_right">463,40</td>
<td class="gt_row gt_right">468,80</td>
</tr>
<tr>
<td class="gt_row gt_center gt_striped"><img src="https://hatscripts.github.io/circle-flags/flags/it.svg" style="height:30px;"></td>
<td class="gt_row gt_left gt_striped">ITA</td>
<td class="gt_row gt_right gt_striped">481,40</td>
<td class="gt_row gt_right gt_striped">481,40</td>
<td class="gt_row gt_right gt_striped">481,20</td>
</tr>
<tr>
<td class="gt_row gt_center"><img src="https://hatscripts.github.io/circle-flags/flags/pt.svg" style="height:30px;"></td>
<td class="gt_row gt_left">PRT</td>
<td class="gt_row gt_right">484,80</td>
<td class="gt_row gt_right">489,80</td>
<td class="gt_row gt_right">487,80</td>
</tr>
<tr>
<td class="gt_row gt_center gt_striped"><img src="https://hatscripts.github.io/circle-flags/flags/sg.svg" style="height:30px;"></td>
<td class="gt_row gt_left gt_striped">SGP</td>
<td class="gt_row gt_right gt_striped">564,00</td>
<td class="gt_row gt_right gt_striped">556,00</td>
<td class="gt_row gt_right gt_striped">535,00</td>
</tr>
<tr>
<td class="gt_row gt_center"><img src="https://hatscripts.github.io/circle-flags/flags/hk.svg" style="height:30px;"></td>
<td class="gt_row gt_left">HKG</td>
<td class="gt_row gt_right">548,00</td>
<td class="gt_row gt_right">523,00</td>
<td class="gt_row gt_right">527,00</td>
</tr>
<tr>
<td class="gt_row gt_center gt_striped"><img src="https://hatscripts.github.io/circle-flags/flags/mo.svg" style="height:30px;"></td>
<td class="gt_row gt_left gt_striped">MAC</td>
<td class="gt_row gt_right gt_striped">544,00</td>
<td class="gt_row gt_right gt_striped">529,00</td>
<td class="gt_row gt_right gt_striped">509,00</td>
</tr>
<tr>
<td class="gt_row gt_center"><img src="https://hatscripts.github.io/circle-flags/flags/tw.svg" style="height:30px;"></td>
<td class="gt_row gt_left">TWN</td>
<td class="gt_row gt_right">542,00</td>
<td class="gt_row gt_right">532,00</td>
<td class="gt_row gt_right">497,00</td>
</tr>
<tr>
<td class="gt_row gt_center gt_striped"><img src="https://hatscripts.github.io/circle-flags/flags/kr.svg" style="height:30px;"></td>
<td class="gt_row gt_left gt_striped">KOR</td>
<td class="gt_row gt_right gt_striped">539,40</td>
<td class="gt_row gt_right gt_striped">526,60</td>
<td class="gt_row gt_right gt_striped">532,40</td>
</tr>
<tr>
<td class="gt_row gt_center"><img src="https://hatscripts.github.io/circle-flags/flags/fi.svg" style="height:30px;"></td>
<td class="gt_row gt_left">FIN</td>
<td class="gt_row gt_right">525,20</td>
<td class="gt_row gt_right">543,00</td>
<td class="gt_row gt_right">530,60</td>
</tr>
<tr>
<td class="gt_row gt_center gt_striped"><img src="https://hatscripts.github.io/circle-flags/flags/jp.svg" style="height:30px;"></td>
<td class="gt_row gt_left gt_striped">JPN</td>
<td class="gt_row gt_right gt_striped">529,40</td>
<td class="gt_row gt_right gt_striped">536,80</td>
<td class="gt_row gt_right gt_striped">515,20</td>
</tr>
<tr>
<td class="gt_row gt_center"><img src="https://hatscripts.github.io/circle-flags/flags/ee.svg" style="height:30px;"></td>
<td class="gt_row gt_left">EST</td>
<td class="gt_row gt_right">518,20</td>
<td class="gt_row gt_right">532,80</td>
<td class="gt_row gt_right">512,00</td>
</tr>
<tr>
<td class="gt_row gt_center gt_striped"><img src="https://hatscripts.github.io/circle-flags/flags/ca.svg" style="height:30px;"></td>
<td class="gt_row gt_left gt_striped">CAN</td>
<td class="gt_row gt_right gt_striped">520,00</td>
<td class="gt_row gt_right gt_striped">526,80</td>
<td class="gt_row gt_right gt_striped">524,20</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Podemos observar que existe una notable diferencia entre los países asiáticos y los europeos, el único país europeo que podemos apreciar que se encuentra entre los mejores es Finlandia. España está muy por debajo y entre los cinco 4 vecinos que hemos escogido podemos ver que en dos de las tres pruebas, España se encuentra peor que Francia y que Portugal.</p>
</section><section id="evolución-de-las-notas-de-las-pruebas-pisa" class="level2"><h2 class="anchored" data-anchor-id="evolución-de-las-notas-de-las-pruebas-pisa">Evolución de las notas de las pruebas PISA</h2>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Grafica final</span></span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a>datos_gt_movil_long <span class="ot">&lt;-</span> datos_gt_movil <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb13-4"><a href="#cb13-4"></a>                                                              <span class="at">names_to =</span> <span class="st">"pruebas"</span>,</span>
<span id="cb13-5"><a href="#cb13-5"></a>                                                              <span class="at">values_to =</span> <span class="st">"notas"</span> )</span>
<span id="cb13-6"><a href="#cb13-6"></a>datos_gt_movil_long <span class="ot">&lt;-</span> datos_gt_movil_long <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="fu">mutate</span>(<span class="at">prueba =</span> <span class="fu">case_when</span>( </span>
<span id="cb13-8"><a href="#cb13-8"></a>    pruebas<span class="sc">==</span><span class="st">"mates"</span>  <span class="sc">~</span> <span class="st">"Matemáticas"</span>,</span>
<span id="cb13-9"><a href="#cb13-9"></a>    pruebas<span class="sc">==</span><span class="st">"ciencia"</span>  <span class="sc">~</span> <span class="st">"Ciencias"</span> ,</span>
<span id="cb13-10"><a href="#cb13-10"></a>    pruebas<span class="sc">==</span><span class="st">"Lectura"</span> <span class="sc">~</span> <span class="st">"Lectura"</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>  )) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>pruebas)</span>
<span id="cb13-12"><a href="#cb13-12"></a></span>
<span id="cb13-13"><a href="#cb13-13"></a>grafico2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>( <span class="at">data=</span> datos_gt_movil_long, <span class="fu">aes</span>(<span class="at">x=</span>TIME, <span class="at">y=</span>notas)) <span class="sc">+</span> <span class="fu">geom_line</span>( <span class="fu">aes</span>(<span class="at">color=</span> LOCATION) , <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>   <span class="fu">theme_ipsum</span>() <span class="sc">+</span> <span class="fu">geom_flag</span>(<span class="fu">aes</span>(<span class="at">image =</span> iso2))<span class="sc">+</span> </span>
<span id="cb13-15"><a href="#cb13-15"></a>   <span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Evolución de las notas de la prueba PISA'</span>, </span>
<span id="cb13-16"><a href="#cb13-16"></a>       <span class="at">subtitle=</span><span class="st">'España y sus vecinos'</span>, </span>
<span id="cb13-17"><a href="#cb13-17"></a>       <span class="at">caption=</span><span class="st">'Proceedings of the National Academy of Sciences, 104 (3):1051-1056, 2007'</span>,</span>
<span id="cb13-18"><a href="#cb13-18"></a>       <span class="at">x=</span><span class="st">'Año'</span>, <span class="at">y=</span><span class="st">'Notas'</span>)<span class="sc">+</span> </span>
<span id="cb13-19"><a href="#cb13-19"></a>   <span class="fu">transition_reveal</span>(TIME)<span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>   <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">'Anton'</span>, <span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb13-21"><a href="#cb13-21"></a>         <span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">'Anton'</span>),</span>
<span id="cb13-22"><a href="#cb13-22"></a>         <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">'Anton'</span>, <span class="at">face=</span><span class="st">'bold'</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb13-23"><a href="#cb13-23"></a>         <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">'Anton'</span>, <span class="at">face=</span><span class="st">'bold'</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>   <span class="fu">view_follow</span>()  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray87"</span>,</span>
<span id="cb13-25"><a href="#cb13-25"></a>                                                                      <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"darkolivegreen"</span>), <span class="at">legend.position=</span><span class="st">'none'</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(prueba), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol=</span> <span class="dv">3</span>)</span>
<span id="cb13-26"><a href="#cb13-26"></a> </span>
<span id="cb13-27"><a href="#cb13-27"></a> <span class="fu">animate</span>(grafico2, <span class="at">width=</span><span class="dv">1000</span>, <span class="at">height=</span><span class="dv">500</span>, <span class="at">fps=</span><span class="dv">10</span>)</span>
<span id="cb13-28"><a href="#cb13-28"></a> </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-19-1.gif" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>En la <strong>prueba de Ciencias</strong>, observamos como en 2006 España era el segundo mejor de los 5, siendo superado solo por Francia. Es bastante curioso el increíble crecimiento que experimenta Portugal e Italia en los primeros años de la serie. En 2012 Italia obtiene su mayor nota en cuanto a ciencias, con 494. posicionándose como tercera, por detrás de Portugal y Francia. Portugal en 2015 es cuando obtiene su nota más alta, 501, pero posteriormente tanto Portugal como Italia experimentan un descenso notable. Por otra parte, tenemos a Grecia, país que desde que la serie empieza no hace nada más que caer, pasando de 473 en 2006 a tener 452 en 2018.</p>
<p>En la <strong>prueba de Matemáticas</strong>, se aprecia algo similar a la prueba de ciencias, Francia parte como primera, Portugal e Italia experimentan un incremento bastante palpable, Portugal pasando de 466 en 2006 a 492 en 2018 e Italia pasando de 462 en 2006 a 487 en 2018. España se mantiene prácticamente plana y Grecia experimenta una pequeña mejora y luego se hunde.</p>
<p>En la <strong>prueba de lectura</strong>, observamos que los primeros años de la serie todos los países observan un incremento en sus notas hasta 2009, cuando curiosamente se empieza a sufrir la gran recesión. Pero es bastante raro que España y Portugal a diferencia de sus vecinos no vieran sus notan descender sino al contrario. España pasó de 461 en 2006 a 496 en 2015. Portugal pasó de 472 en 2006 a 492 en 2015, llegando a obtener 498 en 2015. Francia pasó de 488 en 2006 a 493 en 2018 llegando a su máximo en 2012 con 505. Italia pasó de 469 en 2006 a 476 en 2018 y Grecia pasó de 460 en 2006 a 457 en 2018, llegando a tener 483 en 2009. Por tanto, viéndolo de manera general, el único país que está peor que en 2006 es Grecia.</p>
<p>De manera general podemos ver que la mayoría de países experimenta un incremento en sus notas en los primeros años de la serie, luego se observa un descenso generalizado aproximadamente en 2012 y luego se observa una reversión de esa tendencia y los países vuelve a recuperar en parte lo perdido, lo que nos llevaría a la siguiente parte de este trabajo, donde buscaremos responder a la siguiente pregunta:</p>
<p><em>¿Tiene alguna relación las notas que los países sacan en las pruebas PISA con el gasto que los países destinan a educación?</em></p>
</section></section><section id="modelo-de-regresión" class="level1"><h1>Modelo de Regresión</h1>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>datos_educacion.csv <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/Datos_educacion_completo.csv"</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a>datos1<span class="ot">&lt;-</span> datos_educacion.csv <span class="sc">%&gt;%</span>  </span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">rename</span>(<span class="at">Pais =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value, <span class="at">Educacion =</span> SUBJECT) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(INDICATOR, MEASURE, FREQUENCY, Flag.Codes)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-6"><a href="#cb14-6"></a>  <span class="fu">filter</span>(Año <span class="sc">&gt;=</span> <span class="dv">2006</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb14-7"><a href="#cb14-7"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-8"><a href="#cb14-8"></a>  <span class="fu">mutate</span>(<span class="at">Educacion =</span> forcats<span class="sc">::</span><span class="fu">fct_recode</span>(Educacion,</span>
<span id="cb14-9"><a href="#cb14-9"></a>                                                   <span class="st">"Educación infantil"</span> <span class="ot">=</span> <span class="st">"EARLYCHILDEDU"</span>,</span>
<span id="cb14-10"><a href="#cb14-10"></a>                                                   <span class="st">"Primaria y Secundaria"</span> <span class="ot">=</span> <span class="st">"PRY_NTRY"</span>, </span>
<span id="cb14-11"><a href="#cb14-11"></a>                                                   <span class="st">"Educación Terciaria"</span>  <span class="ot">=</span> <span class="st">"TRY"</span>))</span>
<span id="cb14-12"><a href="#cb14-12"></a>pisa_ciencias<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/pisa_ciencias.csv"</span>)</span>
<span id="cb14-13"><a href="#cb14-13"></a>pisa_mates <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/pisa_mates.csv"</span>)</span>
<span id="cb14-14"><a href="#cb14-14"></a>pisa_lectura <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/pisa_lectura.csv"</span>)</span>
<span id="cb14-15"><a href="#cb14-15"></a>df <span class="ot">&lt;-</span> pisa_mates <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>)</span>
<span id="cb14-16"><a href="#cb14-16"></a>df1<span class="ot">&lt;-</span>pisa_ciencias <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>)</span>
<span id="cb14-17"><a href="#cb14-17"></a>df1 <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">ciencia=</span>Value)</span>
<span id="cb14-18"><a href="#cb14-18"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">rename</span> (<span class="at">mates=</span>Value)</span>
<span id="cb14-19"><a href="#cb14-19"></a>pisa_lectura <span class="ot">&lt;-</span> pisa_lectura <span class="sc">%&gt;%</span> <span class="fu">select</span>(LOCATION,TIME, Value)</span>
<span id="cb14-20"><a href="#cb14-20"></a>pisa_lectura <span class="ot">&lt;-</span> pisa_lectura <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Lectura=</span>Value)</span>
<span id="cb14-21"><a href="#cb14-21"></a>pisa<span class="ot">&lt;-</span> <span class="fu">inner_join</span>(df,df1)</span>
<span id="cb14-22"><a href="#cb14-22"></a>pisa <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(pisa, pisa_lectura)</span>
<span id="cb14-23"><a href="#cb14-23"></a></span>
<span id="cb14-24"><a href="#cb14-24"></a>pisa <span class="ot">&lt;-</span> pisa <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(SUBJECT))</span>
<span id="cb14-25"><a href="#cb14-25"></a></span>
<span id="cb14-26"><a href="#cb14-26"></a></span>
<span id="cb14-27"><a href="#cb14-27"></a>df_modelo <span class="ot">&lt;-</span> <span class="fu">left_join</span>(pisa, datos1, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"LOCATION"</span> <span class="ot">=</span> <span class="st">"Pais"</span>,<span class="st">"TIME"</span> <span class="ot">=</span> <span class="st">"Año"</span> ))</span>
<span id="cb14-28"><a href="#cb14-28"></a></span>
<span id="cb14-29"><a href="#cb14-29"></a>df_modelo <span class="ot">&lt;-</span> df_modelo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Educacion <span class="sc">==</span> <span class="st">"Primaria y Secundaria"</span>) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Para ver la relación entre las notas de los estudiantes en las pruebas PISA con el gasto que los países destinan a la educación. Hemos calculado el modelo de regresión lineal y las correlaciones entre estos dos factores.</p>
<p>El modelo de regresión lineal nos sirve para describir una variable de respuesta continua como una función de una o varias variables predictoras. Y la correlación nos indica la fuerza y la dirección de una relación lineal y proporcionalidad entre dos variables estadísticas.</p>
<p>A continuación, en la siguiente tabla podemos observar esta tabla con las regresiones lineales de las notas de las pruebas de Matemáticas, Ciencias y Lectura con el gasto de educación.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a></span>
<span id="cb15-2"><a href="#cb15-2"></a>my_modelmates <span class="ot">&lt;-</span> <span class="fu">lm</span>(mates <span class="sc">~</span> Valor, <span class="at">data =</span> df_modelo)</span>
<span id="cb15-3"><a href="#cb15-3"></a>my_modelmates</span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">#&gt; </span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">#&gt; Call:</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#&gt; lm(formula = mates ~ Valor, data = df_modelo)</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#&gt; </span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">#&gt; (Intercept)        Valor  </span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#&gt;     493.580       -1.054</span></span>
<span id="cb15-11"><a href="#cb15-11"></a></span>
<span id="cb15-12"><a href="#cb15-12"></a>my_modelciencia <span class="ot">&lt;-</span> <span class="fu">lm</span>(ciencia <span class="sc">~</span> Valor, <span class="at">data =</span> df_modelo)</span>
<span id="cb15-13"><a href="#cb15-13"></a>my_modelciencia</span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">#&gt; </span></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co">#&gt; Call:</span></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co">#&gt; lm(formula = ciencia ~ Valor, data = df_modelo)</span></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co">#&gt; </span></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="co">#&gt; (Intercept)        Valor  </span></span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="co">#&gt;      492.42         0.52</span></span>
<span id="cb15-21"><a href="#cb15-21"></a></span>
<span id="cb15-22"><a href="#cb15-22"></a>my_modelLectura <span class="ot">&lt;-</span> <span class="fu">lm</span>(Lectura <span class="sc">~</span> Valor, <span class="at">data =</span> df_modelo)</span>
<span id="cb15-23"><a href="#cb15-23"></a>my_modelLectura</span>
<span id="cb15-24"><a href="#cb15-24"></a><span class="co">#&gt; </span></span>
<span id="cb15-25"><a href="#cb15-25"></a><span class="co">#&gt; Call:</span></span>
<span id="cb15-26"><a href="#cb15-26"></a><span class="co">#&gt; lm(formula = Lectura ~ Valor, data = df_modelo)</span></span>
<span id="cb15-27"><a href="#cb15-27"></a><span class="co">#&gt; </span></span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb15-29"><a href="#cb15-29"></a><span class="co">#&gt; (Intercept)        Valor  </span></span>
<span id="cb15-30"><a href="#cb15-30"></a><span class="co">#&gt;     479.220        3.371</span></span>
<span id="cb15-31"><a href="#cb15-31"></a></span>
<span id="cb15-32"><a href="#cb15-32"></a></span>
<span id="cb15-33"><a href="#cb15-33"></a> </span>
<span id="cb15-34"><a href="#cb15-34"></a></span>
<span id="cb15-35"><a href="#cb15-35"></a><span class="co">#- O también podemos estimarlos en una lista.</span></span>
<span id="cb15-36"><a href="#cb15-36"></a>my_models <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb15-37"><a href="#cb15-37"></a>my_models[[<span class="st">'W:  OLS 1'</span>]]   <span class="ot">&lt;-</span> <span class="fu">lm</span>( mates  <span class="sc">~</span> Valor, df_modelo)</span>
<span id="cb15-38"><a href="#cb15-38"></a>my_models[[<span class="st">'W:  OLS 2'</span>]]   <span class="ot">&lt;-</span> <span class="fu">lm</span>( ciencia  <span class="sc">~</span> Valor , df_modelo)</span>
<span id="cb15-39"><a href="#cb15-39"></a>my_models[[<span class="st">'W:  OLS 3'</span>]]   <span class="ot">&lt;-</span> <span class="fu">lm</span>( Lectura  <span class="sc">~</span> Valor , df_modelo)</span>
<span id="cb15-40"><a href="#cb15-40"></a></span>
<span id="cb15-41"><a href="#cb15-41"></a></span>
<span id="cb15-42"><a href="#cb15-42"></a></span>
<span id="cb15-43"><a href="#cb15-43"></a><span class="do">###Estimación de los modelos -----------</span></span>
<span id="cb15-44"><a href="#cb15-44"></a></span>
<span id="cb15-45"><a href="#cb15-45"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(my_models, <span class="at">show.ci    =</span> <span class="cn">FALSE</span>, <span class="at">title =</span> <span class="st">"Modelo de regresión lineal entre el gasto de educación y las notas PISA"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<table style="border-collapse:collapse; border:none;">
<caption style="font-weight: bold; text-align:left;">Modelo de regresión lineal entre el gasto de educación y las notas PISA</caption>
<tbody><tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">&nbsp;</th>
<th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">mates</th>
<th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">ciencia</th>
<th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">Lectura</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">Predictors</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">p</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">Estimates</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">p</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">(Intercept)</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">493.58</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">492.42</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "><strong>&lt;0.001</strong></td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">479.22</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>&lt;0.001</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">Valor</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">-1.05</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.469</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.52</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">0.709</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">3.37</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7"><strong>0.014</strong></td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">Observations</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="2">1154</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="2">1154</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="2">1154</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">0.000 / -0.000</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">0.000 / -0.001</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2">0.005 / 0.004</td>
</tr>
</tbody></table>
</div>
</div>
<p>Por tanto, podemos determinar viendo los coeficientes que cuando el gasto de educación aumenta por una unidad:</p>
<ul>
<li><p>Las notas de matemáticas bajan por 1.06 unidades</p></li>
<li><p>Las notas de ciencias suben por 0.49 unidades</p></li>
<li><p>Las notas de lectura suben por 3.36 unidades</p></li>
</ul>
<p>También observando el R cuadrado, que nos indica sí podemos explicar o predecir una variable haciendo uso de la otra. Por tanto, podemos determinar que <strong>no existe ajuste</strong> o es casi nulo entre las notas PISA y el gasto en educación.</p>
<p>En cuanto al valor de P, normalmente los estudios de R suelen realizarse bajo un nivel de confianza del 95%. Así que podemos concluir que el gasto de educación no es válido para predecir la variable de las notas de las pruebas PISA.</p>
<p>También podemos observar la regresión con estas gráficas.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Regresión Ciencias</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Regresión Lectura</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Regresión Matemáticas</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(my_modelciencia, <span class="at">sort.est =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Regresión lineal entre el gasto en educación y las notas de ciencias (PISA)"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(my_modelLectura, <span class="at">sort.est =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Regresión lineal entre el gasto en educación y las notas de Lectura (PISA)"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(my_modelmates, <span class="at">sort.est =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Regresión lineal entre el gasto en educación y las notas de matemáticas (PISA)"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Aquí se puede ver la regresión de otra manera.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a></span>
<span id="cb19-2"><a href="#cb19-2"></a>plot1<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my_modelmates, <span class="fu">aes</span>(<span class="at">x=</span>mates, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my_modelciencia, <span class="fu">aes</span>(<span class="at">x=</span>ciencia, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb19-8"><a href="#cb19-8"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb19-11"><a href="#cb19-11"></a></span>
<span id="cb19-12"><a href="#cb19-12"></a>plot3<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my_modelLectura, <span class="fu">aes</span>(<span class="at">x=</span>Lectura, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb19-13"><a href="#cb19-13"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb19-16"><a href="#cb19-16"></a></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="fu">grid.arrange</span>(plot1, plot2, plot3)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>En cuanto a la correlación, podemos observar que entre el gasto de educación y las notas de las pruebas PISA, de ciencias y lectura tienen una correlación positiva débil. Y entre el gasto de educación y las notas PISA de matemáticas tiene una correlación negativa débil. Donde podemos verlo, en la siguiente gráfica.</p>
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="do">##Correlacion-------------------- </span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="fu">cor</span>(df_modelo<span class="sc">$</span>ciencia, df_modelo<span class="sc">$</span>Valor)</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">#&gt; [1] 0.01100711</span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="fu">cor</span>(df_modelo<span class="sc">$</span>mates, df_modelo<span class="sc">$</span>Valor)</span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">#&gt; [1] -0.02132917</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="fu">cor</span>(df_modelo<span class="sc">$</span>Lectura, df_modelo<span class="sc">$</span>Valor)</span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">#&gt; [1] 0.07220233</span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co">#cor(data)</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>modelo_interaccion <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Valor <span class="sc">~</span> mates <span class="sc">+</span> ciencia <span class="sc">+</span> Lectura, <span class="at">data =</span> df_modelo)</span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="fu">summary</span>(modelo_interaccion)</span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co">#&gt; </span></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co">#&gt; Call:</span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="co">#&gt; lm(formula = Valor ~ mates + ciencia + Lectura, data = df_modelo)</span></span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="co">#&gt; </span></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="co">#&gt; -1.30725 -0.50285  0.02466  0.40728  1.49769 </span></span>
<span id="cb20-18"><a href="#cb20-18"></a><span class="co">#&gt; </span></span>
<span id="cb20-19"><a href="#cb20-19"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb20-20"><a href="#cb20-20"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb20-21"><a href="#cb20-21"></a><span class="co">#&gt; (Intercept)  3.137027   0.322471   9.728  &lt; 2e-16 ***</span></span>
<span id="cb20-22"><a href="#cb20-22"></a><span class="co">#&gt; mates       -0.004694   0.001523  -3.083   0.0021 ** </span></span>
<span id="cb20-23"><a href="#cb20-23"></a><span class="co">#&gt; ciencia      0.001321   0.001753   0.754   0.4512    </span></span>
<span id="cb20-24"><a href="#cb20-24"></a><span class="co">#&gt; Lectura      0.004271   0.001078   3.962 7.88e-05 ***</span></span>
<span id="cb20-25"><a href="#cb20-25"></a><span class="co">#&gt; ---</span></span>
<span id="cb20-26"><a href="#cb20-26"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span id="cb20-27"><a href="#cb20-27"></a><span class="co">#&gt; </span></span>
<span id="cb20-28"><a href="#cb20-28"></a><span class="co">#&gt; Residual standard error: 0.6077 on 1150 degrees of freedom</span></span>
<span id="cb20-29"><a href="#cb20-29"></a><span class="co">#&gt; Multiple R-squared:  0.02003,    Adjusted R-squared:  0.01747 </span></span>
<span id="cb20-30"><a href="#cb20-30"></a><span class="co">#&gt; F-statistic: 7.834 on 3 and 1150 DF,  p-value: 3.538e-05</span></span>
<span id="cb20-31"><a href="#cb20-31"></a></span>
<span id="cb20-32"><a href="#cb20-32"></a></span>
<span id="cb20-33"><a href="#cb20-33"></a><span class="co">#Ajustamos datos para que solo haya variables numéricas</span></span>
<span id="cb20-34"><a href="#cb20-34"></a>data <span class="ot">&lt;-</span> df_modelo <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(LOCATION, TIME, Educacion)) <span class="co"># Variables numéricas</span></span>
<span id="cb20-35"><a href="#cb20-35"></a></span>
<span id="cb20-36"><a href="#cb20-36"></a>data2009 <span class="ot">&lt;-</span> df_modelo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(TIME<span class="sc">==</span> <span class="st">"2009"</span>) <span class="co">#2009 CRISIS</span></span>
<span id="cb20-37"><a href="#cb20-37"></a>data2018 <span class="ot">&lt;-</span> df_modelo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(TIME<span class="sc">==</span><span class="st">"2018"</span>)  <span class="co">#2018</span></span>
<span id="cb20-38"><a href="#cb20-38"></a></span>
<span id="cb20-39"><a href="#cb20-39"></a><span class="do">###Gráfica correlación -----</span></span>
<span id="cb20-40"><a href="#cb20-40"></a></span>
<span id="cb20-41"><a href="#cb20-41"></a><span class="fu">pairs</span>(data)</span>
<span id="cb20-42"><a href="#cb20-42"></a></span>
<span id="cb20-43"><a href="#cb20-43"></a><span class="co">#Gráfica correlación colores</span></span>
<span id="cb20-44"><a href="#cb20-44"></a></span>
<span id="cb20-45"><a href="#cb20-45"></a></span>
<span id="cb20-46"><a href="#cb20-46"></a><span class="fu">corrplot.mixed</span>(<span class="fu">cor</span>(data),</span>
<span id="cb20-47"><a href="#cb20-47"></a>               <span class="at">lower =</span> <span class="st">"number"</span>, </span>
<span id="cb20-48"><a href="#cb20-48"></a>               <span class="at">upper =</span> <span class="st">"circle"</span>,</span>
<span id="cb20-49"><a href="#cb20-49"></a>               <span class="at">tl.col =</span> <span class="st">"black"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>En último lugar, ¿Existe la misma relación entre las notas y el gasto público entre el primer año obtenido de datos y el último? ¿La crisis del 2008 afectó a las notas de los estudiantes?</p>
<p>Por ello, hemos obtenido estas gráficas comparativas entre estos años (2009 y 2018)</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Matemáticas 2009</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Matemáticas 2018</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Ciencias 2009</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Ciencias 2018</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">Lectura 2009</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-6" role="tab" aria-controls="tabset-4-6" aria-selected="false">Lectura 2018</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>plot4<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2009, <span class="fu">aes</span>(<span class="at">x=</span>mates, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparación entre la regresión lineal entre 2009 y 2018"</span>)</span>
<span id="cb21-5"><a href="#cb21-5"></a>plot4</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>plot5<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2018, <span class="fu">aes</span>(<span class="at">x=</span>mates, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">theme_light</span>() </span>
<span id="cb22-5"><a href="#cb22-5"></a>plot5</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>plot6<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2009, <span class="fu">aes</span>(<span class="at">x=</span>ciencia, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb23-2"><a href="#cb23-2"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparación entre la regresión lineal entre 2009 y 2018"</span>)</span>
<span id="cb23-5"><a href="#cb23-5"></a>plot6</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>plot7<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2018, <span class="fu">aes</span>(<span class="at">x=</span>ciencia, <span class="at">y=</span> Valor)) <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb24-4"><a href="#cb24-4"></a>plot7</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>plot8<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2009, <span class="fu">aes</span>(<span class="at">x=</span>Lectura, <span class="at">y=</span> Valor)) <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>                 <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>                 <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparación entre la regresión lineal entre 2009 y 2018"</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a>plot8</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-6-tab">
<div class="cell" data-layout-align="center">
<details><summary>Código</summary><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>plot9<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2018, <span class="fu">aes</span>(<span class="at">x=</span>Lectura, <span class="at">y=</span> Valor)) <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">theme_light</span>() </span>
<span id="cb26-4"><a href="#cb26-4"></a>plot9</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="my_trabajo_BigData_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Y podemos observar que la tendencia de 2009 a 2018 es más negativa y dispersada. Por tanto, la relación entre estos años no es la misma.</p>
<p>En último lugar, concluimos que la relación entre el gasto y las notas obtenidas en el test PISA es muy débil. Por ello, la crisis de 2008 pudo afectar a las notas de los estudiantes, pero el gasto no es un factor determinante.</p>
<section id="conclusiones" class="level2"><h2 class="anchored" data-anchor-id="conclusiones">Conclusiones</h2>
<p>La educación es un gasto principal en cada economía por su impacto tanto económico como social. La eficiencia del gasto en educación depende del uso correcto de los fondos por parte de los gobiernos. Por tanto, el grado de confianza de los ciudadanos en el Estado, se reduce.</p>
<p>En el caso de España, el gasto en educación es insuficiente y poco eficiente ya que no tiene tanto impacto económicamente como se refleja en las tasas de desempleo. En comparativa con otros países de la OECD, España pertenece al grupo donde el efecto del gasto es menor dado que también su inversión es menor. En cuanto al rendimiento de los estudiantes, que son el factor principal del gasto en educación, evaluamos las pruebas PISA. Donde se divide en tres ramas, Matemáticas, Lectura y Ciencias.</p>
<p>En las pruebas podemos observar que España y sus vecinos como Grecia, Italia o Portugal están alejados de formar parte de los mejores de cada prueba. Donde resalta Francia que, en diferencia a los países anteriormente mencionados, su valor es superior a estos. Cabe destacar la gran disparidad entre los países asiáticos y europeos donde los países asiáticos se encuentran entre los mejores.</p>
<p>Al observar la evolución de las notas de las pruebas PISA, se experimenta un crecimiento aproximado en forma de U. Primero ascienden las notas, desciende aproximadamente por el 2012 y luego vuelve a ascender. ¿Esta evolución puede ser causada por las fluctuaciones del gasto en educación?</p>
<p>Para contestar a esta pregunta, efectuamos el modelo de regresión estudiando su regresión lineal y la correlación entre las variables. Tras observar variables como r cuadrado, el coeficiente o el valor de P, concluimos que relación entre el gasto de educación y las notas de las pruebas PISA es mínimo, no válido para predicciones y que el ajuste es casi nulo o no existe.</p>
<p>En conclusión, aunque la relación entre el gasto de educación y las notas de las pruebas PISA sea débil, es remarcable que en ambas variables su rendimiento es bajo en comparativa con otros países de la OECD. Por tanto, España y sus vecinos, deberían incrementar su gasto, pero de manera más eficiente y observar las diferencias en comparativa con Asia o Finlandia y aprender de ellas en cuanto a los conocimientos de los estudiantes evaluados por las pruebas PISA.</p>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Ejecutar el código</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb27" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb27-1"><a href="#cb27-1"></a><span class="co">---</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="an">title:</span><span class="co"> "La evolución del gasto en educación en España y su relación con las pruebas PISA"</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="an">description:</span><span class="co"> |</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co">  Analizando el gasto que destinan diferentes paises en relación a España y veremos si hay alguna relación con los resultados de la prueba PISA</span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="co">- name: Naira Carruccio (naicavi@alumni.uv.es) </span></span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="co">- name: Alex Monzó (amonsan7@alumni.uv.es)                </span></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co">- name: Luis Antonio Pérez (luispepa@alumni.uv.es)</span></span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="an">date:</span><span class="co"> 2022-12-16                      </span></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="an">categories:</span><span class="co"> [trabajo Big Data]   </span></span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="an">image:</span><span class="co"> "./imagenes/imagen_01.png"</span></span>
<span id="cb27-12"><a href="#cb27-12"></a><span class="an">title-block-banner:</span><span class="co"> true #- {true, false, "green","#AA0000"}</span></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="an">title-block-banner-color:</span><span class="co"> "DCDCDC"    #-"#FFFFFF" </span></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="an">toc-location:</span><span class="co"> left</span></span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="an">toc-depth:</span><span class="co"> 3</span></span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="an">smooth-scroll:</span><span class="co"> true</span></span>
<span id="cb27-18"><a href="#cb27-18"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb27-19"><a href="#cb27-19"></a><span class="co">  html:</span></span>
<span id="cb27-20"><a href="#cb27-20"></a><span class="co">    mainfont: serif</span></span>
<span id="cb27-21"><a href="#cb27-21"></a><span class="co">    #backgroundcolor: "#F1F3F4"</span></span>
<span id="cb27-22"><a href="#cb27-22"></a><span class="co">    #embed-resources: true</span></span>
<span id="cb27-23"><a href="#cb27-23"></a><span class="co">    link-external-newwindow: true</span></span>
<span id="cb27-24"><a href="#cb27-24"></a><span class="co">    #css: ./assets/my_css_file.css   #- CUIDADO!!!!</span></span>
<span id="cb27-25"><a href="#cb27-25"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb27-26"><a href="#cb27-26"></a><span class="an">code-link:</span><span class="co"> true</span></span>
<span id="cb27-27"><a href="#cb27-27"></a><span class="co">---</span></span>
<span id="cb27-28"><a href="#cb27-28"></a></span>
<span id="cb27-29"><a href="#cb27-29"></a></span>
<span id="cb27-30"><a href="#cb27-30"></a><span class="fu"># Introducción</span></span>
<span id="cb27-31"><a href="#cb27-31"></a></span>
<span id="cb27-34"><a href="#cb27-34"></a><span class="in">```{r}</span></span>
<span id="cb27-35"><a href="#cb27-35"></a><span class="in">```</span></span>
<span id="cb27-36"><a href="#cb27-36"></a></span>
<span id="cb27-37"><a href="#cb27-37"></a>El trabajo que vamos a realizar se puede dividir en tres partes:</span>
<span id="cb27-38"><a href="#cb27-38"></a></span>
<span id="cb27-39"><a href="#cb27-39"></a></span>
<span id="cb27-40"><a href="#cb27-40"></a><span class="ss">- </span>En primer lugar, analizaremos el gasto que realizan los distintos gobiernos generales de una serie de países sobre el gasto en educación; algunos países que serán objetivo de este análisis serán: el principal país será **España**, país sobre el que recae el trabajo y que para observar mejor cómo ha ido evolucionando su situación y todo lo demás, la compararemos con los países que conforman el G7: Estados Unidos, Reino Unido, Canadá, Italia, Francia, Japón y Alemania, además de algunos países vecinos como Portugal o Grecia, que aparte son similares a España.</span>
<span id="cb27-41"><a href="#cb27-41"></a></span>
<span id="cb27-42"><a href="#cb27-42"></a><span class="ss">- </span>En segundo lugar, analizaremos los resultados de las **pruebas PISA**, un estudio que realiza la OECD y que consta de unos exámenes que realizan los alumnos de todo el mundo cuyo objetivo no es analizar a los alumnos sino el sistema que los educa, que no es lo mismo. Estos se componen de tres campos: matemáticas, ciencia y lectura y se realizan cada 3 años en alumnos de 15 años de edad.</span>
<span id="cb27-43"><a href="#cb27-43"></a></span>
<span id="cb27-44"><a href="#cb27-44"></a><span class="ss">- </span>Por último, detallaremos un modelo en el cual pretendemos observar si hay relación entre el gasto que realiza el gobierno en educación y las notas que se obtienen en dichas pruebas y ver si tiene correlación o no.</span>
<span id="cb27-45"><a href="#cb27-45"></a></span>
<span id="cb27-46"><a href="#cb27-46"></a>El motivo por el cual hemos elegido hacer el trabajo sobre el gasto en educación es porque hemos considerado que es una de las variables más importantes y que más influyen en el crecimiento de un país, tanto a nivel cultural, como económico y social y es una herramienta que el gobierno puede modificar a conveniencia, por lo tanto, es una herramiento muy importante y poderosa.</span>
<span id="cb27-47"><a href="#cb27-47"></a></span>
<span id="cb27-48"><a href="#cb27-48"></a></span>
<span id="cb27-49"><a href="#cb27-49"></a></span>
<span id="cb27-50"><a href="#cb27-50"></a><span class="fu"># Datos del trabajo</span></span>
<span id="cb27-51"><a href="#cb27-51"></a></span>
<span id="cb27-52"><a href="#cb27-52"></a>::: {.panel-tabset}</span>
<span id="cb27-53"><a href="#cb27-53"></a></span>
<span id="cb27-54"><a href="#cb27-54"></a><span class="fu">## Datos usados</span></span>
<span id="cb27-55"><a href="#cb27-55"></a></span>
<span id="cb27-56"><a href="#cb27-56"></a>Los datos del trabajo han sido extraídos de diversas fuentes como pueden ser el Eurostat, la UNESCO o la OECD. Está última ha sido la que más datos nos ha proporcionado para realizar el trabajo, pues es de donde se han extraído los principales datos de las pruebas PISA y del gasto en educación.</span>
<span id="cb27-57"><a href="#cb27-57"></a></span>
<span id="cb27-58"><a href="#cb27-58"></a>Por otro lado, los datos se han obtenido en formato csv en su conjunto, el cual es un buen formato para poder empezar a trabajar con ellos (en nuestra opinión el mejor) ya que con otros formatos como excel hemos tenido problemas a la hora de editarlos y poder manejarlos correctamente.</span>
<span id="cb27-59"><a href="#cb27-59"></a></span>
<span id="cb27-60"><a href="#cb27-60"></a><span class="fu">## Códigos</span></span>
<span id="cb27-61"><a href="#cb27-61"></a></span>
<span id="cb27-64"><a href="#cb27-64"></a><span class="in">```{r}</span></span>
<span id="cb27-65"><a href="#cb27-65"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-66"><a href="#cb27-66"></a></span>
<span id="cb27-67"><a href="#cb27-67"></a><span class="co">#ESTOS SON LOS PAQUETES QUE HEMOS UTILIZADO A LO LARGO DEL TRABAJO</span></span>
<span id="cb27-68"><a href="#cb27-68"></a></span>
<span id="cb27-69"><a href="#cb27-69"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb27-70"><a href="#cb27-70"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb27-71"><a href="#cb27-71"></a><span class="fu">library</span>(gt)</span>
<span id="cb27-72"><a href="#cb27-72"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb27-73"><a href="#cb27-73"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb27-74"><a href="#cb27-74"></a><span class="fu">library</span>(countrycode)</span>
<span id="cb27-75"><a href="#cb27-75"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb27-76"><a href="#cb27-76"></a><span class="fu">library</span>(ggimage)</span>
<span id="cb27-77"><a href="#cb27-77"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb27-78"><a href="#cb27-78"></a><span class="fu">library</span>(sf)</span>
<span id="cb27-79"><a href="#cb27-79"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb27-80"><a href="#cb27-80"></a><span class="fu">library</span>(rnaturalearthdata)</span>
<span id="cb27-81"><a href="#cb27-81"></a><span class="fu">library</span>(ggThemeAssist)</span>
<span id="cb27-82"><a href="#cb27-82"></a><span class="fu">library</span>(mapdata)</span>
<span id="cb27-83"><a href="#cb27-83"></a><span class="fu">library</span>(maps)</span>
<span id="cb27-84"><a href="#cb27-84"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb27-85"><a href="#cb27-85"></a><span class="fu">library</span>(tmap)</span>
<span id="cb27-86"><a href="#cb27-86"></a><span class="fu">library</span>(treemap)</span>
<span id="cb27-87"><a href="#cb27-87"></a><span class="fu">library</span>(tweetrmd)</span>
<span id="cb27-88"><a href="#cb27-88"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb27-89"><a href="#cb27-89"></a><span class="fu">library</span>(glue)</span>
<span id="cb27-90"><a href="#cb27-90"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb27-91"><a href="#cb27-91"></a><span class="fu">library</span>(devtools)</span>
<span id="cb27-92"><a href="#cb27-92"></a><span class="fu">library</span>(gclus)</span>
<span id="cb27-93"><a href="#cb27-93"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb27-94"><a href="#cb27-94"></a><span class="fu">library</span>(vembedr)</span>
<span id="cb27-95"><a href="#cb27-95"></a></span>
<span id="cb27-96"><a href="#cb27-96"></a></span>
<span id="cb27-97"><a href="#cb27-97"></a></span>
<span id="cb27-98"><a href="#cb27-98"></a></span>
<span id="cb27-99"><a href="#cb27-99"></a><span class="co"># PRIMERO CARGAMOS LOS DATOS QUE POSTERIORMENTE TRANSFORMAREMOS PARA PODER ANALIZARLOS MEJOR</span></span>
<span id="cb27-100"><a href="#cb27-100"></a></span>
<span id="cb27-101"><a href="#cb27-101"></a>intro1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/aaa.csv"</span>) </span>
<span id="cb27-102"><a href="#cb27-102"></a>educacion_gasto_PIB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/Datos_educacion_PST.csv"</span>)</span>
<span id="cb27-103"><a href="#cb27-103"></a>educacion_segmento <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/Datos_educacion_completo.csv"</span>)</span>
<span id="cb27-104"><a href="#cb27-104"></a>gasto_total_educacion_PIB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/gasto_total_y_publico.csv"</span>)</span>
<span id="cb27-105"><a href="#cb27-105"></a>gasto_total_educ <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/gasto_total_y_publico.csv"</span>)</span>
<span id="cb27-106"><a href="#cb27-106"></a>confianza_gobierno <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/gobierno_aprobacion.csv"</span>)</span>
<span id="cb27-107"><a href="#cb27-107"></a>eurostat_p <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/presupuesto.csv"</span>)</span>
<span id="cb27-108"><a href="#cb27-108"></a>pisa_ciencias<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/pisa_ciencias.csv"</span>)</span>
<span id="cb27-109"><a href="#cb27-109"></a>pisa_mates <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/pisa_mates.csv"</span>)</span>
<span id="cb27-110"><a href="#cb27-110"></a>pisa_lectura <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/pisa_lectura.csv"</span>)</span>
<span id="cb27-111"><a href="#cb27-111"></a></span>
<span id="cb27-112"><a href="#cb27-112"></a></span>
<span id="cb27-113"><a href="#cb27-113"></a><span class="co">#AHORA LOS TRANSFORMAMOS </span></span>
<span id="cb27-114"><a href="#cb27-114"></a></span>
<span id="cb27-115"><a href="#cb27-115"></a>df <span class="ot">&lt;-</span> pisa_mates <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>)</span>
<span id="cb27-116"><a href="#cb27-116"></a>df1<span class="ot">&lt;-</span>pisa_ciencias <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>)</span>
<span id="cb27-117"><a href="#cb27-117"></a>df1 <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">ciencia=</span>Value)</span>
<span id="cb27-118"><a href="#cb27-118"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">rename</span> (<span class="at">mates=</span>Value)</span>
<span id="cb27-119"><a href="#cb27-119"></a>pisa_lectura <span class="ot">&lt;-</span> pisa_lectura <span class="sc">%&gt;%</span> <span class="fu">select</span>(LOCATION, SUBJECT,TIME, Value)</span>
<span id="cb27-120"><a href="#cb27-120"></a>pisa_lectura <span class="ot">&lt;-</span> pisa_lectura <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Lectura=</span>Value)</span>
<span id="cb27-121"><a href="#cb27-121"></a>pisa<span class="ot">&lt;-</span> <span class="fu">inner_join</span>(df,df1)</span>
<span id="cb27-122"><a href="#cb27-122"></a>pisa <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(pisa, pisa_lectura)</span>
<span id="cb27-123"><a href="#cb27-123"></a>noborrar<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pisa"</span>)</span>
<span id="cb27-124"><a href="#cb27-124"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()[<span class="sc">!</span><span class="fu">ls</span>()<span class="sc">%in%</span>noborrar])</span>
<span id="cb27-125"><a href="#cb27-125"></a>rio<span class="sc">::</span><span class="fu">export</span>(pisa,<span class="st">"./datos/pisa.xlsx"</span>)</span>
<span id="cb27-126"><a href="#cb27-126"></a></span>
<span id="cb27-127"><a href="#cb27-127"></a>a<span class="ot">&lt;-</span> pisa <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SUBJECT<span class="sc">==</span><span class="st">"TOT"</span>)</span>
<span id="cb27-128"><a href="#cb27-128"></a></span>
<span id="cb27-129"><a href="#cb27-129"></a>b <span class="ot">&lt;-</span> pisa <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SUBJECT<span class="sc">==</span><span class="st">"TOT"</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(LOCATION) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">media_mates=</span> <span class="fu">mean</span>(mates), <span class="at">media_ciencias =</span> <span class="fu">mean</span> (ciencia), <span class="at">media_lectura =</span> <span class="fu">mean</span> (Lectura))</span>
<span id="cb27-130"><a href="#cb27-130"></a>mejores_mates <span class="ot">&lt;-</span> b<span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(media_mates, <span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb27-131"><a href="#cb27-131"></a>mejores_ciencias<span class="ot">&lt;-</span> b <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(media_ciencias, <span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb27-132"><a href="#cb27-132"></a>mejores_lectura <span class="ot">&lt;-</span> b <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(media_lectura, <span class="at">n=</span><span class="dv">5</span>)</span>
<span id="cb27-133"><a href="#cb27-133"></a>VECINOS<span class="ot">&lt;-</span> b <span class="sc">%&gt;%</span> <span class="fu">filter</span>(LOCATION<span class="sc">==</span><span class="st">"ESP"</span> <span class="sc">|</span> LOCATION<span class="sc">==</span><span class="st">"ITA"</span><span class="sc">|</span> LOCATION<span class="sc">==</span><span class="st">"PRT"</span><span class="sc">|</span> LOCATION <span class="sc">==</span><span class="st">"GRC"</span> <span class="sc">|</span> LOCATION <span class="sc">==</span> <span class="st">"FRA"</span>)</span>
<span id="cb27-134"><a href="#cb27-134"></a></span>
<span id="cb27-135"><a href="#cb27-135"></a></span>
<span id="cb27-136"><a href="#cb27-136"></a>datos_gt_movil <span class="ot">&lt;-</span> pisa <span class="sc">%&gt;%</span> <span class="fu">filter</span>(SUBJECT<span class="sc">==</span><span class="st">"TOT"</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(LOCATION<span class="sc">==</span><span class="st">"ESP"</span> <span class="sc">|</span> LOCATION<span class="sc">==</span><span class="st">"ITA"</span><span class="sc">|</span> LOCATION<span class="sc">==</span><span class="st">"PRT"</span><span class="sc">|</span> LOCATION <span class="sc">==</span><span class="st">"GRC"</span> <span class="sc">|</span> LOCATION <span class="sc">==</span> <span class="st">"FRA"</span>)  <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> LOCATION, </span>
<span id="cb27-137"><a href="#cb27-137"></a>                                                                                                                                                                                      <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb27-138"><a href="#cb27-138"></a>                                                                                                                                                                                      <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb27-139"><a href="#cb27-139"></a></span>
<span id="cb27-140"><a href="#cb27-140"></a>datos_gt_movil_long <span class="ot">&lt;-</span> datos_gt_movil <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb27-141"><a href="#cb27-141"></a>                                                              <span class="at">names_to =</span> <span class="st">"pruebas"</span>,</span>
<span id="cb27-142"><a href="#cb27-142"></a>                                                              <span class="at">values_to =</span> <span class="st">"notas"</span> )</span>
<span id="cb27-143"><a href="#cb27-143"></a></span>
<span id="cb27-144"><a href="#cb27-144"></a><span class="co">#GRAFICA</span></span>
<span id="cb27-145"><a href="#cb27-145"></a></span>
<span id="cb27-146"><a href="#cb27-146"></a>w <span class="ot">&lt;-</span> <span class="fu">full_join</span>(VECINOS,mejores_mates)</span>
<span id="cb27-147"><a href="#cb27-147"></a>w <span class="ot">&lt;-</span> <span class="fu">full_join</span>(w,mejores_ciencias)</span>
<span id="cb27-148"><a href="#cb27-148"></a>w <span class="ot">&lt;-</span> <span class="fu">full_join</span>(w, mejores_lectura) </span>
<span id="cb27-149"><a href="#cb27-149"></a></span>
<span id="cb27-150"><a href="#cb27-150"></a><span class="in">```</span></span>
<span id="cb27-151"><a href="#cb27-151"></a></span>
<span id="cb27-152"><a href="#cb27-152"></a>:::</span>
<span id="cb27-153"><a href="#cb27-153"></a></span>
<span id="cb27-154"><a href="#cb27-154"></a><span class="fu"># La educación en el mundo</span></span>
<span id="cb27-155"><a href="#cb27-155"></a></span>
<span id="cb27-156"><a href="#cb27-156"></a>La educación es uno de los principales factores para el desarrollo del capital humano y esto es lo que ha motivado a que sea el gobierno el que controle esta variables. Es por ello que la mayoría de países tienen cierta intervención pública en esta materia.</span>
<span id="cb27-157"><a href="#cb27-157"></a></span>
<span id="cb27-158"><a href="#cb27-158"></a><span class="at">&gt; *"La educación aumenta la productividad y renta individuales. En este sentido y aun más para el caso en que no exista financiación pública de la misma, al incrementarse las rentas futuras, también se incrementan los impuestos que se han de pagar en el futuro al herario público."*    Nicholas Barr</span></span>
<span id="cb27-159"><a href="#cb27-159"></a></span>
<span id="cb27-160"><a href="#cb27-160"></a>La educación es un bien público que no se le niega a nadie en los países desarrollados y es fundamental para el crecimiento de un país como decíamos en la introducción. La mayoría de países fijan la educación obligatoria hasta la adolescencia, alrededor de los 16 años, por lo que normalmente, de media, los niños estan escolarizados alrededor de 10 años, como se puede ver en el siguiente mapa.</span>
<span id="cb27-161"><a href="#cb27-161"></a></span>
<span id="cb27-162"><a href="#cb27-162"></a></span>
<span id="cb27-165"><a href="#cb27-165"></a><span class="in">```{r}</span></span>
<span id="cb27-166"><a href="#cb27-166"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-167"><a href="#cb27-167"></a>intro1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/aaa.csv"</span>) </span>
<span id="cb27-168"><a href="#cb27-168"></a></span>
<span id="cb27-169"><a href="#cb27-169"></a>mapa_intro <span class="ot">&lt;-</span> intro1 <span class="sc">%&gt;%</span></span>
<span id="cb27-170"><a href="#cb27-170"></a>  <span class="fu">select</span>(LOCATION, TIME, Value) <span class="sc">%&gt;%</span></span>
<span id="cb27-171"><a href="#cb27-171"></a>  <span class="fu">filter</span>(TIME <span class="sc">==</span> <span class="st">"2019"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-172"><a href="#cb27-172"></a>  <span class="fu">rename</span>(<span class="at">region =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value)</span>
<span id="cb27-173"><a href="#cb27-173"></a></span>
<span id="cb27-174"><a href="#cb27-174"></a>mapdata <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"world"</span>) </span>
<span id="cb27-175"><a href="#cb27-175"></a></span>
<span id="cb27-176"><a href="#cb27-176"></a>mapdata_2 <span class="ot">&lt;-</span>  mapdata <span class="sc">%&gt;%</span> </span>
<span id="cb27-177"><a href="#cb27-177"></a>  <span class="fu">mutate</span>(<span class="at">Pais =</span> countrycode<span class="sc">::</span><span class="fu">countrycode</span>(<span class="at">sourcevar =</span> region, <span class="at">origin =</span> <span class="st">"country.name"</span>,</span>
<span id="cb27-178"><a href="#cb27-178"></a>                                         <span class="at">destination =</span>  <span class="st">"iso3c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb27-179"><a href="#cb27-179"></a></span>
<span id="cb27-180"><a href="#cb27-180"></a><span class="fu">data</span>(World)</span>
<span id="cb27-181"><a href="#cb27-181"></a>world <span class="ot">&lt;-</span> World ; <span class="fu">rm</span>(World)</span>
<span id="cb27-182"><a href="#cb27-182"></a></span>
<span id="cb27-183"><a href="#cb27-183"></a>world1 <span class="ot">&lt;-</span> world <span class="sc">%&gt;%</span> </span>
<span id="cb27-184"><a href="#cb27-184"></a>  <span class="fu">select</span>(<span class="at">region =</span> iso_a3, geometry) <span class="sc">%&gt;%</span></span>
<span id="cb27-185"><a href="#cb27-185"></a>  <span class="fu">filter</span>(<span class="sc">!</span>region <span class="sc">==</span> <span class="st">"ATA"</span>)</span>
<span id="cb27-186"><a href="#cb27-186"></a></span>
<span id="cb27-187"><a href="#cb27-187"></a>mapa4 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(world1, mapa_intro, <span class="at">by =</span> <span class="st">"region"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb27-188"><a href="#cb27-188"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb27-189"><a href="#cb27-189"></a></span>
<span id="cb27-190"><a href="#cb27-190"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb27-191"><a href="#cb27-191"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> world1) <span class="sc">+</span></span>
<span id="cb27-192"><a href="#cb27-192"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mapa4, <span class="fu">aes</span>(<span class="at">fill =</span> Valor)) <span class="sc">+</span></span>
<span id="cb27-193"><a href="#cb27-193"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-194"><a href="#cb27-194"></a>    <span class="at">title =</span> <span class="st">"Años de educación obligatoria, en 2019"</span>) <span class="sc">+</span> <span class="fu">scale_fill_distiller</span>(<span class="at">name=</span><span class="st">"Años"</span>, <span class="at">palette =</span> <span class="st">"GnBu"</span>) <span class="sc">+</span> <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray94"</span>,</span>
<span id="cb27-195"><a href="#cb27-195"></a>    <span class="at">linetype =</span> <span class="st">"blank"</span>), <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>,</span>
<span id="cb27-196"><a href="#cb27-196"></a>    <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb27-197"><a href="#cb27-197"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb27-198"><a href="#cb27-198"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>,</span>
<span id="cb27-199"><a href="#cb27-199"></a>        <span class="at">family =</span> <span class="st">"serif"</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"cadetblue1"</span>)) <span class="sc">+</span><span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"Datos de la Unesco"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"azure2"</span>))</span>
<span id="cb27-200"><a href="#cb27-200"></a></span>
<span id="cb27-201"><a href="#cb27-201"></a>gg</span>
<span id="cb27-202"><a href="#cb27-202"></a></span>
<span id="cb27-203"><a href="#cb27-203"></a></span>
<span id="cb27-204"><a href="#cb27-204"></a><span class="in">```</span></span>
<span id="cb27-205"><a href="#cb27-205"></a></span>
<span id="cb27-206"><a href="#cb27-206"></a>Por todo eso, uno de los gastos más importantes de un país es el gasto en educación, el cual forma parte del gasto público del gobierno, que se financia con el presupuestos de un país.</span>
<span id="cb27-207"><a href="#cb27-207"></a></span>
<span id="cb27-208"><a href="#cb27-208"></a>En el caso de España, el gasto que se realiza se reparte de esta manera entre los distintos servicios que realiza el estado español.</span>
<span id="cb27-209"><a href="#cb27-209"></a></span>
<span id="cb27-212"><a href="#cb27-212"></a><span class="in">```{r}</span></span>
<span id="cb27-213"><a href="#cb27-213"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-214"><a href="#cb27-214"></a></span>
<span id="cb27-215"><a href="#cb27-215"></a>eurostat_p <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/presupuesto.csv"</span>)</span>
<span id="cb27-216"><a href="#cb27-216"></a></span>
<span id="cb27-217"><a href="#cb27-217"></a>presupuesto <span class="ot">&lt;-</span> eurostat_p <span class="sc">%&gt;%</span></span>
<span id="cb27-218"><a href="#cb27-218"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(LAST.UPDATE, freq, unit, sector, na_item, OBS_FLAG, DATAFLOW)) <span class="sc">%&gt;%</span></span>
<span id="cb27-219"><a href="#cb27-219"></a>  <span class="fu">rename</span>(Año <span class="ot">=</span> TIME_PERIOD, <span class="at">Valor =</span> OBS_VALUE, <span class="at">Partida =</span> cofog99, <span class="at">Pais =</span> geo) <span class="sc">%&gt;%</span></span>
<span id="cb27-220"><a href="#cb27-220"></a>  <span class="fu">filter</span>(Pais <span class="sc">==</span> <span class="st">"ES"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-221"><a href="#cb27-221"></a>  <span class="fu">mutate</span>(<span class="at">Partida_presupuesto =</span> forcats<span class="sc">::</span><span class="fu">fct_recode</span>(Partida,</span>
<span id="cb27-222"><a href="#cb27-222"></a>                                                   <span class="st">"Servicios públicos generales"</span> <span class="ot">=</span> <span class="st">"GF01"</span>,</span>
<span id="cb27-223"><a href="#cb27-223"></a>                                                   <span class="st">"Defensa"</span> <span class="ot">=</span> <span class="st">"GF02"</span>,</span>
<span id="cb27-224"><a href="#cb27-224"></a>                                                   <span class="st">"Orden público y seguridad"</span> <span class="ot">=</span> <span class="st">"GF03"</span>,</span>
<span id="cb27-225"><a href="#cb27-225"></a>                                                   <span class="st">"Asuntos económicos"</span>  <span class="ot">=</span> <span class="st">"GF04"</span>,</span>
<span id="cb27-226"><a href="#cb27-226"></a>                                                   <span class="st">"Protección del medio ambiente"</span> <span class="ot">=</span> <span class="st">"GF05"</span>,</span>
<span id="cb27-227"><a href="#cb27-227"></a>                                                   <span class="st">"Vivienda y servicios comunitarios"</span> <span class="ot">=</span> <span class="st">"GF06"</span>,</span>
<span id="cb27-228"><a href="#cb27-228"></a>                                                   <span class="st">"Salud"</span> <span class="ot">=</span> <span class="st">"GF07"</span>,</span>
<span id="cb27-229"><a href="#cb27-229"></a>                                                   <span class="st">"Ocio y cultura"</span>  <span class="ot">=</span> <span class="st">"GF08"</span>,</span>
<span id="cb27-230"><a href="#cb27-230"></a>                                                   <span class="st">"Educación"</span> <span class="ot">=</span> <span class="st">"GF09"</span>,</span>
<span id="cb27-231"><a href="#cb27-231"></a>                                                   <span class="st">"Protección social"</span>  <span class="ot">=</span> <span class="st">"GF10"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-232"><a href="#cb27-232"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Partida, Pais)) <span class="sc">%&gt;%</span></span>
<span id="cb27-233"><a href="#cb27-233"></a>  <span class="fu">filter</span>(Año <span class="sc">==</span> <span class="st">"2020"</span>)</span>
<span id="cb27-234"><a href="#cb27-234"></a></span>
<span id="cb27-235"><a href="#cb27-235"></a></span>
<span id="cb27-236"><a href="#cb27-236"></a>ii <span class="ot">&lt;-</span> <span class="fu">treemap</span>(presupuesto,</span>
<span id="cb27-237"><a href="#cb27-237"></a>              <span class="at">index=</span><span class="st">"Partida_presupuesto"</span>,</span>
<span id="cb27-238"><a href="#cb27-238"></a>              <span class="at">vSize=</span><span class="st">"Valor"</span>,</span>
<span id="cb27-239"><a href="#cb27-239"></a>              <span class="at">type=</span><span class="st">"index"</span>,</span>
<span id="cb27-240"><a href="#cb27-240"></a>              <span class="at">border.col=</span><span class="fu">c</span>(<span class="st">"grey"</span>), </span>
<span id="cb27-241"><a href="#cb27-241"></a>              <span class="at">palette=</span><span class="st">"Dark2"</span>,</span>
<span id="cb27-242"><a href="#cb27-242"></a>              <span class="at">title=</span><span class="st">"Gasto del gobierno general por función en 2020"</span>,</span>
<span id="cb27-243"><a href="#cb27-243"></a>              <span class="at">fontsize.labels =</span> <span class="dv">8</span>) </span>
<span id="cb27-244"><a href="#cb27-244"></a></span>
<span id="cb27-245"><a href="#cb27-245"></a><span class="in">```</span></span>
<span id="cb27-246"><a href="#cb27-246"></a></span>
<span id="cb27-247"><a href="#cb27-247"></a>Se puede ver que en el 2020, la educación fue el quinto servicio en el que más dinero invirtió el estado español, alrededor del 8,8%, situado por detrás de otros servicios como la protección social, la sanidad, los servicios públicos generales y los asuntos económicos. </span>
<span id="cb27-248"><a href="#cb27-248"></a></span>
<span id="cb27-249"><a href="#cb27-249"></a>Cabe resaltar también que no es tan importante cuánto dinero va destinado a un lugar, como puede ser sanidad, educación o defensa, si ese gasto no se usa correctamente o directamente no acaba en el sitio que le corresponde, lo que puede hacer que la gente pierda la confianza en el gobierno.</span>
<span id="cb27-250"><a href="#cb27-250"></a></span>
<span id="cb27-251"><a href="#cb27-251"></a>En este mapa, vamos a observar cuál es el grado de confianza que tienen los ciudadanos en relación al gasto que realiza su gobierno con el dinero público.</span>
<span id="cb27-252"><a href="#cb27-252"></a></span>
<span id="cb27-253"><a href="#cb27-253"></a></span>
<span id="cb27-256"><a href="#cb27-256"></a><span class="in">```{r}</span></span>
<span id="cb27-257"><a href="#cb27-257"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-258"><a href="#cb27-258"></a></span>
<span id="cb27-259"><a href="#cb27-259"></a>confianza_gobierno <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/gobierno_aprobacion.csv"</span>)</span>
<span id="cb27-260"><a href="#cb27-260"></a></span>
<span id="cb27-261"><a href="#cb27-261"></a>educ_6 <span class="ot">&lt;-</span> confianza_gobierno <span class="sc">%&gt;%</span></span>
<span id="cb27-262"><a href="#cb27-262"></a>  <span class="fu">rename</span>(<span class="at">region =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value) <span class="sc">%&gt;%</span></span>
<span id="cb27-263"><a href="#cb27-263"></a>  <span class="fu">select</span>(region, Año, Valor)</span>
<span id="cb27-264"><a href="#cb27-264"></a></span>
<span id="cb27-265"><a href="#cb27-265"></a>mapdata <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"world"</span>) </span>
<span id="cb27-266"><a href="#cb27-266"></a></span>
<span id="cb27-267"><a href="#cb27-267"></a>mapdata_2 <span class="ot">&lt;-</span>  mapdata <span class="sc">%&gt;%</span> </span>
<span id="cb27-268"><a href="#cb27-268"></a>  <span class="fu">mutate</span>(<span class="at">Pais =</span> countrycode<span class="sc">::</span><span class="fu">countrycode</span>(<span class="at">sourcevar =</span> region, <span class="at">origin =</span> <span class="st">"country.name"</span>,</span>
<span id="cb27-269"><a href="#cb27-269"></a>                                         <span class="at">destination =</span>  <span class="st">"iso3c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb27-270"><a href="#cb27-270"></a></span>
<span id="cb27-271"><a href="#cb27-271"></a><span class="fu">data</span>(World)</span>
<span id="cb27-272"><a href="#cb27-272"></a>world <span class="ot">&lt;-</span> World ; <span class="fu">rm</span>(World)</span>
<span id="cb27-273"><a href="#cb27-273"></a></span>
<span id="cb27-274"><a href="#cb27-274"></a>world1 <span class="ot">&lt;-</span> world <span class="sc">%&gt;%</span> </span>
<span id="cb27-275"><a href="#cb27-275"></a>  <span class="fu">select</span>(<span class="at">region =</span> iso_a3, geometry) <span class="sc">%&gt;%</span></span>
<span id="cb27-276"><a href="#cb27-276"></a>  <span class="fu">filter</span>(<span class="sc">!</span>region <span class="sc">==</span> <span class="st">"ATA"</span>)</span>
<span id="cb27-277"><a href="#cb27-277"></a></span>
<span id="cb27-278"><a href="#cb27-278"></a>mapa4 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(world1, educ_6, <span class="at">by =</span> <span class="st">"region"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb27-279"><a href="#cb27-279"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb27-280"><a href="#cb27-280"></a></span>
<span id="cb27-281"><a href="#cb27-281"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb27-282"><a href="#cb27-282"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> world1) <span class="sc">+</span></span>
<span id="cb27-283"><a href="#cb27-283"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> mapa4, <span class="fu">aes</span>(<span class="at">fill =</span> Valor)) <span class="sc">+</span></span>
<span id="cb27-284"><a href="#cb27-284"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-285"><a href="#cb27-285"></a>    <span class="at">title =</span> <span class="st">"Año: {current_frame}"</span>) <span class="sc">+</span> <span class="fu">scale_fill_distiller</span>(<span class="at">name=</span><span class="st">"Confianza"</span>, <span class="at">palette =</span> <span class="st">"YlGn"</span>, <span class="at">trans =</span> <span class="st">"reverse"</span>) <span class="sc">+</span> <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb27-286"><a href="#cb27-286"></a>  <span class="fu">transition_manual</span>(Año) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"blank"</span>),</span>
<span id="cb27-287"><a href="#cb27-287"></a>                                 <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb27-288"><a href="#cb27-288"></a>                                 <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb27-289"><a href="#cb27-289"></a>                                                             <span class="at">family =</span> <span class="st">"mono"</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lightcyan"</span>),<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>,</span>
<span id="cb27-290"><a href="#cb27-290"></a>                                                                                                                                                                                                <span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb27-291"><a href="#cb27-291"></a>                                                                                                                                                                      <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Año {current_frame}"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>,</span>
<span id="cb27-292"><a href="#cb27-292"></a>    <span class="at">colour =</span> <span class="st">"gray32"</span>, <span class="at">hjust =</span> <span class="fl">0.05</span>))</span>
<span id="cb27-293"><a href="#cb27-293"></a></span>
<span id="cb27-294"><a href="#cb27-294"></a><span class="fu">animate</span>(gg, <span class="at">width =</span> <span class="dv">500</span>, <span class="at">height =</span> <span class="dv">500</span>)</span>
<span id="cb27-295"><a href="#cb27-295"></a></span>
<span id="cb27-296"><a href="#cb27-296"></a><span class="in">```</span></span>
<span id="cb27-297"><a href="#cb27-297"></a></span>
<span id="cb27-298"><a href="#cb27-298"></a>Como se puede observar, la mayoría de países no tienen la confianza de sus ciudadanos en cuanto al uso que hacen del dinero público, sobre todo en la época en la que se agravó la crisis del 2008, durante los años 2010-2014, debido principalmente a las altas tasas de paro que había en la mayoría de países y las medidas poco efectivas que tomaban.</span>
<span id="cb27-299"><a href="#cb27-299"></a></span>
<span id="cb27-300"><a href="#cb27-300"></a>Se puede observar también que en España la confianza fue cayendo paulatinamente hasta el 2018, que es más o menos cuando España empezó a recuperarse de los efectos de la crisis.</span>
<span id="cb27-301"><a href="#cb27-301"></a></span>
<span id="cb27-302"><a href="#cb27-302"></a>Para acabar con este apartado, vamos a aclarar unos aspectos del trabajo.</span>
<span id="cb27-303"><a href="#cb27-303"></a></span>
<span id="cb27-304"><a href="#cb27-304"></a><span class="ss">- </span>Solo se va a tener en cuenta unas pocas variables que conforman el gasto en educación, ya que hay alrededor de 15 partidas pero solo se comentarán el gasto en las distintas etapas educativas: *educación infantil, educación primaria y secundaria y educación terciaria.*</span>
<span id="cb27-305"><a href="#cb27-305"></a></span>
<span id="cb27-306"><a href="#cb27-306"></a><span class="ss">- </span>Se va a analizar el gasto en **educación pública** no el gasto realizado en educación privada.</span>
<span id="cb27-307"><a href="#cb27-307"></a></span>
<span id="cb27-308"><a href="#cb27-308"></a></span>
<span id="cb27-309"><a href="#cb27-309"></a><span class="fu"># Contexto español</span></span>
<span id="cb27-310"><a href="#cb27-310"></a></span>
<span id="cb27-311"><a href="#cb27-311"></a>Centrándonos en España, el gasto que se realiza en educación tiene dos problemas, no es suficiente y aparte es poco eficiente, en comparación con otros países de la Unión Europea y del G7.</span>
<span id="cb27-312"><a href="#cb27-312"></a></span>
<span id="cb27-313"><a href="#cb27-313"></a>Las consecuencias de la insuficiencia y poca efectividad del gasto se puede observar en las altas tasas de desempleo de población cualificada y no cualificada, la poca población con estudios terciarios o en los resultados obtenidos en las pruebas PISA.</span>
<span id="cb27-314"><a href="#cb27-314"></a></span>
<span id="cb27-315"><a href="#cb27-315"></a></span>
<span id="cb27-316"><a href="#cb27-316"></a>::: columns</span>
<span id="cb27-317"><a href="#cb27-317"></a>::: {.column width="32%"}</span>
<span id="cb27-318"><a href="#cb27-318"></a></span>
<span id="cb27-319"><a href="#cb27-319"></a><span class="in">```{r, echo = FALSE, out.width = "60%"}</span></span>
<span id="cb27-320"><a href="#cb27-320"></a>tweetrmd<span class="sc">::</span><span class="fu">tweet_embed</span>(<span class="st">"https://twitter.com/eleconomistaes/status/1059866846478897152"</span>, <span class="at">theme =</span> <span class="st">"light"</span>, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">dnt =</span> <span class="cn">TRUE</span>, <span class="at">maxwidth =</span> <span class="dv">400</span>)</span>
<span id="cb27-321"><a href="#cb27-321"></a><span class="in">```</span></span>
<span id="cb27-322"><a href="#cb27-322"></a>:::</span>
<span id="cb27-323"><a href="#cb27-323"></a></span>
<span id="cb27-324"><a href="#cb27-324"></a>::: {.column width="1%"}</span>
<span id="cb27-325"><a href="#cb27-325"></a><span class="co">&lt;!-- an empty Div (with a white space) haciendo de separador --&gt;</span></span>
<span id="cb27-326"><a href="#cb27-326"></a>:::</span>
<span id="cb27-327"><a href="#cb27-327"></a></span>
<span id="cb27-328"><a href="#cb27-328"></a>::: {.column width="32%"}</span>
<span id="cb27-329"><a href="#cb27-329"></a></span>
<span id="cb27-330"><a href="#cb27-330"></a><span class="in">```{r, echo = FALSE, out.width = "60%"}</span></span>
<span id="cb27-331"><a href="#cb27-331"></a>tweetrmd<span class="sc">::</span><span class="fu">tweet_embed</span>(<span class="st">"https://twitter.com/janogarcia_/status/1355274347510960129?lang=es"</span>, <span class="at">theme =</span> <span class="st">"light"</span>, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">dnt =</span> <span class="cn">TRUE</span>, <span class="at">maxwidth =</span> <span class="dv">400</span>)</span>
<span id="cb27-332"><a href="#cb27-332"></a><span class="in">```</span></span>
<span id="cb27-333"><a href="#cb27-333"></a>:::</span>
<span id="cb27-334"><a href="#cb27-334"></a></span>
<span id="cb27-335"><a href="#cb27-335"></a>::: {.column width="1%"}</span>
<span id="cb27-336"><a href="#cb27-336"></a><span class="co">&lt;!-- an empty Div (with a white space) haciendo de separador --&gt;</span></span>
<span id="cb27-337"><a href="#cb27-337"></a>:::</span>
<span id="cb27-338"><a href="#cb27-338"></a></span>
<span id="cb27-339"><a href="#cb27-339"></a>::: {.column width="32%"}</span>
<span id="cb27-340"><a href="#cb27-340"></a></span>
<span id="cb27-341"><a href="#cb27-341"></a><span class="in">```{r, echo = FALSE, out.width = "60%"}</span></span>
<span id="cb27-342"><a href="#cb27-342"></a>tweetrmd<span class="sc">::</span><span class="fu">tweet_embed</span>(<span class="st">"https://twitter.com/TrabajarEuropa/status/1140295846703042560"</span>, <span class="at">theme =</span> <span class="st">"light"</span>, <span class="at">align =</span> <span class="st">"center"</span>, <span class="at">dnt =</span> <span class="cn">TRUE</span>, <span class="at">maxwidth =</span> <span class="dv">400</span>)</span>
<span id="cb27-343"><a href="#cb27-343"></a><span class="in">```</span></span>
<span id="cb27-344"><a href="#cb27-344"></a>:::</span>
<span id="cb27-345"><a href="#cb27-345"></a>:::</span>
<span id="cb27-346"><a href="#cb27-346"></a></span>
<span id="cb27-347"><a href="#cb27-347"></a></span>
<span id="cb27-348"><a href="#cb27-348"></a></span>
<span id="cb27-349"><a href="#cb27-349"></a>Mediante este gráfico, podemos ver cómo ha ido evolucionando el gasto que se hace en educación en función del PIB.</span>
<span id="cb27-350"><a href="#cb27-350"></a></span>
<span id="cb27-353"><a href="#cb27-353"></a><span class="in">```{r}</span></span>
<span id="cb27-354"><a href="#cb27-354"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-355"><a href="#cb27-355"></a></span>
<span id="cb27-356"><a href="#cb27-356"></a>educacion_gasto_PIB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/Datos_educacion_PST.csv"</span>)</span>
<span id="cb27-357"><a href="#cb27-357"></a></span>
<span id="cb27-358"><a href="#cb27-358"></a>educ_1 <span class="ot">&lt;-</span> educacion_gasto_PIB <span class="sc">%&gt;%</span>  <span class="fu">rename</span>(<span class="at">Pais =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value, <span class="at">Educacion =</span> SUBJECT) <span class="sc">%&gt;%</span></span>
<span id="cb27-359"><a href="#cb27-359"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(FREQUENCY, Flag.Codes, INDICATOR, MEASURE)) <span class="sc">%&gt;%</span></span>
<span id="cb27-360"><a href="#cb27-360"></a>  <span class="fu">filter</span>(Año <span class="sc">&gt;=</span> <span class="dv">2008</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-361"><a href="#cb27-361"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-362"><a href="#cb27-362"></a>  <span class="fu">filter</span>(Pais <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GBR"</span>,<span class="st">"CAN"</span>,<span class="st">"JPN"</span>,<span class="st">"ESP"</span>,<span class="st">"USA"</span>,<span class="st">"ITA"</span>,<span class="st">"DEU"</span>,<span class="st">"FRA"</span>,<span class="st">"PRT"</span>,<span class="st">"GRC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-363"><a href="#cb27-363"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Educacion, <span class="at">values_from =</span> Valor) <span class="sc">%&gt;%</span></span>
<span id="cb27-364"><a href="#cb27-364"></a>  <span class="fu">mutate</span>(<span class="at">Gasto_total =</span> TRY <span class="sc">+</span> PRY_NTRY) <span class="sc">%&gt;%</span></span>
<span id="cb27-365"><a href="#cb27-365"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-366"><a href="#cb27-366"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(TRY, PRY_NTRY)) <span class="sc">%&gt;%</span></span>
<span id="cb27-367"><a href="#cb27-367"></a>  <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> Pais, </span>
<span id="cb27-368"><a href="#cb27-368"></a>                            <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb27-369"><a href="#cb27-369"></a>                            <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb27-370"><a href="#cb27-370"></a></span>
<span id="cb27-371"><a href="#cb27-371"></a>aa <span class="ot">&lt;-</span> educ_1 <span class="sc">%&gt;%</span></span>
<span id="cb27-372"><a href="#cb27-372"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> Año, <span class="at">y=</span> Gasto_total)) <span class="sc">+</span> </span>
<span id="cb27-373"><a href="#cb27-373"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Evolución % gasto en educación/PIB"</span>,</span>
<span id="cb27-374"><a href="#cb27-374"></a>       <span class="at">x =</span> <span class="st">"Año"</span>,</span>
<span id="cb27-375"><a href="#cb27-375"></a>       <span class="at">y =</span> <span class="st">"% Gasto/PIB"</span>,</span>
<span id="cb27-376"><a href="#cb27-376"></a>       <span class="at">color =</span> <span class="st">"Países"</span>) <span class="sc">+</span> <span class="fu">geom_flag</span>(<span class="fu">aes</span>(<span class="at">image =</span> iso2)) <span class="sc">+</span></span>
<span id="cb27-377"><a href="#cb27-377"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span> Pais), <span class="at">size=</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb27-378"><a href="#cb27-378"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span> <span class="fu">c</span>(<span class="st">"coral1"</span>, <span class="st">"tan4"</span>, <span class="st">"yellow"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"green3"</span>, <span class="st">"darkmagenta"</span>,<span class="st">"green4"</span>,<span class="st">"cyan1"</span>)) <span class="sc">+</span></span>
<span id="cb27-379"><a href="#cb27-379"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>,</span>
<span id="cb27-380"><a href="#cb27-380"></a>                                  <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb27-381"><a href="#cb27-381"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb27-382"><a href="#cb27-382"></a>                                    <span class="at">vjust =</span> <span class="dv">0</span>),</span>
<span id="cb27-383"><a href="#cb27-383"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb27-384"><a href="#cb27-384"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb27-385"><a href="#cb27-385"></a>  <span class="fu">transition_reveal</span>(Año) <span class="sc">+</span> </span>
<span id="cb27-386"><a href="#cb27-386"></a>  <span class="fu">view_follow</span>() <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray87"</span>,</span>
<span id="cb27-387"><a href="#cb27-387"></a>                                                                     <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"aliceblue"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"blank"</span>),</span>
<span id="cb27-388"><a href="#cb27-388"></a>                                                                                                                                                        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>,</span>
<span id="cb27-389"><a href="#cb27-389"></a>                                                                                                                                                                                 <span class="at">size =</span> <span class="dv">9</span>, <span class="at">colour =</span> <span class="st">"gray17"</span>))</span>
<span id="cb27-390"><a href="#cb27-390"></a></span>
<span id="cb27-391"><a href="#cb27-391"></a><span class="fu">animate</span>(aa, <span class="at">width =</span> <span class="dv">500</span>, <span class="at">height =</span> <span class="dv">500</span>)</span>
<span id="cb27-392"><a href="#cb27-392"></a></span>
<span id="cb27-393"><a href="#cb27-393"></a><span class="in">```</span></span>
<span id="cb27-394"><a href="#cb27-394"></a></span>
<span id="cb27-395"><a href="#cb27-395"></a>Vemos que España sigue la misma tendencia y ronda el 4,5% gasto/PIB e incluso está por encima de países como Italia, Alemania o Japón, sin embargo, después las tasas de desempleo, formación y notas en las pruebas PISA son superiores a los de España.</span>
<span id="cb27-396"><a href="#cb27-396"></a></span>
<span id="cb27-397"><a href="#cb27-397"></a>Incluso Portugal está por encima en algunos periodos de Francia y España, pero al igual que España, ese gasto luego no tiene los resultados adecuados.</span>
<span id="cb27-398"><a href="#cb27-398"></a></span>
<span id="cb27-399"><a href="#cb27-399"></a>Desde un contexto europeo, también se puede comprobar que España está atrás en cuanto a inversión en educación se refiere respecto a los países europeos.</span>
<span id="cb27-400"><a href="#cb27-400"></a></span>
<span id="cb27-401"><a href="#cb27-401"></a></span>
<span id="cb27-404"><a href="#cb27-404"></a><span class="in">```{r}</span></span>
<span id="cb27-405"><a href="#cb27-405"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-406"><a href="#cb27-406"></a></span>
<span id="cb27-407"><a href="#cb27-407"></a>gasto_total_educ <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/gasto_total_y_publico.csv"</span>)</span>
<span id="cb27-408"><a href="#cb27-408"></a></span>
<span id="cb27-409"><a href="#cb27-409"></a>educ_4 <span class="ot">&lt;-</span> gasto_total_educ <span class="sc">%&gt;%</span></span>
<span id="cb27-410"><a href="#cb27-410"></a>  <span class="fu">rename</span>(<span class="at">Pais =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value) <span class="sc">%&gt;%</span></span>
<span id="cb27-411"><a href="#cb27-411"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(INDICATOR, MEASURE, FREQUENCY, Flag.Codes)) <span class="sc">%&gt;%</span></span>
<span id="cb27-412"><a href="#cb27-412"></a>  <span class="fu">filter</span>(SUBJECT <span class="sc">==</span> <span class="st">"EDU"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-413"><a href="#cb27-413"></a>  <span class="fu">filter</span>(Año <span class="sc">&gt;=</span> <span class="st">"1995"</span>, Año <span class="sc">&lt;</span> <span class="st">"2021"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-414"><a href="#cb27-414"></a>  <span class="fu">select</span>(<span class="sc">-</span>SUBJECT) <span class="sc">%&gt;%</span></span>
<span id="cb27-415"><a href="#cb27-415"></a>  <span class="fu">rename</span>(<span class="st">"region"</span> <span class="ot">=</span> Pais)</span>
<span id="cb27-416"><a href="#cb27-416"></a></span>
<span id="cb27-417"><a href="#cb27-417"></a></span>
<span id="cb27-418"><a href="#cb27-418"></a>world_map <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="dv">50</span>, <span class="at">returnclass =</span> <span class="st">'sf'</span>)</span>
<span id="cb27-419"><a href="#cb27-419"></a></span>
<span id="cb27-420"><a href="#cb27-420"></a>paises_europeos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Austria"</span>,<span class="st">"Belgium"</span>,<span class="st">"Bulgaria"</span>,<span class="st">"Croatia"</span>,<span class="st">"Cyprus"</span>,</span>
<span id="cb27-421"><a href="#cb27-421"></a>                     <span class="st">"Czech Rep."</span>,<span class="st">"Denmark"</span>,<span class="st">"Estonia"</span>,<span class="st">"Finland"</span>,<span class="st">"France"</span>,</span>
<span id="cb27-422"><a href="#cb27-422"></a>                     <span class="st">"Germany"</span>,<span class="st">"Greece"</span>,<span class="st">"Hungary"</span>,<span class="st">"Ireland"</span>,<span class="st">"Italy"</span>,<span class="st">"Latvia"</span>,</span>
<span id="cb27-423"><a href="#cb27-423"></a>                     <span class="st">"Lithuania"</span>,<span class="st">"Luxembourg"</span>,<span class="st">"Malta"</span>,<span class="st">"Netherlands"</span>,<span class="st">"Poland"</span>,</span>
<span id="cb27-424"><a href="#cb27-424"></a>                     <span class="st">"Portugal"</span>,<span class="st">"Romania"</span>,<span class="st">"Slovakia"</span>,<span class="st">"Slovenia"</span>,<span class="st">"Spain"</span>,</span>
<span id="cb27-425"><a href="#cb27-425"></a>                     <span class="st">"Sweden"</span>,<span class="st">"United Kingdom"</span>,<span class="st">"Switzerland"</span>,<span class="st">"Serbia"</span>,<span class="st">"Norway"</span>)</span>
<span id="cb27-426"><a href="#cb27-426"></a></span>
<span id="cb27-427"><a href="#cb27-427"></a>mapa_europa <span class="ot">&lt;-</span> world_map <span class="sc">%&gt;%</span> </span>
<span id="cb27-428"><a href="#cb27-428"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> paises_europeos) <span class="sc">%&gt;%</span></span>
<span id="cb27-429"><a href="#cb27-429"></a>  <span class="fu">select</span>(<span class="fu">c</span>(name, iso_a3))</span>
<span id="cb27-430"><a href="#cb27-430"></a></span>
<span id="cb27-431"><a href="#cb27-431"></a>bbox_europe <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(<span class="fu">c</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">ymin =</span> <span class="dv">20</span>, <span class="at">xmax =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">80</span>), <span class="at">crs =</span> <span class="fu">st_crs</span>(mapa_europa))</span>
<span id="cb27-432"><a href="#cb27-432"></a>european_union_map_cropped <span class="ot">&lt;-</span> <span class="fu">st_crop</span>(mapa_europa, bbox_europe)</span>
<span id="cb27-433"><a href="#cb27-433"></a></span>
<span id="cb27-434"><a href="#cb27-434"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">country =</span> paises_europeos,</span>
<span id="cb27-435"><a href="#cb27-435"></a>             <span class="at">some_value =</span> <span class="fu">runif</span>(<span class="fu">length</span>(paises_europeos)))</span>
<span id="cb27-436"><a href="#cb27-436"></a></span>
<span id="cb27-437"><a href="#cb27-437"></a></span>
<span id="cb27-438"><a href="#cb27-438"></a>map <span class="ot">&lt;-</span> european_union_map_cropped <span class="sc">%&gt;%</span> </span>
<span id="cb27-439"><a href="#cb27-439"></a>  <span class="fu">inner_join</span>(educ_4, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"iso_a3"</span> <span class="ot">=</span> <span class="st">"region"</span>))</span>
<span id="cb27-440"><a href="#cb27-440"></a></span>
<span id="cb27-441"><a href="#cb27-441"></a>dd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> map) <span class="sc">+</span></span>
<span id="cb27-442"><a href="#cb27-442"></a>  <span class="fu">geom_sf</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> Valor)) <span class="sc">+</span></span>
<span id="cb27-443"><a href="#cb27-443"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">name=</span><span class="st">"%PIB"</span>, <span class="at">palette =</span> <span class="st">"YlOrRd"</span>, <span class="at">trans =</span> <span class="st">"reverse"</span>) <span class="sc">+</span></span>
<span id="cb27-444"><a href="#cb27-444"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb27-445"><a href="#cb27-445"></a>       <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb27-446"><a href="#cb27-446"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">"plot"</span>) <span class="sc">+</span> <span class="fu">transition_manual</span>(Año) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb27-447"><a href="#cb27-447"></a>    <span class="at">title =</span> <span class="st">"Año: {current_frame}"</span>,</span>
<span id="cb27-448"><a href="#cb27-448"></a>    <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb27-449"><a href="#cb27-449"></a>  <span class="fu">transition_manual</span>(Año) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"blank"</span>),</span>
<span id="cb27-450"><a href="#cb27-450"></a>                                 <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb27-451"><a href="#cb27-451"></a>                                 <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb27-452"><a href="#cb27-452"></a>                                                             <span class="at">family =</span> <span class="st">"mono"</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"aliceblue"</span>),<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"linen"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>, <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>)  </span>
<span id="cb27-453"><a href="#cb27-453"></a></span>
<span id="cb27-454"><a href="#cb27-454"></a><span class="fu">animate</span>(dd, <span class="at">width =</span> <span class="dv">500</span>, <span class="at">height =</span> <span class="dv">500</span>)</span>
<span id="cb27-455"><a href="#cb27-455"></a></span>
<span id="cb27-456"><a href="#cb27-456"></a></span>
<span id="cb27-457"><a href="#cb27-457"></a><span class="in">```</span></span>
<span id="cb27-458"><a href="#cb27-458"></a></span>
<span id="cb27-459"><a href="#cb27-459"></a>Aquí también se puede ver con más detalle la evolución que ha habido del gasto en educación sobre el PIB comparado con el gasto en educación sobre el gasto público.</span>
<span id="cb27-460"><a href="#cb27-460"></a></span>
<span id="cb27-461"><a href="#cb27-461"></a></span>
<span id="cb27-464"><a href="#cb27-464"></a><span class="in">```{r}</span></span>
<span id="cb27-465"><a href="#cb27-465"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-466"><a href="#cb27-466"></a></span>
<span id="cb27-467"><a href="#cb27-467"></a>gasto_total_educacion_PIB <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/gasto_total_y_publico.csv"</span>)</span>
<span id="cb27-468"><a href="#cb27-468"></a></span>
<span id="cb27-469"><a href="#cb27-469"></a>educ_3 <span class="ot">&lt;-</span> gasto_total_educacion_PIB <span class="sc">%&gt;%</span></span>
<span id="cb27-470"><a href="#cb27-470"></a>  <span class="fu">rename</span>(<span class="at">Pais =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value, <span class="at">Educacion =</span> SUBJECT) <span class="sc">%&gt;%</span></span>
<span id="cb27-471"><a href="#cb27-471"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(INDICATOR, MEASURE, FREQUENCY, Flag.Codes)) <span class="sc">%&gt;%</span></span>
<span id="cb27-472"><a href="#cb27-472"></a>  <span class="fu">filter</span>(Pais <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GBR"</span>,<span class="st">"CAN"</span>,<span class="st">"JPN"</span>,<span class="st">"ESP"</span>,<span class="st">"USA"</span>,<span class="st">"ITA"</span>,<span class="st">"DEU"</span>,<span class="st">"FRA"</span>,<span class="st">"PRT"</span>,<span class="st">"GRC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-473"><a href="#cb27-473"></a>  <span class="fu">filter</span>(Año <span class="sc">&gt;=</span> <span class="st">"1995"</span>, Año <span class="sc">&lt;</span> <span class="st">"2021"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-474"><a href="#cb27-474"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Educacion, <span class="at">values_from =</span> Valor) <span class="sc">%&gt;%</span></span>
<span id="cb27-475"><a href="#cb27-475"></a>  <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> Pais, </span>
<span id="cb27-476"><a href="#cb27-476"></a>                            <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb27-477"><a href="#cb27-477"></a>                            <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-478"><a href="#cb27-478"></a>  <span class="fu">mutate</span>(<span class="at">Prop_gasto_educ =</span> ((EDU <span class="sc">*</span> <span class="dv">100</span>)<span class="sc">/</span>TOT)) <span class="co">#Se refiere al % del gasto publico que se usa en educacion</span></span>
<span id="cb27-479"><a href="#cb27-479"></a></span>
<span id="cb27-480"><a href="#cb27-480"></a></span>
<span id="cb27-481"><a href="#cb27-481"></a>cc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(educ_3, </span>
<span id="cb27-482"><a href="#cb27-482"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Prop_gasto_educ , <span class="at">y=</span> EDU)) <span class="sc">+</span></span>
<span id="cb27-483"><a href="#cb27-483"></a>  <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"% Gasto educación/Gasto público"</span>, <span class="at">y =</span> <span class="st">"% Gasto educación/PIB"</span>) <span class="sc">+</span> </span>
<span id="cb27-484"><a href="#cb27-484"></a>  <span class="fu">theme_solarized</span>() <span class="sc">+</span> </span>
<span id="cb27-485"><a href="#cb27-485"></a>  <span class="fu">transition_time</span>(Año) <span class="sc">+</span></span>
<span id="cb27-486"><a href="#cb27-486"></a>  <span class="fu">labs</span>( </span>
<span id="cb27-487"><a href="#cb27-487"></a>       <span class="at">subtitle =</span> <span class="st">"Año: {frame_time}"</span>) <span class="sc">+</span></span>
<span id="cb27-488"><a href="#cb27-488"></a>  <span class="fu">geom_flag</span>(<span class="fu">aes</span>(<span class="at">image =</span> iso2)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray59"</span>,</span>
<span id="cb27-489"><a href="#cb27-489"></a>                                                                       <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray59"</span>,</span>
<span id="cb27-490"><a href="#cb27-490"></a>                                                                                                                             <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"mono"</span>,</span>
<span id="cb27-491"><a href="#cb27-491"></a>                                                                                                                                                                             <span class="at">size =</span> <span class="dv">14</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"aliceblue"</span>),</span>
<span id="cb27-492"><a href="#cb27-492"></a>                                       <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>,</span>
<span id="cb27-493"><a href="#cb27-493"></a>                                                                                                                       <span class="at">size =</span> <span class="dv">15</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"mono"</span>))</span>
<span id="cb27-494"><a href="#cb27-494"></a></span>
<span id="cb27-495"><a href="#cb27-495"></a></span>
<span id="cb27-496"><a href="#cb27-496"></a><span class="fu">animate</span>(cc, <span class="at">width =</span> <span class="dv">600</span>, <span class="at">height =</span> <span class="dv">500</span>, <span class="at">fps =</span> <span class="dv">2</span>, </span>
<span id="cb27-497"><a href="#cb27-497"></a>        <span class="at">duration =</span> <span class="dv">15</span>, <span class="at">rewind =</span> <span class="cn">FALSE</span>) </span>
<span id="cb27-498"><a href="#cb27-498"></a></span>
<span id="cb27-499"><a href="#cb27-499"></a><span class="in">```</span></span>
<span id="cb27-500"><a href="#cb27-500"></a></span>
<span id="cb27-501"><a href="#cb27-501"></a>Se puede ver que el peso que tiene la educación en el presupuesto español no ha variado mucho y se ha mantenido constante en el tiempo</span>
<span id="cb27-502"><a href="#cb27-502"></a></span>
<span id="cb27-503"><a href="#cb27-503"></a>Entonces, si aunque invirtamos más no significa obtener mejores resultados, que hay que hacer para poder lograrlos?</span>
<span id="cb27-504"><a href="#cb27-504"></a></span>
<span id="cb27-505"><a href="#cb27-505"></a></span>
<span id="cb27-506"><a href="#cb27-506"></a><span class="fu">## División del gasto en educación </span></span>
<span id="cb27-507"><a href="#cb27-507"></a></span>
<span id="cb27-508"><a href="#cb27-508"></a>Un motivo que podría explicar los malos resultados que obtiene España podría ser que el gasto en educación no esta bien repartido entre las distintas etapas educativas o incluso se aplique un sistema educativo obsoleto y poco eficaz.</span>
<span id="cb27-509"><a href="#cb27-509"></a></span>
<span id="cb27-510"><a href="#cb27-510"></a></span>
<span id="cb27-511"><a href="#cb27-511"></a><span class="in">```{r, echo = FALSE, out.width = "60%"}</span></span>
<span id="cb27-512"><a href="#cb27-512"></a><span class="fu">embed_url</span>(<span class="st">"https://www.youtube.com/watch?v=zoQN6ncR4Uo"</span>)</span>
<span id="cb27-513"><a href="#cb27-513"></a><span class="in">```</span></span>
<span id="cb27-514"><a href="#cb27-514"></a></span>
<span id="cb27-515"><a href="#cb27-515"></a>Por eso vamos a desglosar el gasto en educación en tres ramas: educación infantil, educación primaria y secundaria y educación terciaria y ponerlas en una gráfica.</span>
<span id="cb27-516"><a href="#cb27-516"></a></span>
<span id="cb27-519"><a href="#cb27-519"></a><span class="in">```{r}</span></span>
<span id="cb27-520"><a href="#cb27-520"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-521"><a href="#cb27-521"></a></span>
<span id="cb27-522"><a href="#cb27-522"></a>educacion_segmento <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"datos/Datos_educacion_completo.csv"</span>)</span>
<span id="cb27-523"><a href="#cb27-523"></a></span>
<span id="cb27-524"><a href="#cb27-524"></a>educ_2 <span class="ot">&lt;-</span> educacion_segmento <span class="sc">%&gt;%</span> </span>
<span id="cb27-525"><a href="#cb27-525"></a>  <span class="fu">rename</span>(<span class="at">Pais =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value, <span class="at">Etapa_educativa =</span> SUBJECT) <span class="sc">%&gt;%</span> </span>
<span id="cb27-526"><a href="#cb27-526"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(FREQUENCY, Flag.Codes, INDICATOR, MEASURE)) <span class="sc">%&gt;%</span></span>
<span id="cb27-527"><a href="#cb27-527"></a>  <span class="fu">filter</span>(Año <span class="sc">&gt;=</span> <span class="dv">2008</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-528"><a href="#cb27-528"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-529"><a href="#cb27-529"></a>  <span class="fu">filter</span>(Pais <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"GBR"</span>,<span class="st">"CAN"</span>,<span class="st">"JPN"</span>,<span class="st">"ESP"</span>,<span class="st">"USA"</span>,<span class="st">"ITA"</span>,<span class="st">"DEU"</span>,<span class="st">"FRA"</span>,<span class="st">"PRT"</span>,<span class="st">"GRC"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-530"><a href="#cb27-530"></a>  <span class="fu">mutate</span>(<span class="at">Educacion =</span> forcats<span class="sc">::</span><span class="fu">fct_recode</span>(Etapa_educativa,</span>
<span id="cb27-531"><a href="#cb27-531"></a>                                         <span class="st">"Educación infantil"</span> <span class="ot">=</span> <span class="st">"EARLYCHILDEDU"</span>,</span>
<span id="cb27-532"><a href="#cb27-532"></a>                                         <span class="st">"Primaria y Secundaria"</span> <span class="ot">=</span> <span class="st">"PRY_NTRY"</span>, </span>
<span id="cb27-533"><a href="#cb27-533"></a>                                         <span class="st">"Educación Terciaria"</span>  <span class="ot">=</span> <span class="st">"TRY"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-534"><a href="#cb27-534"></a>  <span class="fu">select</span>(<span class="sc">-</span>Etapa_educativa)</span>
<span id="cb27-535"><a href="#cb27-535"></a></span>
<span id="cb27-536"><a href="#cb27-536"></a></span>
<span id="cb27-537"><a href="#cb27-537"></a></span>
<span id="cb27-538"><a href="#cb27-538"></a>bb <span class="ot">&lt;-</span> educ_2 <span class="sc">%&gt;%</span></span>
<span id="cb27-539"><a href="#cb27-539"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> Año, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb27-540"><a href="#cb27-540"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Evolución % gasto en educación/PIB"</span>,</span>
<span id="cb27-541"><a href="#cb27-541"></a>       <span class="at">x =</span> <span class="st">"Año"</span>,</span>
<span id="cb27-542"><a href="#cb27-542"></a>       <span class="at">y =</span> <span class="st">"Gasto"</span>,</span>
<span id="cb27-543"><a href="#cb27-543"></a>       <span class="at">color =</span> <span class="st">"Países"</span>) <span class="sc">+</span></span>
<span id="cb27-544"><a href="#cb27-544"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span> Pais), <span class="at">size=</span> <span class="fl">1.75</span>) <span class="sc">+</span></span>
<span id="cb27-545"><a href="#cb27-545"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span> Pais), <span class="at">size=</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values=</span> <span class="fu">c</span>(<span class="st">"coral1"</span>, <span class="st">"tan4"</span>, <span class="st">"yellow"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"green3"</span>, <span class="st">"darkmagenta"</span>,<span class="st">"green4"</span>,<span class="st">"cyan1"</span>)) <span class="sc">+</span></span>
<span id="cb27-546"><a href="#cb27-546"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(</span>
<span id="cb27-547"><a href="#cb27-547"></a>    <span class="fu">vars</span>(Educacion), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">3</span>,<span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.line =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.6</span>,</span>
<span id="cb27-548"><a href="#cb27-548"></a>                                                                                          <span class="at">linetype =</span> <span class="st">"solid"</span>), <span class="at">axis.ticks =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray14"</span>,</span>
<span id="cb27-549"><a href="#cb27-549"></a>                                                                                                                                         <span class="at">linetype =</span> <span class="st">"dotdash"</span>), <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"ivory3"</span>,</span>
<span id="cb27-550"><a href="#cb27-550"></a>                                                                                                                                                                                                <span class="at">size =</span> <span class="fl">0.4</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>), <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"blank"</span>),</span>
<span id="cb27-551"><a href="#cb27-551"></a>                                                                 <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb27-552"><a href="#cb27-552"></a>                                                                 <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>,</span>
<span id="cb27-553"><a href="#cb27-553"></a>                                                                                          <span class="at">colour =</span> <span class="st">"gray24"</span>), <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"serif"</span>,</span>
<span id="cb27-554"><a href="#cb27-554"></a>                                                                                                                                        <span class="at">size =</span> <span class="dv">15</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb27-555"><a href="#cb27-555"></a>                                                                                                                                                                                            <span class="at">family =</span> <span class="st">"serif"</span>), <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>,</span>
<span id="cb27-556"><a href="#cb27-556"></a>                                                                                                                                                                                                                                           <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"serif"</span>),</span>
<span id="cb27-557"><a href="#cb27-557"></a>                                                                 <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"cornsilk1"</span>,</span>
<span id="cb27-558"><a href="#cb27-558"></a>                                                                                                 <span class="at">linetype =</span> <span class="st">"solid"</span>), <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"blanchedalmond"</span>,</span>
<span id="cb27-559"><a href="#cb27-559"></a>                                                                                                                                                     <span class="at">colour =</span> <span class="cn">NA</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>),</span>
<span id="cb27-560"><a href="#cb27-560"></a>                                                                 <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb27-561"><a href="#cb27-561"></a>                                                                 <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>)) <span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Evolución del gasto en educación sobre el PIB"</span>,</span>
<span id="cb27-562"><a href="#cb27-562"></a>                                                                                                                    <span class="at">x =</span> <span class="st">"Años"</span>, <span class="at">y =</span> <span class="st">"% Gasto educación/PIB"</span>,</span>
<span id="cb27-563"><a href="#cb27-563"></a>                                                                                                                    </span>
<span id="cb27-564"><a href="#cb27-564"></a>                                                                                                                    <span class="at">caption =</span> <span class="st">"Datos de la OECD"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">3</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb27-565"><a href="#cb27-565"></a>                                                                                                                                                                                                                                   <span class="at">hjust =</span> <span class="fl">0.1</span>)) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(</span>
<span id="cb27-566"><a href="#cb27-566"></a>                                                                                                                                                                                                                                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2008</span>, <span class="dv">2019</span>, <span class="dv">1</span>),</span>
<span id="cb27-567"><a href="#cb27-567"></a>                                                                                                                                                                                                                                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2008</span>, <span class="dv">2019</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">5</span>)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">1.075</span>))</span>
<span id="cb27-568"><a href="#cb27-568"></a></span>
<span id="cb27-569"><a href="#cb27-569"></a>bb </span>
<span id="cb27-570"><a href="#cb27-570"></a></span>
<span id="cb27-571"><a href="#cb27-571"></a><span class="in">```</span></span>
<span id="cb27-572"><a href="#cb27-572"></a></span>
<span id="cb27-573"><a href="#cb27-573"></a>Si observamos detenidamente el gráfico, se ve que la inversión que realizan en educación terciaria o superior, países como Estados Unidos, Reino Unido o Japón, es decir, países muy ricos y desarrollados es superior a la inversión que realiza España, Portugal o Grecia. </span>
<span id="cb27-574"><a href="#cb27-574"></a></span>
<span id="cb27-575"><a href="#cb27-575"></a>Este detalle es importante, porque la educación superior pretende formar individuos que sean capaces de impulsar el desarrollo económico y social de un país.</span>
<span id="cb27-576"><a href="#cb27-576"></a></span>
<span id="cb27-577"><a href="#cb27-577"></a>También se ve que el gasto en la etapa de secundaria y primaria, es superior también, lo que podría traducirse en mejores resultados en las pruebas PISA, aunque no necesariamente como veremos más adelante.</span>
<span id="cb27-578"><a href="#cb27-578"></a></span>
<span id="cb27-579"><a href="#cb27-579"></a></span>
<span id="cb27-580"><a href="#cb27-580"></a><span class="fu"># Pruebas PISA</span></span>
<span id="cb27-581"><a href="#cb27-581"></a></span>
<span id="cb27-582"><a href="#cb27-582"></a><span class="in">```{r, eval = TRUE, echo = FALSE, out.width="40%"}</span></span>
<span id="cb27-583"><a href="#cb27-583"></a></span>
<span id="cb27-584"><a href="#cb27-584"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"imagenes"</span>, <span class="st">"pisa.png"</span>))</span>
<span id="cb27-585"><a href="#cb27-585"></a></span>
<span id="cb27-586"><a href="#cb27-586"></a><span class="in">```</span></span>
<span id="cb27-587"><a href="#cb27-587"></a></span>
<span id="cb27-588"><a href="#cb27-588"></a>Como se mencionó anteriormente, las pruebas PISA, son un Programa para la Evaluación Internacional de Alumnos de la OCDE (PISA, por sus siglas en inglés), que tiene como objetivo evaluar que puntos los alumnos cercanos al final de la educación obligatoria han adquirido algunos de los conocimientos y habilidades necesarios para la participación plena en la sociedad del saber. </span>
<span id="cb27-589"><a href="#cb27-589"></a></span>
<span id="cb27-590"><a href="#cb27-590"></a>PISA saca a relucir aquellos países que han alcanzado un buen rendimiento y, al mismo, tiempo, un reparto equitativo de oportunidades de aprendizaje, ayudando asi a establecer metas ambiciosas para otros países.</span>
<span id="cb27-591"><a href="#cb27-591"></a></span>
<span id="cb27-592"><a href="#cb27-592"></a>Estas pruebas son realizadas cada tres años. Examinan el rendimiento de alumnos de 15 años en áreas temáticas claves como son lectura, matemáticas y ciencias.</span>
<span id="cb27-593"><a href="#cb27-593"></a></span>
<span id="cb27-594"><a href="#cb27-594"></a><span class="fu">## Analisis de datos</span></span>
<span id="cb27-595"><a href="#cb27-595"></a></span>
<span id="cb27-596"><a href="#cb27-596"></a>::: {.panel-tabset}</span>
<span id="cb27-597"><a href="#cb27-597"></a></span>
<span id="cb27-598"><a href="#cb27-598"></a><span class="fu">## Mates</span></span>
<span id="cb27-599"><a href="#cb27-599"></a></span>
<span id="cb27-600"><a href="#cb27-600"></a>En la prueba de matemáticas, el quinto mejor es Corea del sur, con una media de 539,4 y el mas cercano de los vecinos de España es Francia, con 495,2 y España con 483,2 por debajo de Portugal. Siendo el mejor Singapur con 564 de media, la diferencia es increíble, segundo Hong Kong y tercero Macao.</span>
<span id="cb27-601"><a href="#cb27-601"></a></span>
<span id="cb27-604"><a href="#cb27-604"></a><span class="in">```{r}</span></span>
<span id="cb27-605"><a href="#cb27-605"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-606"><a href="#cb27-606"></a></span>
<span id="cb27-607"><a href="#cb27-607"></a><span class="co">#españa  y sus vecinos junto a los mejores 5 mejores de mates</span></span>
<span id="cb27-608"><a href="#cb27-608"></a>z<span class="ot">&lt;-</span><span class="fu">full_join</span>(VECINOS, mejores_mates)</span>
<span id="cb27-609"><a href="#cb27-609"></a>z <span class="ot">&lt;-</span> z <span class="sc">%&gt;%</span> </span>
<span id="cb27-610"><a href="#cb27-610"></a>  <span class="fu">mutate</span>(<span class="at">media_mate =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(media_mates), <span class="at">media_lecture =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(media_lectura), <span class="at">media_cience =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(media_ciencias)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> LOCATION, </span>
<span id="cb27-611"><a href="#cb27-611"></a>                                                                                     <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb27-612"><a href="#cb27-612"></a>                                                                                     <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb27-613"><a href="#cb27-613"></a></span>
<span id="cb27-614"><a href="#cb27-614"></a></span>
<span id="cb27-615"><a href="#cb27-615"></a>z <span class="sc">%&gt;%</span></span>
<span id="cb27-616"><a href="#cb27-616"></a>  <span class="fu">arrange</span>(media_mates) <span class="sc">%&gt;%</span>    <span class="co"># First sort by val. This sort the dataframe but NOT the factor levels</span></span>
<span id="cb27-617"><a href="#cb27-617"></a>  <span class="fu">mutate</span>(<span class="at">media_matef=</span><span class="fu">factor</span>( media_mates, <span class="at">levels=</span>media_mate)) <span class="sc">%&gt;%</span>   <span class="co"># This trick update the factor levels</span></span>
<span id="cb27-618"><a href="#cb27-618"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>LOCATION, <span class="at">y=</span>media_matef))<span class="sc">+</span> </span>
<span id="cb27-619"><a href="#cb27-619"></a>  <span class="fu">geom_flag</span>( <span class="fu">aes</span>(<span class="at">image =</span> iso2))<span class="sc">+</span></span>
<span id="cb27-620"><a href="#cb27-620"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend=</span>LOCATION, <span class="at">yend=</span><span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb27-621"><a href="#cb27-621"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span><span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Los 5 mejores en matemáticas'</span>, </span>
<span id="cb27-622"><a href="#cb27-622"></a>                   <span class="at">subtitle=</span><span class="st">'junto a España y sus vecinos'</span>, </span>
<span id="cb27-623"><a href="#cb27-623"></a>                   <span class="at">caption=</span><span class="st">'Fuente: OCDE'</span>,</span>
<span id="cb27-624"><a href="#cb27-624"></a>                  <span class="at">x=</span> <span class="st">"Paises"</span>, <span class="at">y=</span><span class="st">'Notas'</span>)<span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb27-625"><a href="#cb27-625"></a><span class="in">```</span></span>
<span id="cb27-626"><a href="#cb27-626"></a></span>
<span id="cb27-627"><a href="#cb27-627"></a><span class="fu">## Lectura</span></span>
<span id="cb27-628"><a href="#cb27-628"></a></span>
<span id="cb27-629"><a href="#cb27-629"></a>En la prueba de Lectura, el quinto mejor es Canadá con 524,2 luego observamos a Francia  con 496,2 que esta vez la distancia es mucho menor, luego tenemos a Portugal que supera a España por casi 7 puntos y les siguen Italia y Grecia. El mejor en esta prueba vuelve a ser Singapur con 535, segundo Corea y tercero Finlandia.</span>
<span id="cb27-630"><a href="#cb27-630"></a></span>
<span id="cb27-633"><a href="#cb27-633"></a><span class="in">```{r}</span></span>
<span id="cb27-634"><a href="#cb27-634"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-635"><a href="#cb27-635"></a></span>
<span id="cb27-636"><a href="#cb27-636"></a><span class="co">#españa  y sus vecinos junto a los mejores 5 mejores de lectura</span></span>
<span id="cb27-637"><a href="#cb27-637"></a>za<span class="ot">&lt;-</span><span class="fu">full_join</span>(VECINOS, mejores_lectura)</span>
<span id="cb27-638"><a href="#cb27-638"></a>za <span class="ot">&lt;-</span>za <span class="sc">%&gt;%</span> </span>
<span id="cb27-639"><a href="#cb27-639"></a>  <span class="fu">mutate</span>( <span class="at">media_lecture =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(media_lectura)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> LOCATION, </span>
<span id="cb27-640"><a href="#cb27-640"></a>                                                                                                                                                                                           <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb27-641"><a href="#cb27-641"></a>                                                                                                                                                                                           <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb27-642"><a href="#cb27-642"></a></span>
<span id="cb27-643"><a href="#cb27-643"></a>za <span class="sc">%&gt;%</span></span>
<span id="cb27-644"><a href="#cb27-644"></a>  <span class="fu">arrange</span>(media_lecture) <span class="sc">%&gt;%</span>    <span class="co"># First sort by val. This sort the dataframe but NOT the factor levels</span></span>
<span id="cb27-645"><a href="#cb27-645"></a>  <span class="fu">mutate</span>(<span class="at">media_lecturef=</span><span class="fu">factor</span>( media_lectura, <span class="at">levels=</span>media_lecture)) <span class="sc">%&gt;%</span>   <span class="co"># This trick update the factor levels</span></span>
<span id="cb27-646"><a href="#cb27-646"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>LOCATION, <span class="at">y=</span>media_lecturef))<span class="sc">+</span> </span>
<span id="cb27-647"><a href="#cb27-647"></a>  <span class="fu">geom_flag</span>( <span class="fu">aes</span>(<span class="at">image =</span> iso2))<span class="sc">+</span></span>
<span id="cb27-648"><a href="#cb27-648"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend=</span>LOCATION, <span class="at">yend=</span><span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb27-649"><a href="#cb27-649"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb27-650"><a href="#cb27-650"></a>  <span class="fu">theme_bw</span>()  <span class="sc">+</span><span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Los 5 mejores en Lectura'</span>, </span>
<span id="cb27-651"><a href="#cb27-651"></a>                     <span class="at">subtitle=</span><span class="st">'junto a España y sus vecinos'</span>, </span>
<span id="cb27-652"><a href="#cb27-652"></a>                     <span class="at">caption=</span><span class="st">'Fuente: OCDE'</span>,</span>
<span id="cb27-653"><a href="#cb27-653"></a>                     <span class="at">x=</span> <span class="st">"Paises"</span>, <span class="at">y=</span><span class="st">'Notas'</span>)</span>
<span id="cb27-654"><a href="#cb27-654"></a></span>
<span id="cb27-655"><a href="#cb27-655"></a><span class="in">```</span></span>
<span id="cb27-656"><a href="#cb27-656"></a></span>
<span id="cb27-657"><a href="#cb27-657"></a><span class="fu">## Ciencia</span></span>
<span id="cb27-658"><a href="#cb27-658"></a></span>
<span id="cb27-659"><a href="#cb27-659"></a>En la prueba de Ciencias, el quinto mejor es Taiwan, con una media de 532, luego observamos a Francia con 496 y España con 491,25 superando a Portugal, Italia y a Grecia. El mejor en esta prueba vuelve a ser Singapur con 556, segundo Finlandia y tercero Japón.</span>
<span id="cb27-660"><a href="#cb27-660"></a></span>
<span id="cb27-663"><a href="#cb27-663"></a><span class="in">```{r}</span></span>
<span id="cb27-664"><a href="#cb27-664"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-665"><a href="#cb27-665"></a><span class="co"># España  y sus vecinos junto a los mejores 5 mejores de ciencia</span></span>
<span id="cb27-666"><a href="#cb27-666"></a>zb<span class="ot">&lt;-</span><span class="fu">full_join</span>(VECINOS, mejores_ciencias)</span>
<span id="cb27-667"><a href="#cb27-667"></a>zb <span class="ot">&lt;-</span>zb <span class="sc">%&gt;%</span> </span>
<span id="cb27-668"><a href="#cb27-668"></a>  <span class="fu">mutate</span>( <span class="at">media_ciencie =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(media_ciencias)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> LOCATION, </span>
<span id="cb27-669"><a href="#cb27-669"></a>                                                                                            <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb27-670"><a href="#cb27-670"></a>                                                                                            <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>))</span>
<span id="cb27-671"><a href="#cb27-671"></a></span>
<span id="cb27-672"><a href="#cb27-672"></a>zb <span class="sc">%&gt;%</span></span>
<span id="cb27-673"><a href="#cb27-673"></a>  <span class="fu">arrange</span>(media_ciencias) <span class="sc">%&gt;%</span>    <span class="co"># First sort by val. This sort the dataframe but NOT the factor levels</span></span>
<span id="cb27-674"><a href="#cb27-674"></a>  <span class="fu">mutate</span>(<span class="at">media_ciencief=</span><span class="fu">factor</span>( media_ciencias, <span class="at">levels=</span>media_ciencie)) <span class="sc">%&gt;%</span>   <span class="co"># This trick update the factor levels</span></span>
<span id="cb27-675"><a href="#cb27-675"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x=</span>LOCATION, <span class="at">y=</span>media_ciencief))<span class="sc">+</span> </span>
<span id="cb27-676"><a href="#cb27-676"></a>  <span class="fu">geom_flag</span>( <span class="fu">aes</span>(<span class="at">image =</span> iso2))<span class="sc">+</span></span>
<span id="cb27-677"><a href="#cb27-677"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend=</span>LOCATION, <span class="at">yend=</span><span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb27-678"><a href="#cb27-678"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb27-679"><a href="#cb27-679"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span><span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Los 5 mejores en Ciencias'</span>, </span>
<span id="cb27-680"><a href="#cb27-680"></a>                   <span class="at">subtitle=</span><span class="st">'junto a España y sus vecinos'</span>, </span>
<span id="cb27-681"><a href="#cb27-681"></a>                   <span class="at">caption=</span><span class="st">'Fuente: OCDE'</span>,</span>
<span id="cb27-682"><a href="#cb27-682"></a>                   <span class="at">x=</span> <span class="st">"Paises"</span>, <span class="at">y=</span><span class="st">'Notas'</span>)</span>
<span id="cb27-683"><a href="#cb27-683"></a></span>
<span id="cb27-684"><a href="#cb27-684"></a><span class="in">```</span></span>
<span id="cb27-685"><a href="#cb27-685"></a></span>
<span id="cb27-686"><a href="#cb27-686"></a><span class="fu">## Tabla</span></span>
<span id="cb27-687"><a href="#cb27-687"></a></span>
<span id="cb27-688"><a href="#cb27-688"></a>Como podemos observar, España y sus vecinos están muy lejos de estar entre los mejores de cada prueba, pudiendo destacar que Francia es superior en todas las pruebas si lo comparamos con España,Grecia, Italia y Portugal.</span>
<span id="cb27-689"><a href="#cb27-689"></a></span>
<span id="cb27-692"><a href="#cb27-692"></a><span class="in">```{r}</span></span>
<span id="cb27-693"><a href="#cb27-693"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-694"><a href="#cb27-694"></a></span>
<span id="cb27-695"><a href="#cb27-695"></a>df_flags <span class="ot">&lt;-</span> w <span class="sc">%&gt;%</span> <span class="co">#- fips</span></span>
<span id="cb27-696"><a href="#cb27-696"></a>  <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">countrycode</span>(<span class="at">sourcevar =</span> LOCATION, </span>
<span id="cb27-697"><a href="#cb27-697"></a>                            <span class="at">origin =</span> <span class="st">"iso3c"</span>, </span>
<span id="cb27-698"><a href="#cb27-698"></a>                            <span class="at">destination =</span> <span class="st">"iso2c"</span>, <span class="at">warn =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-699"><a href="#cb27-699"></a>  <span class="fu">mutate</span>(<span class="at">iso2 =</span> <span class="fu">tolower</span>(iso2)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-700"><a href="#cb27-700"></a>  <span class="co"># glue:glue() : pega texto con "código", con objetos de R: los objetos tienen que ir entre corchetes {}</span></span>
<span id="cb27-701"><a href="#cb27-701"></a>  <span class="fu">mutate</span>(<span class="at">flag_URL =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'https://hatscripts.github.io/circle-flags/flags/{iso2}.svg'</span>), <span class="at">.before=</span>LOCATION) </span>
<span id="cb27-702"><a href="#cb27-702"></a>tt_flags <span class="ot">&lt;-</span> df_flags<span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">6</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb27-703"><a href="#cb27-703"></a></span>
<span id="cb27-704"><a href="#cb27-704"></a></span>
<span id="cb27-705"><a href="#cb27-705"></a>tt_flags <span class="ot">&lt;-</span> tt_flags <span class="sc">%&gt;%</span> <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**España junto a sus vecinos y los 9 Paises con mejores medias en las pruebas Pisa**"</span>),</span>
<span id="cb27-706"><a href="#cb27-706"></a>                                <span class="at">subtitle =</span> <span class="fu">md</span>(<span class="st">"Datos de *Hombres y Mujeres*"</span>))</span>
<span id="cb27-707"><a href="#cb27-707"></a></span>
<span id="cb27-708"><a href="#cb27-708"></a>tt_flags <span class="ot">&lt;-</span> tt_flags <span class="sc">%&gt;%</span> <span class="fu">cols_label</span>(<span class="at">media_mates =</span> <span class="fu">md</span>(<span class="st">"**Matemáticas**"</span>), <span class="at">LOCATION=</span> <span class="fu">md</span>(<span class="st">"**Paises**"</span>), <span class="at">media_ciencias =</span> <span class="fu">md</span>(<span class="st">"**Ciencias**"</span>), <span class="at">media_lectura =</span> <span class="fu">md</span>(<span class="st">"**Lectura**"</span>),<span class="at">flag_URL =</span> <span class="fu">md</span>(<span class="st">"**Banderas**"</span>)) </span>
<span id="cb27-709"><a href="#cb27-709"></a>tt_flags <span class="ot">&lt;-</span> tt_flags <span class="sc">%&gt;%</span> </span>
<span id="cb27-710"><a href="#cb27-710"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(media_mates, media_ciencias, media_lectura),</span>
<span id="cb27-711"><a href="#cb27-711"></a>             <span class="at">decimals =</span><span class="dv">2</span>, </span>
<span id="cb27-712"><a href="#cb27-712"></a>             <span class="at">sep_mark =</span> <span class="st">"."</span>, </span>
<span id="cb27-713"><a href="#cb27-713"></a>             <span class="at">dec_mark =</span> <span class="st">","</span>) </span>
<span id="cb27-714"><a href="#cb27-714"></a></span>
<span id="cb27-715"><a href="#cb27-715"></a>tabla<span class="ot">&lt;-</span> tt_flags <span class="sc">%&gt;%</span> </span>
<span id="cb27-716"><a href="#cb27-716"></a>  gt<span class="sc">::</span><span class="fu">text_transform</span>(<span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> <span class="fu">c</span>(flag_URL)), </span>
<span id="cb27-717"><a href="#cb27-717"></a>                     <span class="at">fn =</span> <span class="cf">function</span>(x){gt<span class="sc">::</span><span class="fu">web_image</span>(x, <span class="at">height =</span> <span class="dv">30</span>)})</span>
<span id="cb27-718"><a href="#cb27-718"></a>tabla<span class="ot">&lt;-</span> tabla <span class="sc">%&gt;%</span> <span class="fu">opt_stylize</span>(<span class="at">style =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"red"</span>)  <span class="co">#- red</span></span>
<span id="cb27-719"><a href="#cb27-719"></a>tabla</span>
<span id="cb27-720"><a href="#cb27-720"></a></span>
<span id="cb27-721"><a href="#cb27-721"></a><span class="in">```</span></span>
<span id="cb27-722"><a href="#cb27-722"></a></span>
<span id="cb27-723"><a href="#cb27-723"></a>:::</span>
<span id="cb27-724"><a href="#cb27-724"></a></span>
<span id="cb27-725"><a href="#cb27-725"></a>Podemos observar que existe una notable diferencia entre los países asiáticos y los europeos, el único país europeo que podemos apreciar que se encuentra entre los mejores es Finlandia. España está muy por debajo y entre los cinco 4 vecinos que hemos escogido podemos ver que en dos de las tres pruebas, España se encuentra peor que Francia y que Portugal.</span>
<span id="cb27-726"><a href="#cb27-726"></a></span>
<span id="cb27-727"><a href="#cb27-727"></a><span class="fu">## Evolución de las notas de las pruebas PISA</span></span>
<span id="cb27-728"><a href="#cb27-728"></a></span>
<span id="cb27-731"><a href="#cb27-731"></a><span class="in">```{r}</span></span>
<span id="cb27-732"><a href="#cb27-732"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-733"><a href="#cb27-733"></a></span>
<span id="cb27-734"><a href="#cb27-734"></a><span class="co"># Grafica final</span></span>
<span id="cb27-735"><a href="#cb27-735"></a></span>
<span id="cb27-736"><a href="#cb27-736"></a>datos_gt_movil_long <span class="ot">&lt;-</span> datos_gt_movil <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb27-737"><a href="#cb27-737"></a>                                                              <span class="at">names_to =</span> <span class="st">"pruebas"</span>,</span>
<span id="cb27-738"><a href="#cb27-738"></a>                                                              <span class="at">values_to =</span> <span class="st">"notas"</span> )</span>
<span id="cb27-739"><a href="#cb27-739"></a>datos_gt_movil_long <span class="ot">&lt;-</span> datos_gt_movil_long <span class="sc">%&gt;%</span></span>
<span id="cb27-740"><a href="#cb27-740"></a>  <span class="fu">mutate</span>(<span class="at">prueba =</span> <span class="fu">case_when</span>( </span>
<span id="cb27-741"><a href="#cb27-741"></a>    pruebas<span class="sc">==</span><span class="st">"mates"</span>  <span class="sc">~</span> <span class="st">"Matemáticas"</span>,</span>
<span id="cb27-742"><a href="#cb27-742"></a>    pruebas<span class="sc">==</span><span class="st">"ciencia"</span>  <span class="sc">~</span> <span class="st">"Ciencias"</span> ,</span>
<span id="cb27-743"><a href="#cb27-743"></a>    pruebas<span class="sc">==</span><span class="st">"Lectura"</span> <span class="sc">~</span> <span class="st">"Lectura"</span></span>
<span id="cb27-744"><a href="#cb27-744"></a>  )) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>pruebas)</span>
<span id="cb27-745"><a href="#cb27-745"></a></span>
<span id="cb27-746"><a href="#cb27-746"></a>grafico2<span class="ot">&lt;-</span> <span class="fu">ggplot</span>( <span class="at">data=</span> datos_gt_movil_long, <span class="fu">aes</span>(<span class="at">x=</span>TIME, <span class="at">y=</span>notas)) <span class="sc">+</span> <span class="fu">geom_line</span>( <span class="fu">aes</span>(<span class="at">color=</span> LOCATION) , <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb27-747"><a href="#cb27-747"></a>   <span class="fu">theme_ipsum</span>() <span class="sc">+</span> <span class="fu">geom_flag</span>(<span class="fu">aes</span>(<span class="at">image =</span> iso2))<span class="sc">+</span> </span>
<span id="cb27-748"><a href="#cb27-748"></a>   <span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Evolución de las notas de la prueba PISA'</span>, </span>
<span id="cb27-749"><a href="#cb27-749"></a>       <span class="at">subtitle=</span><span class="st">'España y sus vecinos'</span>, </span>
<span id="cb27-750"><a href="#cb27-750"></a>       <span class="at">caption=</span><span class="st">'Proceedings of the National Academy of Sciences, 104 (3):1051-1056, 2007'</span>,</span>
<span id="cb27-751"><a href="#cb27-751"></a>       <span class="at">x=</span><span class="st">'Año'</span>, <span class="at">y=</span><span class="st">'Notas'</span>)<span class="sc">+</span> </span>
<span id="cb27-752"><a href="#cb27-752"></a>   <span class="fu">transition_reveal</span>(TIME)<span class="sc">+</span></span>
<span id="cb27-753"><a href="#cb27-753"></a>   <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">'Anton'</span>, <span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb27-754"><a href="#cb27-754"></a>         <span class="at">plot.subtitle=</span><span class="fu">element_text</span>(<span class="at">family=</span><span class="st">'Anton'</span>),</span>
<span id="cb27-755"><a href="#cb27-755"></a>         <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">'Anton'</span>, <span class="at">face=</span><span class="st">'bold'</span>, <span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb27-756"><a href="#cb27-756"></a>         <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">family=</span><span class="st">'Anton'</span>, <span class="at">face=</span><span class="st">'bold'</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb27-757"><a href="#cb27-757"></a>   <span class="fu">view_follow</span>()  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"gray87"</span>,</span>
<span id="cb27-758"><a href="#cb27-758"></a>                                                                      <span class="at">linetype =</span> <span class="st">"dashed"</span>), <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"darkolivegreen"</span>), <span class="at">legend.position=</span><span class="st">'none'</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(prueba), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol=</span> <span class="dv">3</span>)</span>
<span id="cb27-759"><a href="#cb27-759"></a> </span>
<span id="cb27-760"><a href="#cb27-760"></a> <span class="fu">animate</span>(grafico2, <span class="at">width=</span><span class="dv">1000</span>, <span class="at">height=</span><span class="dv">500</span>, <span class="at">fps=</span><span class="dv">10</span>)</span>
<span id="cb27-761"><a href="#cb27-761"></a> </span>
<span id="cb27-762"><a href="#cb27-762"></a></span>
<span id="cb27-763"><a href="#cb27-763"></a><span class="in">```</span></span>
<span id="cb27-764"><a href="#cb27-764"></a></span>
<span id="cb27-765"><a href="#cb27-765"></a>En la **prueba de Ciencias**, observamos como en 2006 España era el segundo mejor de los 5, siendo superado solo por Francia. Es bastante curioso el increíble crecimiento que experimenta Portugal e Italia en los primeros años de la serie.</span>
<span id="cb27-766"><a href="#cb27-766"></a>En 2012 Italia obtiene su mayor nota en cuanto a ciencias, con 494. posicionándose como tercera, por detrás de Portugal y Francia. Portugal en 2015 es cuando obtiene su nota más alta, 501, pero posteriormente tanto Portugal como Italia experimentan un descenso notable. Por otra parte, tenemos a Grecia, país que desde que la serie empieza no hace nada más que caer, pasando de 473 en 2006 a tener 452 en 2018.</span>
<span id="cb27-767"><a href="#cb27-767"></a></span>
<span id="cb27-768"><a href="#cb27-768"></a>En la **prueba de Matemáticas**, se aprecia algo similar a la prueba de ciencias, Francia parte como primera, Portugal e Italia experimentan un incremento bastante palpable, Portugal  pasando de 466 en 2006 a 492 en 2018 e Italia pasando de 462 en 2006 a 487 en 2018. España se mantiene prácticamente plana y Grecia experimenta una pequeña mejora y luego se hunde. </span>
<span id="cb27-769"><a href="#cb27-769"></a></span>
<span id="cb27-770"><a href="#cb27-770"></a>En la **prueba de lectura**, observamos que los primeros años de la serie todos los países observan un incremento en sus notas hasta 2009, cuando curiosamente se empieza a sufrir la gran recesión. Pero es bastante raro que España y Portugal  a diferencia de sus vecinos no vieran sus notan descender sino al contrario. España pasó de 461 en 2006 a 496 en 2015.  Portugal pasó de 472 en 2006 a 492 en 2015, llegando a obtener 498 en 2015. Francia pasó de 488 en 2006 a 493 en 2018 llegando a su máximo en 2012 con 505. Italia pasó de 469 en 2006 a 476 en 2018 y Grecia pasó de 460 en 2006 a 457 en 2018, llegando a tener 483 en 2009. Por tanto, viéndolo de manera general, el único país que está peor que en 2006 es Grecia.</span>
<span id="cb27-771"><a href="#cb27-771"></a></span>
<span id="cb27-772"><a href="#cb27-772"></a>De manera general podemos ver que la mayoría de países experimenta un incremento en sus notas en los primeros años de la serie, luego se observa un descenso generalizado aproximadamente en 2012 y luego se observa una reversión de esa tendencia y los países vuelve a recuperar en parte lo perdido, lo que nos llevaría a la siguiente parte de este trabajo, donde buscaremos responder a la siguiente pregunta:</span>
<span id="cb27-773"><a href="#cb27-773"></a></span>
<span id="cb27-774"><a href="#cb27-774"></a></span>
<span id="cb27-775"><a href="#cb27-775"></a>*¿Tiene alguna relación las notas que los países sacan en las pruebas PISA con el gasto que los países destinan a educación?*</span>
<span id="cb27-776"><a href="#cb27-776"></a></span>
<span id="cb27-777"><a href="#cb27-777"></a><span class="fu"># Modelo de Regresión </span></span>
<span id="cb27-778"><a href="#cb27-778"></a></span>
<span id="cb27-781"><a href="#cb27-781"></a><span class="in">```{r}</span></span>
<span id="cb27-782"><a href="#cb27-782"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-783"><a href="#cb27-783"></a></span>
<span id="cb27-784"><a href="#cb27-784"></a>datos_educacion.csv <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/Datos_educacion_completo.csv"</span>)</span>
<span id="cb27-785"><a href="#cb27-785"></a></span>
<span id="cb27-786"><a href="#cb27-786"></a>datos1<span class="ot">&lt;-</span> datos_educacion.csv <span class="sc">%&gt;%</span>  </span>
<span id="cb27-787"><a href="#cb27-787"></a>  <span class="fu">rename</span>(<span class="at">Pais =</span> LOCATION, Año <span class="ot">=</span> TIME, <span class="at">Valor =</span> Value, <span class="at">Educacion =</span> SUBJECT) <span class="sc">%&gt;%</span></span>
<span id="cb27-788"><a href="#cb27-788"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(INDICATOR, MEASURE, FREQUENCY, Flag.Codes)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-789"><a href="#cb27-789"></a>  <span class="fu">filter</span>(Año <span class="sc">&gt;=</span> <span class="dv">2006</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb27-790"><a href="#cb27-790"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb27-791"><a href="#cb27-791"></a>  <span class="fu">mutate</span>(<span class="at">Educacion =</span> forcats<span class="sc">::</span><span class="fu">fct_recode</span>(Educacion,</span>
<span id="cb27-792"><a href="#cb27-792"></a>                                                   <span class="st">"Educación infantil"</span> <span class="ot">=</span> <span class="st">"EARLYCHILDEDU"</span>,</span>
<span id="cb27-793"><a href="#cb27-793"></a>                                                   <span class="st">"Primaria y Secundaria"</span> <span class="ot">=</span> <span class="st">"PRY_NTRY"</span>, </span>
<span id="cb27-794"><a href="#cb27-794"></a>                                                   <span class="st">"Educación Terciaria"</span>  <span class="ot">=</span> <span class="st">"TRY"</span>))</span>
<span id="cb27-795"><a href="#cb27-795"></a>pisa_ciencias<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/pisa_ciencias.csv"</span>)</span>
<span id="cb27-796"><a href="#cb27-796"></a>pisa_mates <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/pisa_mates.csv"</span>)</span>
<span id="cb27-797"><a href="#cb27-797"></a>pisa_lectura <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/pisa_lectura.csv"</span>)</span>
<span id="cb27-798"><a href="#cb27-798"></a>df <span class="ot">&lt;-</span> pisa_mates <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>)</span>
<span id="cb27-799"><a href="#cb27-799"></a>df1<span class="ot">&lt;-</span>pisa_ciencias <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>)</span>
<span id="cb27-800"><a href="#cb27-800"></a>df1 <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">ciencia=</span>Value)</span>
<span id="cb27-801"><a href="#cb27-801"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">rename</span> (<span class="at">mates=</span>Value)</span>
<span id="cb27-802"><a href="#cb27-802"></a>pisa_lectura <span class="ot">&lt;-</span> pisa_lectura <span class="sc">%&gt;%</span> <span class="fu">select</span>(LOCATION,TIME, Value)</span>
<span id="cb27-803"><a href="#cb27-803"></a>pisa_lectura <span class="ot">&lt;-</span> pisa_lectura <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Lectura=</span>Value)</span>
<span id="cb27-804"><a href="#cb27-804"></a>pisa<span class="ot">&lt;-</span> <span class="fu">inner_join</span>(df,df1)</span>
<span id="cb27-805"><a href="#cb27-805"></a>pisa <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(pisa, pisa_lectura)</span>
<span id="cb27-806"><a href="#cb27-806"></a></span>
<span id="cb27-807"><a href="#cb27-807"></a>pisa <span class="ot">&lt;-</span> pisa <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(SUBJECT))</span>
<span id="cb27-808"><a href="#cb27-808"></a></span>
<span id="cb27-809"><a href="#cb27-809"></a></span>
<span id="cb27-810"><a href="#cb27-810"></a>df_modelo <span class="ot">&lt;-</span> <span class="fu">left_join</span>(pisa, datos1, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"LOCATION"</span> <span class="ot">=</span> <span class="st">"Pais"</span>,<span class="st">"TIME"</span> <span class="ot">=</span> <span class="st">"Año"</span> ))</span>
<span id="cb27-811"><a href="#cb27-811"></a></span>
<span id="cb27-812"><a href="#cb27-812"></a>df_modelo <span class="ot">&lt;-</span> df_modelo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Educacion <span class="sc">==</span> <span class="st">"Primaria y Secundaria"</span>) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span>
<span id="cb27-813"><a href="#cb27-813"></a><span class="in">```</span></span>
<span id="cb27-814"><a href="#cb27-814"></a></span>
<span id="cb27-815"><a href="#cb27-815"></a>Para ver la relación entre las notas de los estudiantes en las pruebas PISA con el gasto que los países destinan a la educación. Hemos calculado el modelo de regresión lineal y las correlaciones entre estos dos factores.</span>
<span id="cb27-816"><a href="#cb27-816"></a></span>
<span id="cb27-817"><a href="#cb27-817"></a>El modelo de regresión lineal nos sirve para describir una variable de respuesta continua como una función de una o varias variables predictoras. Y la correlación nos indica la fuerza y la dirección de una relación lineal y proporcionalidad entre dos variables estadísticas.</span>
<span id="cb27-818"><a href="#cb27-818"></a></span>
<span id="cb27-819"><a href="#cb27-819"></a>A continuación, en la siguiente tabla podemos observar esta tabla con las regresiones lineales de las notas de las pruebas de Matemáticas, Ciencias y Lectura con el gasto de educación.</span>
<span id="cb27-820"><a href="#cb27-820"></a></span>
<span id="cb27-823"><a href="#cb27-823"></a><span class="in">```{r}</span></span>
<span id="cb27-824"><a href="#cb27-824"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-825"><a href="#cb27-825"></a><span class="co">#| eval: true</span></span>
<span id="cb27-826"><a href="#cb27-826"></a></span>
<span id="cb27-827"><a href="#cb27-827"></a></span>
<span id="cb27-828"><a href="#cb27-828"></a>my_modelmates <span class="ot">&lt;-</span> <span class="fu">lm</span>(mates <span class="sc">~</span> Valor, <span class="at">data =</span> df_modelo)</span>
<span id="cb27-829"><a href="#cb27-829"></a>my_modelmates</span>
<span id="cb27-830"><a href="#cb27-830"></a></span>
<span id="cb27-831"><a href="#cb27-831"></a>my_modelciencia <span class="ot">&lt;-</span> <span class="fu">lm</span>(ciencia <span class="sc">~</span> Valor, <span class="at">data =</span> df_modelo)</span>
<span id="cb27-832"><a href="#cb27-832"></a>my_modelciencia</span>
<span id="cb27-833"><a href="#cb27-833"></a></span>
<span id="cb27-834"><a href="#cb27-834"></a>my_modelLectura <span class="ot">&lt;-</span> <span class="fu">lm</span>(Lectura <span class="sc">~</span> Valor, <span class="at">data =</span> df_modelo)</span>
<span id="cb27-835"><a href="#cb27-835"></a>my_modelLectura</span>
<span id="cb27-836"><a href="#cb27-836"></a></span>
<span id="cb27-837"><a href="#cb27-837"></a></span>
<span id="cb27-838"><a href="#cb27-838"></a> </span>
<span id="cb27-839"><a href="#cb27-839"></a></span>
<span id="cb27-840"><a href="#cb27-840"></a><span class="co">#- O también podemos estimarlos en una lista.</span></span>
<span id="cb27-841"><a href="#cb27-841"></a>my_models <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb27-842"><a href="#cb27-842"></a>my_models[[<span class="st">'W:  OLS 1'</span>]]   <span class="ot">&lt;-</span> <span class="fu">lm</span>( mates  <span class="sc">~</span> Valor, df_modelo)</span>
<span id="cb27-843"><a href="#cb27-843"></a>my_models[[<span class="st">'W:  OLS 2'</span>]]   <span class="ot">&lt;-</span> <span class="fu">lm</span>( ciencia  <span class="sc">~</span> Valor , df_modelo)</span>
<span id="cb27-844"><a href="#cb27-844"></a>my_models[[<span class="st">'W:  OLS 3'</span>]]   <span class="ot">&lt;-</span> <span class="fu">lm</span>( Lectura  <span class="sc">~</span> Valor , df_modelo)</span>
<span id="cb27-845"><a href="#cb27-845"></a></span>
<span id="cb27-846"><a href="#cb27-846"></a></span>
<span id="cb27-847"><a href="#cb27-847"></a></span>
<span id="cb27-848"><a href="#cb27-848"></a><span class="do">###Estimación de los modelos -----------</span></span>
<span id="cb27-849"><a href="#cb27-849"></a></span>
<span id="cb27-850"><a href="#cb27-850"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(my_models, <span class="at">show.ci    =</span> <span class="cn">FALSE</span>, <span class="at">title =</span> <span class="st">"Modelo de regresión lineal entre el gasto de educación y las notas PISA"</span>)</span>
<span id="cb27-851"><a href="#cb27-851"></a></span>
<span id="cb27-852"><a href="#cb27-852"></a></span>
<span id="cb27-853"><a href="#cb27-853"></a></span>
<span id="cb27-854"><a href="#cb27-854"></a><span class="in">```</span></span>
<span id="cb27-855"><a href="#cb27-855"></a></span>
<span id="cb27-856"><a href="#cb27-856"></a>Por tanto, podemos determinar viendo los coeficientes que cuando el gasto de educación aumenta por una unidad:</span>
<span id="cb27-857"><a href="#cb27-857"></a></span>
<span id="cb27-858"><a href="#cb27-858"></a><span class="ss">- </span>Las notas de matemáticas bajan por 1.06 unidades </span>
<span id="cb27-859"><a href="#cb27-859"></a></span>
<span id="cb27-860"><a href="#cb27-860"></a><span class="ss">- </span>Las notas de ciencias suben por 0.49 unidades </span>
<span id="cb27-861"><a href="#cb27-861"></a></span>
<span id="cb27-862"><a href="#cb27-862"></a><span class="ss">- </span>Las notas de lectura suben por 3.36 unidades</span>
<span id="cb27-863"><a href="#cb27-863"></a></span>
<span id="cb27-864"><a href="#cb27-864"></a>También observando el R cuadrado, que nos indica sí podemos explicar o predecir una variable haciendo uso de la otra. Por tanto, podemos determinar que **no existe ajuste** o es casi nulo entre las notas PISA y el gasto en educación.</span>
<span id="cb27-865"><a href="#cb27-865"></a></span>
<span id="cb27-866"><a href="#cb27-866"></a>En cuanto al valor de P, normalmente los estudios de R suelen realizarse bajo un nivel de confianza del 95%. Así que podemos concluir que el gasto de educación no es válido para predecir la variable de las notas de las pruebas PISA.</span>
<span id="cb27-867"><a href="#cb27-867"></a> </span>
<span id="cb27-868"><a href="#cb27-868"></a>También podemos observar la regresión con estas gráficas.</span>
<span id="cb27-869"><a href="#cb27-869"></a></span>
<span id="cb27-870"><a href="#cb27-870"></a>::: {.panel-tabset}</span>
<span id="cb27-871"><a href="#cb27-871"></a><span class="fu"># Regresión Ciencias</span></span>
<span id="cb27-872"><a href="#cb27-872"></a></span>
<span id="cb27-875"><a href="#cb27-875"></a><span class="in">```{r}</span></span>
<span id="cb27-876"><a href="#cb27-876"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-877"><a href="#cb27-877"></a></span>
<span id="cb27-878"><a href="#cb27-878"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(my_modelciencia, <span class="at">sort.est =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Regresión lineal entre el gasto en educación y las notas de ciencias (PISA)"</span>)</span>
<span id="cb27-879"><a href="#cb27-879"></a></span>
<span id="cb27-880"><a href="#cb27-880"></a></span>
<span id="cb27-881"><a href="#cb27-881"></a><span class="in">```</span></span>
<span id="cb27-882"><a href="#cb27-882"></a></span>
<span id="cb27-883"><a href="#cb27-883"></a><span class="fu"># Regresión Lectura</span></span>
<span id="cb27-884"><a href="#cb27-884"></a></span>
<span id="cb27-887"><a href="#cb27-887"></a><span class="in">```{r}</span></span>
<span id="cb27-888"><a href="#cb27-888"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-889"><a href="#cb27-889"></a></span>
<span id="cb27-890"><a href="#cb27-890"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(my_modelLectura, <span class="at">sort.est =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Regresión lineal entre el gasto en educación y las notas de Lectura (PISA)"</span>)</span>
<span id="cb27-891"><a href="#cb27-891"></a></span>
<span id="cb27-892"><a href="#cb27-892"></a></span>
<span id="cb27-893"><a href="#cb27-893"></a><span class="in">```</span></span>
<span id="cb27-894"><a href="#cb27-894"></a></span>
<span id="cb27-895"><a href="#cb27-895"></a><span class="fu"># Regresión Matemáticas</span></span>
<span id="cb27-896"><a href="#cb27-896"></a></span>
<span id="cb27-899"><a href="#cb27-899"></a><span class="in">```{r}</span></span>
<span id="cb27-900"><a href="#cb27-900"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-901"><a href="#cb27-901"></a></span>
<span id="cb27-902"><a href="#cb27-902"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(my_modelmates, <span class="at">sort.est =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">"Regresión lineal entre el gasto en educación y las notas de matemáticas (PISA)"</span>)</span>
<span id="cb27-903"><a href="#cb27-903"></a></span>
<span id="cb27-904"><a href="#cb27-904"></a></span>
<span id="cb27-905"><a href="#cb27-905"></a><span class="in">```</span></span>
<span id="cb27-906"><a href="#cb27-906"></a>:::</span>
<span id="cb27-907"><a href="#cb27-907"></a></span>
<span id="cb27-908"><a href="#cb27-908"></a>Aquí se puede ver la regresión de otra manera.</span>
<span id="cb27-911"><a href="#cb27-911"></a><span class="in">```{r}</span></span>
<span id="cb27-912"><a href="#cb27-912"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-913"><a href="#cb27-913"></a></span>
<span id="cb27-914"><a href="#cb27-914"></a></span>
<span id="cb27-915"><a href="#cb27-915"></a>plot1<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my_modelmates, <span class="fu">aes</span>(<span class="at">x=</span>mates, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb27-916"><a href="#cb27-916"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-917"><a href="#cb27-917"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb27-918"><a href="#cb27-918"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb27-919"><a href="#cb27-919"></a></span>
<span id="cb27-920"><a href="#cb27-920"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my_modelciencia, <span class="fu">aes</span>(<span class="at">x=</span>ciencia, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb27-921"><a href="#cb27-921"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-922"><a href="#cb27-922"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb27-923"><a href="#cb27-923"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb27-924"><a href="#cb27-924"></a></span>
<span id="cb27-925"><a href="#cb27-925"></a>plot3<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my_modelLectura, <span class="fu">aes</span>(<span class="at">x=</span>Lectura, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb27-926"><a href="#cb27-926"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-927"><a href="#cb27-927"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb27-928"><a href="#cb27-928"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb27-929"><a href="#cb27-929"></a></span>
<span id="cb27-930"><a href="#cb27-930"></a><span class="fu">grid.arrange</span>(plot1, plot2, plot3)</span>
<span id="cb27-931"><a href="#cb27-931"></a></span>
<span id="cb27-932"><a href="#cb27-932"></a><span class="in">```</span></span>
<span id="cb27-933"><a href="#cb27-933"></a></span>
<span id="cb27-934"><a href="#cb27-934"></a>En cuanto a la correlación, podemos observar que entre el gasto de educación y las notas de las pruebas PISA, de ciencias y lectura tienen una correlación positiva débil. Y entre el gasto de educación y las notas PISA de matemáticas tiene una correlación negativa débil. Donde podemos verlo, en la siguiente gráfica.</span>
<span id="cb27-935"><a href="#cb27-935"></a></span>
<span id="cb27-938"><a href="#cb27-938"></a><span class="in">```{r}</span></span>
<span id="cb27-939"><a href="#cb27-939"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-940"><a href="#cb27-940"></a><span class="do">##Correlacion-------------------- </span></span>
<span id="cb27-941"><a href="#cb27-941"></a><span class="fu">cor</span>(df_modelo<span class="sc">$</span>ciencia, df_modelo<span class="sc">$</span>Valor)</span>
<span id="cb27-942"><a href="#cb27-942"></a><span class="fu">cor</span>(df_modelo<span class="sc">$</span>mates, df_modelo<span class="sc">$</span>Valor)</span>
<span id="cb27-943"><a href="#cb27-943"></a><span class="fu">cor</span>(df_modelo<span class="sc">$</span>Lectura, df_modelo<span class="sc">$</span>Valor)</span>
<span id="cb27-944"><a href="#cb27-944"></a><span class="co">#cor(data)</span></span>
<span id="cb27-945"><a href="#cb27-945"></a>modelo_interaccion <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Valor <span class="sc">~</span> mates <span class="sc">+</span> ciencia <span class="sc">+</span> Lectura, <span class="at">data =</span> df_modelo)</span>
<span id="cb27-946"><a href="#cb27-946"></a><span class="fu">summary</span>(modelo_interaccion)</span>
<span id="cb27-947"><a href="#cb27-947"></a></span>
<span id="cb27-948"><a href="#cb27-948"></a></span>
<span id="cb27-949"><a href="#cb27-949"></a><span class="co">#Ajustamos datos para que solo haya variables numéricas</span></span>
<span id="cb27-950"><a href="#cb27-950"></a>data <span class="ot">&lt;-</span> df_modelo <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(LOCATION, TIME, Educacion)) <span class="co"># Variables numéricas</span></span>
<span id="cb27-951"><a href="#cb27-951"></a></span>
<span id="cb27-952"><a href="#cb27-952"></a>data2009 <span class="ot">&lt;-</span> df_modelo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(TIME<span class="sc">==</span> <span class="st">"2009"</span>) <span class="co">#2009 CRISIS</span></span>
<span id="cb27-953"><a href="#cb27-953"></a>data2018 <span class="ot">&lt;-</span> df_modelo <span class="sc">%&gt;%</span> <span class="fu">filter</span>(TIME<span class="sc">==</span><span class="st">"2018"</span>)  <span class="co">#2018</span></span>
<span id="cb27-954"><a href="#cb27-954"></a></span>
<span id="cb27-955"><a href="#cb27-955"></a><span class="do">###Gráfica correlación -----</span></span>
<span id="cb27-956"><a href="#cb27-956"></a></span>
<span id="cb27-957"><a href="#cb27-957"></a><span class="fu">pairs</span>(data)</span>
<span id="cb27-958"><a href="#cb27-958"></a></span>
<span id="cb27-959"><a href="#cb27-959"></a><span class="co">#Gráfica correlación colores</span></span>
<span id="cb27-960"><a href="#cb27-960"></a></span>
<span id="cb27-961"><a href="#cb27-961"></a></span>
<span id="cb27-962"><a href="#cb27-962"></a><span class="fu">corrplot.mixed</span>(<span class="fu">cor</span>(data),</span>
<span id="cb27-963"><a href="#cb27-963"></a>               <span class="at">lower =</span> <span class="st">"number"</span>, </span>
<span id="cb27-964"><a href="#cb27-964"></a>               <span class="at">upper =</span> <span class="st">"circle"</span>,</span>
<span id="cb27-965"><a href="#cb27-965"></a>               <span class="at">tl.col =</span> <span class="st">"black"</span>)</span>
<span id="cb27-966"><a href="#cb27-966"></a></span>
<span id="cb27-967"><a href="#cb27-967"></a><span class="in">```</span></span>
<span id="cb27-968"><a href="#cb27-968"></a>En último lugar, ¿Existe la misma relación entre las notas y el gasto público entre el primer año obtenido de datos y el último? ¿La crisis del 2008 afectó a las notas de los estudiantes?</span>
<span id="cb27-969"><a href="#cb27-969"></a></span>
<span id="cb27-970"><a href="#cb27-970"></a>Por ello, hemos obtenido estas gráficas comparativas entre estos años (2009 y 2018)</span>
<span id="cb27-971"><a href="#cb27-971"></a></span>
<span id="cb27-972"><a href="#cb27-972"></a>::: {.panel-tabset}</span>
<span id="cb27-973"><a href="#cb27-973"></a><span class="fu"># Matemáticas 2009</span></span>
<span id="cb27-974"><a href="#cb27-974"></a></span>
<span id="cb27-977"><a href="#cb27-977"></a><span class="in">```{r}</span></span>
<span id="cb27-978"><a href="#cb27-978"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-979"><a href="#cb27-979"></a></span>
<span id="cb27-980"><a href="#cb27-980"></a>plot4<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2009, <span class="fu">aes</span>(<span class="at">x=</span>mates, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb27-981"><a href="#cb27-981"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-982"><a href="#cb27-982"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb27-983"><a href="#cb27-983"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparación entre la regresión lineal entre 2009 y 2018"</span>)</span>
<span id="cb27-984"><a href="#cb27-984"></a>plot4</span>
<span id="cb27-985"><a href="#cb27-985"></a></span>
<span id="cb27-986"><a href="#cb27-986"></a><span class="in">```</span></span>
<span id="cb27-987"><a href="#cb27-987"></a></span>
<span id="cb27-988"><a href="#cb27-988"></a><span class="fu"># Matemáticas 2018</span></span>
<span id="cb27-989"><a href="#cb27-989"></a></span>
<span id="cb27-992"><a href="#cb27-992"></a><span class="in">```{r}</span></span>
<span id="cb27-993"><a href="#cb27-993"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-994"><a href="#cb27-994"></a></span>
<span id="cb27-995"><a href="#cb27-995"></a>plot5<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2018, <span class="fu">aes</span>(<span class="at">x=</span>mates, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb27-996"><a href="#cb27-996"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-997"><a href="#cb27-997"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb27-998"><a href="#cb27-998"></a>  <span class="fu">theme_light</span>() </span>
<span id="cb27-999"><a href="#cb27-999"></a>plot5</span>
<span id="cb27-1000"><a href="#cb27-1000"></a></span>
<span id="cb27-1001"><a href="#cb27-1001"></a><span class="in">```</span></span>
<span id="cb27-1002"><a href="#cb27-1002"></a></span>
<span id="cb27-1003"><a href="#cb27-1003"></a><span class="fu"># Ciencias 2009</span></span>
<span id="cb27-1004"><a href="#cb27-1004"></a></span>
<span id="cb27-1007"><a href="#cb27-1007"></a><span class="in">```{r}</span></span>
<span id="cb27-1008"><a href="#cb27-1008"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-1009"><a href="#cb27-1009"></a></span>
<span id="cb27-1010"><a href="#cb27-1010"></a>plot6<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2009, <span class="fu">aes</span>(<span class="at">x=</span>ciencia, <span class="at">y=</span> Valor)) <span class="sc">+</span> </span>
<span id="cb27-1011"><a href="#cb27-1011"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-1012"><a href="#cb27-1012"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb27-1013"><a href="#cb27-1013"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparación entre la regresión lineal entre 2009 y 2018"</span>)</span>
<span id="cb27-1014"><a href="#cb27-1014"></a>plot6</span>
<span id="cb27-1015"><a href="#cb27-1015"></a></span>
<span id="cb27-1016"><a href="#cb27-1016"></a><span class="in">```</span></span>
<span id="cb27-1017"><a href="#cb27-1017"></a></span>
<span id="cb27-1018"><a href="#cb27-1018"></a><span class="fu"># Ciencias 2018</span></span>
<span id="cb27-1019"><a href="#cb27-1019"></a></span>
<span id="cb27-1022"><a href="#cb27-1022"></a><span class="in">```{r}</span></span>
<span id="cb27-1023"><a href="#cb27-1023"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-1024"><a href="#cb27-1024"></a></span>
<span id="cb27-1025"><a href="#cb27-1025"></a>plot7<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2018, <span class="fu">aes</span>(<span class="at">x=</span>ciencia, <span class="at">y=</span> Valor)) <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-1026"><a href="#cb27-1026"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb27-1027"><a href="#cb27-1027"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb27-1028"><a href="#cb27-1028"></a>plot7</span>
<span id="cb27-1029"><a href="#cb27-1029"></a></span>
<span id="cb27-1030"><a href="#cb27-1030"></a><span class="in">```</span></span>
<span id="cb27-1031"><a href="#cb27-1031"></a></span>
<span id="cb27-1032"><a href="#cb27-1032"></a><span class="fu"># Lectura 2009</span></span>
<span id="cb27-1033"><a href="#cb27-1033"></a></span>
<span id="cb27-1036"><a href="#cb27-1036"></a><span class="in">```{r}</span></span>
<span id="cb27-1037"><a href="#cb27-1037"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-1038"><a href="#cb27-1038"></a>               </span>
<span id="cb27-1039"><a href="#cb27-1039"></a>plot8<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2009, <span class="fu">aes</span>(<span class="at">x=</span>Lectura, <span class="at">y=</span> Valor)) <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-1040"><a href="#cb27-1040"></a>                 <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb27-1041"><a href="#cb27-1041"></a>                 <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparación entre la regresión lineal entre 2009 y 2018"</span>)</span>
<span id="cb27-1042"><a href="#cb27-1042"></a>plot8</span>
<span id="cb27-1043"><a href="#cb27-1043"></a></span>
<span id="cb27-1044"><a href="#cb27-1044"></a><span class="in">```</span></span>
<span id="cb27-1045"><a href="#cb27-1045"></a></span>
<span id="cb27-1046"><a href="#cb27-1046"></a><span class="fu"># Lectura 2018</span></span>
<span id="cb27-1047"><a href="#cb27-1047"></a></span>
<span id="cb27-1050"><a href="#cb27-1050"></a><span class="in">```{r}</span></span>
<span id="cb27-1051"><a href="#cb27-1051"></a><span class="co">#| code-fold: true</span></span>
<span id="cb27-1052"><a href="#cb27-1052"></a></span>
<span id="cb27-1053"><a href="#cb27-1053"></a>plot9<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data2018, <span class="fu">aes</span>(<span class="at">x=</span>Lectura, <span class="at">y=</span> Valor)) <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-1054"><a href="#cb27-1054"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">col=</span><span class="st">'dodgerblue1'</span>) <span class="sc">+</span></span>
<span id="cb27-1055"><a href="#cb27-1055"></a>  <span class="fu">theme_light</span>() </span>
<span id="cb27-1056"><a href="#cb27-1056"></a>plot9</span>
<span id="cb27-1057"><a href="#cb27-1057"></a></span>
<span id="cb27-1058"><a href="#cb27-1058"></a><span class="in">```</span></span>
<span id="cb27-1059"><a href="#cb27-1059"></a>:::</span>
<span id="cb27-1060"><a href="#cb27-1060"></a></span>
<span id="cb27-1061"><a href="#cb27-1061"></a></span>
<span id="cb27-1062"><a href="#cb27-1062"></a>Y podemos observar que la tendencia de 2009 a 2018 es más negativa y dispersada. Por tanto, la relación entre estos años no es la misma.</span>
<span id="cb27-1063"><a href="#cb27-1063"></a></span>
<span id="cb27-1064"><a href="#cb27-1064"></a>En último lugar, concluimos que la relación entre el gasto y las notas obtenidas en el test PISA es muy débil. Por ello, la crisis de 2008 pudo afectar a las notas de los estudiantes, pero el gasto no es un factor determinante. </span>
<span id="cb27-1065"><a href="#cb27-1065"></a></span>
<span id="cb27-1066"><a href="#cb27-1066"></a><span class="fu">## Conclusiones</span></span>
<span id="cb27-1067"><a href="#cb27-1067"></a></span>
<span id="cb27-1068"><a href="#cb27-1068"></a>La educación es un gasto principal en cada economía por su impacto tanto económico como social.  La eficiencia del gasto en educación depende del uso correcto de los fondos por parte de los gobiernos. Por tanto, el grado de confianza de los ciudadanos en el Estado, se reduce.</span>
<span id="cb27-1069"><a href="#cb27-1069"></a></span>
<span id="cb27-1070"><a href="#cb27-1070"></a>En el caso de España, el gasto en educación es insuficiente y poco eficiente ya que no tiene tanto impacto económicamente como se refleja en las tasas de desempleo. En comparativa con otros países de la OECD, España pertenece al grupo donde el efecto del gasto es menor dado que también su inversión es menor. </span>
<span id="cb27-1071"><a href="#cb27-1071"></a>En cuanto al rendimiento de los estudiantes, que son el factor principal del gasto en educación, evaluamos las pruebas PISA. Donde se divide en tres ramas, Matemáticas, Lectura y Ciencias.</span>
<span id="cb27-1072"><a href="#cb27-1072"></a></span>
<span id="cb27-1073"><a href="#cb27-1073"></a>En las pruebas podemos observar que España y sus vecinos como Grecia, Italia o Portugal están alejados de formar parte de los mejores de cada prueba. Donde resalta Francia que, en diferencia a los países anteriormente mencionados, su valor es superior a estos. Cabe destacar la gran disparidad entre los países asiáticos y europeos donde los países asiáticos se encuentran entre los mejores.</span>
<span id="cb27-1074"><a href="#cb27-1074"></a></span>
<span id="cb27-1075"><a href="#cb27-1075"></a>Al observar la evolución de las notas de las pruebas PISA, se experimenta un crecimiento aproximado en forma de U. Primero ascienden las notas, desciende aproximadamente por el 2012 y luego vuelve a ascender.  ¿Esta evolución puede ser causada por las fluctuaciones del gasto en educación?</span>
<span id="cb27-1076"><a href="#cb27-1076"></a></span>
<span id="cb27-1077"><a href="#cb27-1077"></a>Para contestar a esta pregunta, efectuamos el modelo de regresión estudiando su regresión lineal y la correlación entre las variables. Tras observar variables como r cuadrado, el coeficiente o el valor de P, concluimos que relación entre el gasto de educación y las notas de las pruebas PISA es mínimo, no válido para predicciones y que el ajuste es casi nulo o no existe. </span>
<span id="cb27-1078"><a href="#cb27-1078"></a></span>
<span id="cb27-1079"><a href="#cb27-1079"></a>En conclusión, aunque la relación entre el gasto de educación y las notas de las pruebas PISA sea débil, es remarcable que en ambas variables su rendimiento es bajo en comparativa con otros países de la OECD.  Por tanto, España y sus vecinos, deberían incrementar su gasto, pero de manera más eficiente y observar las diferencias en comparativa con Asia o Finlandia y aprender de ellas en cuanto a los conocimientos de los estudiantes evaluados por las pruebas PISA. </span>
</code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">© 2022 Alex, Naira y Luis</div>   
      <div class="nav-footer-center">Hecho con <a href="https://quarto.org">Quarto</a></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/AlexMS77">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/<tu-usuario-twitter>">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:<tu-mail>@alumni.uv.es">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>